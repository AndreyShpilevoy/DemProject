<?xml version="1.0" encoding="UTF-8" ?>
<project name="DEM_MVC" id="Project_3380dee0" html="y" template="Default" database="SqlServer" >
	<schema name="DEM_Project" schemaname="DEM_Project" >
		<table name="dem_banlist" >
			<comment><![CDATA[Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )]]></comment>
			<column name="ban_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) блокировки]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с users.user_id ]]></comment>
			</column>
			<column name="ban_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[значение заблокированного IP-адреса ]]></comment>
			</column>
			<column name="ban_email" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[значение заблокированного email-адреса ]]></comment>
			</column>
			<column name="ban_start" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[момент начала блокировки ]]></comment>
			</column>
			<column name="ban_end" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)]]></comment>
			</column>
			<column name="ban_exclude" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)]]></comment>
			</column>
			<column name="ban_type" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[вид блокировки (имя\IP\email) ]]></comment>
			</column>
			<column name="ban_reason" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[причина блокировки, показываемая пользователю) ]]></comment>
			</column>
			<index name="Pk_banlist" unique="PRIMARY_KEY" >
				<column name="ban_id" />
			</index>
			<index name="idx_dem_banlist" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_bbcodes" >
			<comment><![CDATA[Пользовательские BBCode (PRIMARY 	bbcode_id )]]></comment>
			<column name="bbcode_id" type="tinyint" jt="-6" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) пользовательского BBCode ]]></comment>
			</column>
			<column name="bbcode_order" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[сортировка]]></comment>
			</column>
			<column name="bbcode_tag" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя тэга  (к примеру: "center")]]></comment>
			</column>
			<column name="bbcode_helpline" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")]]></comment>
			</column>
			<column name="display_on_posting" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[идентификатор отображения в форме ответа\постинга?]]></comment>
			</column>
			<column name="bbcode_match" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[текст определения BBCode ]]></comment>
			</column>
			<column name="bbcode_tpl" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[html-замена BBCode]]></comment>
			</column>
			<index name="Pk_dem_bbcodes" unique="PRIMARY_KEY" >
				<column name="bbcode_id" />
			</index>
		</table>
		<table name="dem_bots" >
			<comment><![CDATA[Список Ботов \ Поисковиков  (PRIMARY 	bot_id)]]></comment>
			<column name="bot_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) бота\поисковика ]]></comment>
			</column>
			<column name="bot_active" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[идентификатор активированности - разрешить или нет]]></comment>
			</column>
			<column name="bot_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)]]></comment>
			</column>
			<column name="bot_agent" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)]]></comment>
			</column>
			<column name="bot_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[значение IP-адреса бота\поисковика]]></comment>
			</column>
			<index name="Pk_dem_bots" unique="PRIMARY_KEY" >
				<column name="bot_id" />
			</index>
			<index name="idx_dem_bots" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_config" >
			<comment><![CDATA[Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )]]></comment>
			<column name="config_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[наименование параметра конфигурации]]></comment>
			</column>
			<column name="config_value" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[значение параметра конфигурации ]]></comment>
			</column>
			<index name="Pk_dem_config" unique="PRIMARY_KEY" >
				<column name="config_name" />
			</index>
		</table>
		<table name="dem_disallow_usernames" >
			<comment><![CDATA[Запрещённые имена (PRIMARY 	disallow_id )]]></comment>
			<column name="disallow_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) запрещения имени]]></comment>
			</column>
			<column name="disallow_username" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[Запрещённое имя (ник) ]]></comment>
			</column>
			<index name="Pk_dem_disallow_usernames" unique="PRIMARY_KEY" >
				<column name="disallow_id" />
			</index>
		</table>
		<table name="dem_extension_groups" >
			<comment><![CDATA[Группы расширений, соотнесённые с типами файлов (Images, Text ...)  (PRIMARY 	group_id )]]></comment>
			<column name="group_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) гурппы расширений файлов-вложений]]></comment>
			</column>
			<column name="group_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя группы расширений файлов-вложений 


--IMAGES
--ARCHIVES
--PLAIN_TEXT
--DOCUMENTS
--REAL_MEDIA
--WINDOWS_MEDIA
--FLASH_FILES
--QUICKTIME_MEDIA
--DOWNLOADABLE_FILES]]></comment>
			</column>
			<column name="allow_group" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[идентификатор разрешения группы расширений файлов-вложений (1 - да) ]]></comment>
			</column>
			<column name="download_mode" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[идентификатор доступности скачивания  (1 - да) ]]></comment>
			</column>
			<column name="upload_icon" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[путь к файлу-картинке, используемой как иконка для файла-вложения данноой группы расширений ]]></comment>
			</column>
			<column name="max_filesize" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[максимально разрешённый размер файла-вложения данной группы расширений]]></comment>
			</column>
			<index name="Pk_dem_extension_groups" unique="PRIMARY_KEY" >
				<column name="group_id" />
			</index>
		</table>
		<table name="dem_extensions" >
			<comment><![CDATA[Расширения файлов (.xxx), разрешённые для вложений (PRIMARY 	extension_id )]]></comment>
			<column name="extension_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) типа расширения файла-вложения ]]></comment>
			</column>
			<column name="group_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[идентификатор (ID) группы расширений файлов-вложений для данного типа расширения связь с dem_extension_groups.group_id ]]></comment>
			</column>
			<column name="extension" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[тип расширения файлов-вложений (jpg, rar. txt и т.д.)  ]]></comment>
			</column>
			<index name="Pk_dem_extensions" unique="PRIMARY_KEY" >
				<column name="extension_id" />
			</index>
			<index name="idx_dem_extensions" unique="NORMAL" >
				<column name="group_id" />
			</index>
		</table>
		<table name="dem_forums" >
			<comment><![CDATA[Форумы (Наименование, Описание, Правила ...) (PRIMARY 	forum_id)]]></comment>
			<column name="forum_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) форума]]></comment>
			</column>
			<column name="parent_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Идентификатор (ID) форума-родителя (если 0 - нет родителя) связь с dem_forums.forum_id]]></comment>
			</column>
			<column name="forum_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[Имя форума]]></comment>
			</column>
			<column name="forum_desc" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[Описание форума ]]></comment>
			</column>
			<column name="forum_password" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[пароль доступа к форуму (если есть)]]></comment>
			</column>
			<column name="forum_pm" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[тип форума (0-форум, 1-форум личных сообщений(не участвует в подсчёте сообщений))]]></comment>
			</column>
			<column name="forum_status" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[статус форума (1 - закрыт, 0 - открыт)]]></comment>
			</column>
			<column name="display_subforum_list" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[признак показа списка подфорумов данного форума (1 - да) ]]></comment>
			</column>
			<column name="display_on_index" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[признак показа данного форума в списке подфорумов родительского форума (1 - да)]]></comment>
			</column>
			<column name="enable_indexing" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[признак участвует ли форум в поисковой индексации (1 - да)]]></comment>
			</column>
			<index name="Pk_dem_forums" unique="PRIMARY_KEY" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_forums" unique="NORMAL" >
				<column name="parent_id" />
			</index>
		</table>
		<table name="dem_forums_access_groups" >
			<comment><![CDATA[Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + group_id )]]></comment>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_forums.forum_id]]></comment>
			</column>
			<column name="group_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_groups.group_id]]></comment>
			</column>
			<index name="Pk_dem_forums_access_groups" unique="PRIMARY_KEY" >
				<column name="forum_id" />
				<column name="group_id" />
			</index>
			<index name="idx_dem_forums_access_groups_0" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_forums_access_groups" unique="NORMAL" >
				<column name="group_id" />
			</index>
		</table>
		<table name="dem_forums_access_users" >
			<comment><![CDATA[Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + user_id )]]></comment>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[ связь с dem_forums.forum_id]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_users.user_id ]]></comment>
			</column>
			<index name="Pk_dem_forums_access" unique="PRIMARY_KEY" >
				<column name="forum_id" />
				<column name="user_id" />
			</index>
			<index name="idx_dem_forums_access_users" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_forums_access_users_0" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_groups" >
			<comment><![CDATA[Данные о группах (PRIMARY group_id)]]></comment>
			<column name="group_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[уникальный номер (ID) группы]]></comment>
			</column>
			<column name="group_type" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[тип группы (4 - Открытая, 0 - По запросу, 1 - Закрытая, 2 - Скрытая, 3 - Предустановленная) - пересмотреть]]></comment>
			</column>
			<column name="group_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя группы]]></comment>
			</column>
			<column name="group_desc" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[описание группы]]></comment>
			</column>
			<column name="group_avatar_url" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[url файла аватара группы]]></comment>
			</column>
			<column name="group_colour" type="nvarchar" length="6" jt="12" mandatory="y" >
				<comment><![CDATA[код цвета группы]]></comment>
			</column>
			<column name="group_legend" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[признак отображения группы в легенде (1 - да) ]]></comment>
			</column>
			<index name="Pk_dem_groups" unique="PRIMARY_KEY" >
				<column name="group_id" />
			</index>
		</table>
		<table name="dem_lang" >
			<comment><![CDATA[Информация об установленных языковых пакетах  (PRIMARY 	lang_id  )]]></comment>
			<column name="lang_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[уникальный номер (ID) языкового пакета ]]></comment>
			</column>
			<column name="lang_iso" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[условное наименование языкового пакета (en - английский, ru - русский и т.п.)]]></comment>
			</column>
			<column name="lang_dir" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[наименование папки с языковым пакетом ]]></comment>
			</column>
			<column name="lang_english_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[наименование языкового пакета на английском языке ]]></comment>
			</column>
			<column name="lang_local_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[наименование языкового пакета на языке оригинала ]]></comment>
			</column>
			<column name="lang_author" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[автор языкового пакета ]]></comment>
			</column>
			<index name="Pk_dem_lang" unique="PRIMARY_KEY" >
				<column name="lang_id" />
			</index>
		</table>
		<table name="dem_log" >
			<comment><![CDATA[журналы наблюдений (логи) администраторов\модераторов\ошибок   (PRIMARY 	log_id  )]]></comment>
			<column name="log_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) записи ]]></comment>
			</column>
			<column name="log_type" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[тип действия, вызвавшего запись (0 - администрирование, 1 - модерирование, 2 - ошибки, 3 - изменения профиля пользователя) ]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[автор действия, вызвавшего запись, связь с dem_users.user_id]]></comment>
			</column>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[форум, в котором совершено записанное действие связь с dem_forums.forum_id ]]></comment>
			</column>
			<column name="topic_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[тема, в которой совершено записанное действие связь с dem_topics.topic_id ]]></comment>
			</column>
			<column name="reportee_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[идентификатор (ID) объекта действия, вызвавшего запись ]]></comment>
			</column>
			<column name="log_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[IP - адрес, с которого совершено действие, вызвавшее запись ]]></comment>
			</column>
			<column name="log_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время записи]]></comment>
			</column>
			<column name="log_operation" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[кртакое описание действия, вызвавшего запись (через определённые константы) 


--LOG_WARNING_DELETED
--LOG_USER_WARNING_BODY
--LOG_USER_WARNING
--и т.д.]]></comment>
			</column>
			<column name="log_data" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[данные записи ]]></comment>
			</column>
			<index name="Pk_dem_log" unique="PRIMARY_KEY" >
				<column name="log_id" />
			</index>
			<index name="idx_dem_log" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_log_0" unique="NORMAL" >
				<column name="topic_id" />
			</index>
			<index name="idx_dem_log_1" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_medals" >
			<comment><![CDATA[перечень медалей   (PRIMARY 	medal_id )]]></comment>
			<column name="medal_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) медали ]]></comment>
			</column>
			<column name="medal_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя медали ]]></comment>
			</column>
			<column name="medal_description" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[описание медали]]></comment>
			</column>
			<column name="medal_image" type="nvarchar(max)" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя изображения медали (url)]]></comment>
			</column>
			<column name="medals_cat_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id категории медали связь с dem_medals_cats.medals_cat_id ]]></comment>
			</column>
			<column name="medal_nominated" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[могут ли пользователи номинировать]]></comment>
			</column>
			<column name="medal_order_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[сортировка]]></comment>
			</column>
			<index name="Pk_dem_medals" unique="PRIMARY_KEY" >
				<column name="medal_id" />
			</index>
			<index name="idx_dem_medals" unique="NORMAL" >
				<column name="medals_cat_id" />
			</index>
		</table>
		<table name="dem_medals_awarded" >
			<comment><![CDATA[перечень награжденных медалями   (PRIMARY 	awarded_id )]]></comment>
			<column name="awarded_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) номинации ]]></comment>
			</column>
			<column name="medal_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id медали связь с dem_medals.medal_id ]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя, которому вручили награду связь с dem_users.user_id ]]></comment>
			</column>
			<column name="awarder_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя вручившего награду  связь с dem_users.user_id ]]></comment>
			</column>
			<column name="awarded_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время вручения награды (события)]]></comment>
			</column>
			<column name="awarded_nominated" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[номинирован (в номинации или подтверждена? 1 или 0 )]]></comment>
			</column>
			<column name="awarded_nominated_reason" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[причина выдачи награды]]></comment>
			</column>
			<index name="Pk_dem_medals_awarded" unique="PRIMARY_KEY" >
				<column name="awarded_id" />
			</index>
			<index name="idx_dem_medals_awarded" unique="NORMAL" >
				<column name="medal_id" />
			</index>
			<index name="idx_dem_medals_awarded_0" unique="NORMAL" >
				<column name="user_id" />
			</index>
			<index name="idx_dem_medals_awarded_1" unique="NORMAL" >
				<column name="awarder_id" />
			</index>
		</table>
		<table name="dem_medals_cats" >
			<comment><![CDATA[перечень категорий медалей   (PRIMARY 	medals_cat_id )]]></comment>
			<column name="medals_cat_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) категории ]]></comment>
			</column>
			<column name="medals_cat_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя категории ]]></comment>
			</column>
			<column name="medals_cat_order_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[сортировка]]></comment>
			</column>
			<index name="Pk_dem_medals_cats" unique="PRIMARY_KEY" >
				<column name="medals_cat_id" />
			</index>
		</table>
		<table name="dem_permissions_groups" >
			<comment><![CDATA[Список правил (глобальные и локальные) для групп  (PRIMARY -----)]]></comment>
			<column name="group_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[ id группы, к которой относится правило, связь dem_groups.group_id]]></comment>
			</column>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id форума, к которому относится правило (глобальное если 0), связь dem_forums.forum_id]]></comment>
			</column>
			<column name="rule_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id]]></comment>
			</column>
			<column name="settings_state" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Правило разрешено/запрещено]]></comment>
			</column>
			<index name="idx_dem_permissions_groups" unique="NORMAL" >
				<column name="group_id" />
			</index>
			<index name="idx_dem_permissions_groups_0" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_permissions_groups_1" unique="NORMAL" >
				<column name="rule_id" />
			</index>
		</table>
		<table name="dem_permissions_rules" >
			<comment><![CDATA[Список правил (глобальные и локальные)  (PRIMARY rule_id)]]></comment>
			<column name="rule_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[id правила]]></comment>
			</column>
			<column name="rule_name" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя правила]]></comment>
			</column>
			<column name="is_global" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[правило глобальное (применяется сразу ко всем форумам)]]></comment>
			</column>
			<column name="is_local" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[правило локальное (применяется к выбраному форуму)]]></comment>
			</column>
			<column name="founder_only" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[правило только для основателя]]></comment>
			</column>
			<index name="Pk_dem_permissions_rule" unique="PRIMARY_KEY" >
				<column name="rule_id" />
			</index>
		</table>
		<table name="dem_permissions_users" >
			<comment><![CDATA[Список правил (глобальные и локальные) для пользователей  (PRIMARY ----)]]></comment>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя, к которому относится правило, связь dem_users.user_id]]></comment>
			</column>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id группы, к которому относится правило (глобальное если 0), связь dem_forums.forum_id]]></comment>
			</column>
			<column name="rule_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id]]></comment>
			</column>
			<column name="settings_state" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Правило разрешено/запрещено]]></comment>
			</column>
			<index name="idx_dem_permissions_users" unique="NORMAL" >
				<column name="rule_id" />
			</index>
			<index name="idx_dem_permissions_users_1" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_permissions_users_0" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_poll_options" >
			<comment><![CDATA[Запись вариантов ответов для созданных тем-опросов   (PRIMARY poll_option_text )]]></comment>
			<column name="poll_option_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Порядковый номер варианта ответа в опросе]]></comment>
			</column>
			<column name="topic_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Идентификатор темы - опроса  с связь c dem_topics.topic_id  ]]></comment>
			</column>
			<column name="poll_option_text" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[Текст варианта ответа опроса]]></comment>
			</column>
			<column name="poll_option_total" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Число проголосовавших за вариант ответа]]></comment>
			</column>
			<index name="Pk_dem_poll_options_0" unique="NORMAL" >
				<column name="poll_option_id" />
			</index>
			<index name="idx_dem_poll_options" unique="NORMAL" >
				<column name="topic_id" />
			</index>
		</table>
		<table name="dem_poll_votes" >
			<comment><![CDATA[Запись результатов голосования пользователей   (PRIMARY 	---- )]]></comment>
			<column name="poll_option_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Порядковый номер варианта ответа в опросе связь c dem_poll_options.poll_option_id ]]></comment>
			</column>
			<column name="topic_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Идентификатор темы - опроса связь c dem_topics.topic_id  ]]></comment>
			</column>
			<column name="vote_user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ]]></comment>
			</column>
			<column name="vote_user_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[номер IP проголосовавшего пользователя ]]></comment>
			</column>
			<index name="Idx_dem_poll_votes_1" unique="NORMAL" >
				<column name="poll_option_id" />
			</index>
			<index name="idx_dem_poll_votes" unique="NORMAL" >
				<column name="topic_id" />
			</index>
			<index name="idx_dem_poll_votes_0" unique="NORMAL" >
				<column name="vote_user_id" />
			</index>
		</table>
		<table name="dem_post_rates" >
			<comment><![CDATA[таблица отданых голосов (PRIMARY 	post_id + user_id )]]></comment>
			<column name="post_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id сообщения связь с dem_posts.post_id]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя связь с dem_users.user_id ]]></comment>
			</column>
			<column name="rate" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[оценка]]></comment>
			</column>
			<column name="rate_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время выставления оценки]]></comment>
			</column>
			<index name="Idx_dem_post_rates" unique="PRIMARY_KEY" >
				<column name="post_id" />
				<column name="user_id" />
			</index>
			<index name="idx_dem_post_rates_0" unique="NORMAL" >
				<column name="post_id" />
			</index>
			<index name="idx_dem_post_rates_1" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_posts" >
			<comment><![CDATA[Содержание всех сообщений    (PRIMARY 	post_id  )]]></comment>
			<column name="post_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[id сообщения]]></comment>
			</column>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id форума, связь с dem_forums.forum_id ]]></comment>
			</column>
			<column name="topic_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id темы  связь с dem_topics.topic_id]]></comment>
			</column>
			<column name="poster_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя оставившего сообщение связь с dem_users.user_id ]]></comment>
			</column>
			<column name="poster_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[ip пользователя оставившего сообщение]]></comment>
			</column>
			<column name="post_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время отправки сообщения ]]></comment>
			</column>
			<column name="post_merged" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время объединения сообщений]]></comment>
			</column>
			<column name="post_reported" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[на сообщение есть жалоба]]></comment>
			</column>
			<column name="enable_bbcode" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[включены ли bbcode]]></comment>
			</column>
			<column name="enable_smilies" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[включены ли смайлы]]></comment>
			</column>
			<column name="enable_magic_url" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[обрабатывать URL (превращать в ссылку)]]></comment>
			</column>
			<column name="enable_sig" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[ставить ли подпись]]></comment>
			</column>
			<column name="post_subject" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[тема сообщения (заголовок)]]></comment>
			</column>
			<column name="post_text" type="ntext" length="250" jt="-1" mandatory="y" >
				<comment><![CDATA[текст сообщения]]></comment>
			</column>
			<column name="post_attachment" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[имеет ли сообщение вложения]]></comment>
			</column>
			<column name="post_edit_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время изменения сообщения]]></comment>
			</column>
			<column name="post_edit_reason" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[причина изменения сообщения]]></comment>
			</column>
			<column name="post_edit_user" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя изменившего сообщение связь с dem_users.user_id ]]></comment>
			</column>
			<column name="post_edit_count" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[количество изменений]]></comment>
			</column>
			<column name="post_edit_locked" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[изменение запрещено]]></comment>
			</column>
			<index name="Pk_dem_posts" unique="PRIMARY_KEY" >
				<column name="post_id" />
			</index>
			<index name="idx_dem_posts" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_posts_0" unique="NORMAL" >
				<column name="topic_id" />
			</index>
			<index name="idx_dem_posts_1" unique="NORMAL" >
				<column name="poster_id" />
			</index>
			<index name="idx_dem_posts_2" unique="NORMAL" >
				<column name="post_edit_user" />
			</index>
		</table>
		<table name="dem_ranks" >
			<comment><![CDATA[Список определённых на конференции званий   (PRIMARY 	rank_id  )]]></comment>
			<column name="rank_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[id ранга]]></comment>
			</column>
			<column name="rank_title" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[отображаемое имя ранга]]></comment>
			</column>
			<column name="rank_min" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[необходимое количество сообщений]]></comment>
			</column>
			<column name="rank_special" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[является ли специальным ]]></comment>
			</column>
			<column name="rank_image_url" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[изображение (url)]]></comment>
			</column>
			<index name="Pk_dem_ranks" unique="PRIMARY_KEY" >
				<column name="rank_id" />
			</index>
		</table>
		<table name="dem_reports" >
			<comment><![CDATA[Информация о жалобах на сообщения    (PRIMARY report_id   )]]></comment>
			<column name="report_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) жалобы ]]></comment>
			</column>
			<column name="post_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Сообщение, на которое пожаловались, связь с dem_posts.post_id]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Пользователь, создавший жалобу, связь c dem_users.user_id]]></comment>
			</column>
			<column name="reason_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Причина создания жалобы, связь с dem_reports_reasons.reason_id]]></comment>
			</column>
			<column name="user_notify" type="bit" jt="-7" mandatory="y" />
			<column name="report_closed" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[жалоба закрыта]]></comment>
			</column>
			<column name="report_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время создания жалобы]]></comment>
			</column>
			<column name="report_text" type="nvarchar(max)" length="250" jt="12" mandatory="y" >
				<comment><![CDATA[текст жалобы]]></comment>
			</column>
			<index name="Pk_dem_reports" unique="PRIMARY_KEY" >
				<column name="report_id" />
			</index>
			<index name="idx_dem_reports" unique="NORMAL" >
				<column name="post_id" />
			</index>
			<index name="idx_dem_reports_0" unique="NORMAL" >
				<column name="reason_id" />
			</index>
			<index name="idx_dem_reports_1" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_reports_reasons" >
			<comment><![CDATA[Информация об определённых на конференции причинах для жалоб    (PRIMARY reason_id  )]]></comment>
			<column name="reason_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) причины для жалобы ]]></comment>
			</column>
			<column name="reason_title" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[Имя причины для жалобы]]></comment>
			</column>
			<column name="reason_description" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[описание причины для жалобы]]></comment>
			</column>
			<column name="reason_order" type="tinyint" jt="-6" >
				<comment><![CDATA[сортировка]]></comment>
			</column>
			<index name="Pk_dem_reports_reasons" unique="PRIMARY_KEY" >
				<column name="reason_id" />
			</index>
		</table>
		<table name="dem_sessions" >
			<comment><![CDATA[Таблица сессий идентификации пользователей, просматривающих конференцию ]]></comment>
			<column name="session_id" type="nchar" length="32" jt="1" mandatory="y" >
				<comment><![CDATA[Уникальный идентификатор сессии ]]></comment>
			</column>
			<column name="session_user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_users.user_id ]]></comment>
			</column>
			<column name="session_forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_forums.forum_id ]]></comment>
			</column>
			<column name="session_last_visit" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[дата последнего визита]]></comment>
			</column>
			<column name="session_start" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[дата создания сессии]]></comment>
			</column>
			<column name="session_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[дата последней активности]]></comment>
			</column>
			<column name="session_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[ip пользователя]]></comment>
			</column>
			<column name="session_browser" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[данные браузера ]]></comment>
			</column>
			<column name="session_page" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[просматриваемая страница]]></comment>
			</column>
			<column name="session_viewonline" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[отображать вход пользователя (в счетчике/профиле)]]></comment>
			</column>
			<column name="session_autologin" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[автоматический вход ]]></comment>
			</column>
			<column name="session_admin" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[является ли администратором (вход в админку)]]></comment>
			</column>
			<index name="Pk_dem_sessions" unique="PRIMARY_KEY" >
				<column name="session_id" />
			</index>
			<index name="idx_dem_sessions" unique="NORMAL" >
				<column name="session_forum_id" />
			</index>
			<index name="idx_dem_sessions_0" unique="NORMAL" >
				<column name="session_user_id" />
			</index>
		</table>
		<table name="dem_sessions_keys" >
			<comment><![CDATA[Запись автоматического входа пользователей (автологин) ]]></comment>
			<column name="key_id" type="nchar" length="32" jt="1" mandatory="y" >
				<comment><![CDATA[Уникальный идентификатор сессии ]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_users.user_id ]]></comment>
			</column>
			<column name="last_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[ip пользователя]]></comment>
			</column>
			<column name="last_login" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[дата последнего входа ]]></comment>
			</column>
			<index name="Pk_dem_sessions_keys" unique="PRIMARY_KEY" >
				<column name="key_id" />
				<column name="user_id" />
			</index>
			<index name="idx_dem_sessions_keys" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_smilies" >
			<comment><![CDATA[Список установленных смайлов  ]]></comment>
			<column name="smiley_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[id смайла]]></comment>
			</column>
			<column name="code" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[код вызова в сообщении]]></comment>
			</column>
			<column name="emotion" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[выражаемая эмоция]]></comment>
			</column>
			<column name="smiley_url" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[url смайла]]></comment>
			</column>
			<column name="smiley_width" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[ширина]]></comment>
			</column>
			<column name="smiley_height" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[высота]]></comment>
			</column>
			<column name="smiley_order" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[порядок сортировки]]></comment>
			</column>
			<column name="display_on_posting" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[показывать в окне отправки сообщений]]></comment>
			</column>
			<index name="Pk_dem_smilies" unique="PRIMARY_KEY" >
				<column name="smiley_id" />
			</index>
		</table>
		<table name="dem_topics" >
			<comment><![CDATA[Информация о созданных темах на конференции  (PRIMARY topic_id)]]></comment>
			<column name="topic_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[id темы]]></comment>
			</column>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Идентификатор (ID) форума связь с dem_forums.forum_id]]></comment>
			</column>
			<column name="topic_title" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[название темы]]></comment>
			</column>
			<column name="topic_poster" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[автор темы, связь с dem_users.user_id ]]></comment>
			</column>
			<column name="topic_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время создания темы]]></comment>
			</column>
			<column name="topic_time_limit" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[тема открыта до указанного времени]]></comment>
			</column>
			<column name="topic_views" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[просмотров темы]]></comment>
			</column>
			<column name="topic_private_type" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[тип темы - приватная или нет (0-не приватный, 1-приватный) (замена ЛС)]]></comment>
			</column>
			<column name="topic_last_view_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[тему посмотрели последний раз (дата + время)]]></comment>
			</column>
			<column name="poll_title" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[тема опроса]]></comment>
			</column>
			<column name="poll_start" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время начала опроса]]></comment>
			</column>
			<column name="poll_length" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[продолжительность опроса]]></comment>
			</column>
			<column name="poll_max_options" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[сколько ответов может дать 1 пользователь]]></comment>
			</column>
			<column name="poll_last_vote" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[последний раз проголосовано (дата + время)]]></comment>
			</column>
			<column name="poll_vote_change" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[разрешено изменять голос]]></comment>
			</column>
			<column name="topic_first_post_show" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[закрепить первое сообщени на всех страницах]]></comment>
			</column>
			<index name="Pk_dem_topics" unique="PRIMARY_KEY" >
				<column name="topic_id" />
			</index>
			<index name="idx_dem_topics" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_topics_0" unique="NORMAL" >
				<column name="topic_poster" />
			</index>
		</table>
		<table name="dem_topics_watch" >
			<comment><![CDATA[Информация о подписанных темах    (PRIMARY 	---- )]]></comment>
			<column name="topic_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Идентификатор темы - опроса связь c dem_topics.topic_id  ]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ]]></comment>
			</column>
			<column name="notify_status" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[уведомлять или нет]]></comment>
			</column>
			<index name="idx_dem_topics_watch" unique="NORMAL" >
				<column name="topic_id" />
			</index>
			<index name="idx_dem_topics_watch_0" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_track_forums" >
			<comment><![CDATA[Информация о появления новых (не прочитанных)для пользователя сообщений в форумах  (PRIMARY 	user_id + forum_id )



--В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.]]></comment>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[ связь c dem_forums.forum_id ]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_users.user_id  ]]></comment>
			</column>
			<column name="mark_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время отметки о прочтении  ]]></comment>
			</column>
			<index name="Pk_dem_track_forums" unique="PRIMARY_KEY" >
				<column name="forum_id" />
				<column name="user_id" />
			</index>
			<index name="idx_dem_track_forums" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_track_forums_0" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_track_topics" >
			<comment><![CDATA[Информация о наличии новых (не прочитанных)сообщений в темах   (PRIMARY user_id + topic_id  )


В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.]]></comment>
			<column name="topic_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь c dem_topics.topic_id  ]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь с dem_users.user_id  ]]></comment>
			</column>
			<column name="forum_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[связь c dem_forums.forum_id]]></comment>
			</column>
			<column name="mark_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время отметки о непрочтении]]></comment>
			</column>
			<index name="idx_dem_track_topics" unique="NORMAL" >
				<column name="topic_id" />
			</index>
			<index name="Pk_dem_track_topics" unique="PRIMARY_KEY" >
				<column name="topic_id" />
				<column name="user_id" />
			</index>
			<index name="idx_dem_track_topics_0" unique="NORMAL" >
				<column name="forum_id" />
			</index>
			<index name="idx_dem_track_topics_1" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_user_confirm_keys" >
			<comment><![CDATA[ключи подтверждения действий (PRIMARY confirm_key)]]></comment>
			<column name="confirm_key" type="nvarchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[уникальный случайно сгенерированный ключ для подтверждения операции (к примеру удаление)]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя связь с dem_users.user_id ]]></comment>
			</column>
			<column name="confirm_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[ключ валиден до]]></comment>
			</column>
			<index name="Pk_dem_user_confirm_keys" unique="PRIMARY_KEY" >
				<column name="confirm_key" />
			</index>
			<index name="idx_dem_user_confirm_keys" unique="NORMAL" >
				<column name="user_id" />
			</index>
		</table>
		<table name="dem_users" >
			<comment><![CDATA[Информация о зарегистрированных пользователях (включая запись Гостя-Anonymous и Ботов)  (PRIMARY user_id)]]></comment>
			<column name="user_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[id пользователя]]></comment>
			</column>
			<column name="user_type" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[тип пользователя (основатель, бот и т.д.)]]></comment>
			</column>
			<column name="group_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[основная группа , связь с dem_groups.group_id]]></comment>
			</column>
			<column name="user_ip" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[ip пользователя]]></comment>
			</column>
			<column name="user_browser" type="nvarchar" length="225" jt="12" mandatory="y" >
				<comment><![CDATA[данные браузера пользователя]]></comment>
			</column>
			<column name="user_regdate" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[дата регистрации]]></comment>
			</column>
			<column name="username" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя пользователя]]></comment>
			</column>
			<column name="username_clean" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[имя пользователя в нижнем регисте и без спец символов]]></comment>
			</column>
			<column name="user_password" type="nvarchar" length="40" jt="12" mandatory="y" >
				<comment><![CDATA[сложный, комбинированый хэш пароля (выяснить как формируется или придумать свой)]]></comment>
			</column>
			<column name="user_password_change_date" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[дата последнего изменния пароля (user_passchg)]]></comment>
			</column>
			<column name="user_email" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[email пользователя]]></comment>
			</column>
			<column name="user_email_hash" type="nvarchar" length="40" jt="12" mandatory="y" >
				<comment><![CDATA[хэш email'а пользователя]]></comment>
			</column>
			<column name="user_birthday" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[день рождения пользователя]]></comment>
			</column>
			<column name="user_gender" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[пол пользователя]]></comment>
			</column>
			<column name="user_lastvisit" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[последний визит на форум (возможно последняя активность)]]></comment>
			</column>
			<column name="user_lastmark" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[последний раз отмечено "все темы прочитанным"]]></comment>
			</column>
			<column name="user_lastpage" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[последняя просмотренная страница]]></comment>
			</column>
			<column name="user_login_attempts" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[неудачных попыток залогинится]]></comment>
			</column>
			<column name="user_inactive_reason" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[причина неактивности (не подтверждён Емейл/бан и т.д.)]]></comment>
			</column>
			<column name="user_inactive_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[время неактивности]]></comment>
			</column>
			<column name="user_lang" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[язык выбран]]></comment>
			</column>
			<column name="user_timezone" type="decimal" length="5" decimal="2" jt="3" mandatory="y" >
				<comment><![CDATA[таймзона]]></comment>
			</column>
			<column name="user_dateformat" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[формат даты и времени]]></comment>
			</column>
			<column name="user_rank" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[ранг пользователя, связь с dem_ranks.rank_id]]></comment>
			</column>
			<column name="user_notify" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[оповещать пользователя о новостях сайта и т.п.?]]></comment>
			</column>
			<column name="user_notify_pm" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[оповещать пользователя системой личных сообщений?]]></comment>
			</column>
			<column name="user_avatar" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[ссылка на аватар пользователя]]></comment>
			</column>
			<column name="user_sig" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[подпись пользователя]]></comment>
			</column>
			<column name="user_from" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[откуда пользователь]]></comment>
			</column>
			<column name="user_steam" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[логин в Steam     ( user_jabber)]]></comment>
			</column>
			<column name="user_skype" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[логин в Skype]]></comment>
			</column>
			<column name="user_icq" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[номер в icq]]></comment>
			</column>
			<column name="user_website" type="nvarchar(max)" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[сайт пользователя]]></comment>
			</column>
			<column name="user_occ" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[род деятельности]]></comment>
			</column>
			<column name="user_interests" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[интересы]]></comment>
			</column>
			<column name="user_actkey" type="nvarchar" length="32" jt="12" mandatory="y" >
				<comment><![CDATA[ключ подтверждения EMail'а]]></comment>
			</column>
			<column name="user_newpasswd" type="nvarchar" length="40" jt="12" mandatory="y" >
				<comment><![CDATA[автосгенерированый пароль при смене пароля (вероятно)]]></comment>
			</column>
			<column name="user_form_salt" type="nvarchar" length="32" jt="12" mandatory="y" >
				<comment><![CDATA[(какой-то хеш)]]></comment>
			</column>
			<index name="Pk_dem_users" unique="PRIMARY_KEY" >
				<column name="user_id" />
			</index>
			<index name="idx_dem_users" unique="NORMAL" >
				<column name="group_id" />
			</index>
			<index name="idx_dem_users_0" unique="NORMAL" >
				<column name="user_rank" />
			</index>
		</table>
		<table name="dem_warnings" >
			<comment><![CDATA[Информация о предупреждениях пользователям  (PRIMARY warning_id)]]></comment>
			<column name="warning_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) предупреждения ]]></comment>
			</column>
			<column name="user_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id пользователя связь с dem_users.user_id ]]></comment>
			</column>
			<column name="issuer_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[кто выдал предупреждение]]></comment>
			</column>
			<column name="post_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id сообщения связь с dem_posts.post_id]]></comment>
			</column>
			<column name="log_id" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[id лог-записи связь с dem_log.log_id ]]></comment>
			</column>
			<column name="warning_time" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[момент окончания срока действия предупреждения]]></comment>
			</column>
			<column name="warning_days" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[на сколько бан]]></comment>
			</column>
			<column name="warning_type" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[тип предупреждения]]></comment>
			</column>
			<column name="warning_text" type="nvarchar(max)" length="250" jt="12" mandatory="y" >
				<comment><![CDATA[текст предупреждения]]></comment>
			</column>
			<index name="Pk_dem_warnings" unique="PRIMARY_KEY" >
				<column name="warning_id" />
			</index>
			<index name="idx_dem_warnings" unique="NORMAL" >
				<column name="post_id" />
			</index>
			<index name="idx_dem_warnings_1" unique="NORMAL" >
				<column name="log_id" />
			</index>
			<index name="idx_dem_warnings_0" unique="NORMAL" >
				<column name="user_id" />
			</index>
			<index name="Idx_dem_warnings_2" unique="NORMAL" >
				<column name="issuer_id" />
			</index>
		</table>
		<table name="dem_words" >
			<comment><![CDATA[Информация о запрещённых словах (автоцензор)   (PRIMARY word_id )]]></comment>
			<column name="word_id" type="int" jt="4" mandatory="y" autoincrement="y" >
				<comment><![CDATA[Уникальный номер (ID) замены]]></comment>
			</column>
			<column name="word" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[запрещенное слово]]></comment>
			</column>
			<column name="replacement" type="nvarchar" length="255" jt="12" mandatory="y" >
				<comment><![CDATA[замена для запрещенного слова]]></comment>
			</column>
			<index name="Pk_dem_words" unique="PRIMARY_KEY" >
				<column name="word_id" />
			</index>
		</table>
	</schema>
	<layout id="Layout_2d6176fc" name="DEM_MVC" show_relation_columns="y" >
		<entity schema="DEM_Project" name="dem_bots" color="aec7ef" x="75" y="345" />
		<entity schema="DEM_Project" name="dem_post_rates" color="aec7ef" x="75" y="510" />
		<entity schema="DEM_Project" name="dem_extension_groups" color="aec7ef" x="225" y="150" />
		<entity schema="DEM_Project" name="dem_extensions" color="aec7ef" x="240" y="345" />
		<entity schema="DEM_Project" name="dem_config" color="aec7ef" x="210" y="900" />
		<entity schema="DEM_Project" name="dem_disallow_usernames" color="aec7ef" x="210" y="990" />
		<entity schema="DEM_Project" name="dem_lang" color="aec7ef" x="375" y="960" />
		<entity schema="DEM_Project" name="dem_words" color="aec7ef" x="690" y="975" />
		<entity schema="DEM_Project" name="dem_smilies" color="aec7ef" x="525" y="945" />
		<entity schema="DEM_Project" name="dem_topics_watch" color="aec7ef" x="450" y="765" />
		<entity schema="DEM_Project" name="dem_reports_reasons" color="aec7ef" x="600" y="480" />
		<entity schema="DEM_Project" name="dem_track_topics" color="aec7ef" x="1020" y="780" />
		<entity schema="DEM_Project" name="dem_sessions" color="aec7ef" x="990" y="510" />
		<entity schema="DEM_Project" name="dem_log" color="aec7ef" x="825" y="600" />
		<entity schema="DEM_Project" name="dem_track_forums" color="aec7ef" x="1185" y="765" />
		<entity schema="DEM_Project" name="dem_sessions_keys" color="aec7ef" x="1140" y="585" />
		<entity schema="DEM_Project" name="dem_permissions_users" color="aec7ef" x="1140" y="465" />
		<entity schema="DEM_Project" name="dem_forums_access_users" color="aec7ef" x="960" y="240" />
		<entity schema="DEM_Project" name="dem_forums_access_groups" color="aec7ef" x="960" y="150" />
		<entity schema="DEM_Project" name="dem_groups" color="aec7ef" x="1200" y="150" />
		<entity schema="DEM_Project" name="dem_medals" color="aec7ef" x="1365" y="150" />
		<entity schema="DEM_Project" name="dem_medals_cats" color="aec7ef" x="1545" y="150" />
		<entity schema="DEM_Project" name="dem_permissions_rules" color="aec7ef" x="1335" y="330" />
		<entity schema="DEM_Project" name="dem_ranks" color="aec7ef" x="1380" y="690" />
		<entity schema="DEM_Project" name="dem_banlist" color="aec7ef" x="75" y="150" />
		<entity schema="DEM_Project" name="dem_permissions_groups" color="aec7ef" x="1140" y="345" />
		<entity schema="DEM_Project" name="dem_poll_votes" color="aec7ef" x="1575" y="540" />
		<entity schema="DEM_Project" name="dem_poll_options" color="aec7ef" x="1365" y="540" />
		<entity schema="DEM_Project" name="dem_reports" color="aec7ef" x="465" y="300" />
		<entity schema="DEM_Project" name="dem_user_confirm_keys" color="aec7ef" x="45" y="840" />
		<entity schema="DEM_Project" name="dem_warnings" color="aec7ef" x="45" y="645" />
		<entity schema="DEM_Project" name="dem_bbcodes" color="aec7ef" x="45" y="945" />
		<entity schema="DEM_Project" name="dem_posts" color="aec7ef" x="240" y="465" />
		<entity schema="DEM_Project" name="dem_forums" color="aec7ef" x="735" y="150" />
		<entity schema="DEM_Project" name="dem_medals_awarded" color="aec7ef" x="1515" y="255" />
		<entity schema="DEM_Project" name="dem_topics" color="aec7ef" x="1830" y="315" />
		<entity schema="DEM_Project" name="dem_users" color="aec7ef" x="2040" y="45" />
		<script name="Sql" id="SQL_376fc9e2" >
			<string><![CDATA[CREATE SCHEMA DEM_MVC;

CREATE TABLE DEM_MVC.test ( 
	q                    int NOT NULL   ,
	ww                   varchar(max)    ,
	CONSTRAINT Pk_test PRIMARY KEY ( q )
 );

]]></string>
		</script>
		<script name="Sql_001" id="SQL_353f22f0" >
			<string><![CDATA[CREATE SCHEMA DEM_MVC;

CREATE TABLE DEM_MVC.banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	ban_userid           int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_userid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_MVC', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

]]></string>
		</script>
		<script name="Sql_002" id="SQL_35776b2f" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	ban_userid           int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_userid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

]]></string>
		</script>
		<script name="Sql_003" id="SQL_2542f0bd" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	ban_userid           int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_userid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            int NOT NULL   IDENTITY,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

]]></string>
		</script>
		<script name="Sql_004" id="SQL_c5629ff" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	ban_userid           int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_userid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            int NOT NULL   IDENTITY,
	bbcode_tag           nvarchar(255) NOT NULL   ,
	bbcode_helpline      nvarchar(255) NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	bbcode_match         nvarchar(max) NOT NULL   ,
	bbcode_tpl           nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя тэга  (к примеру: "center")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tag';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_helpline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор отображения в форме ответа\постинга?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'display_on_posting';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст определения BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_match';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'html-замена BBCode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tpl';

]]></string>
		</script>
		<script name="Sql_005" id="SQL_22f7a3f4" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_bots ( 
	bot_id               int NOT NULL   IDENTITY,
	bot_active           bit NOT NULL   ,
	bot_name             nvarchar(255) NOT NULL   ,
	user_id              int NOT NULL   ,
	bot_agent            nvarchar(255) NOT NULL   ,
	bot_ip               nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_bots PRIMARY KEY ( bot_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список Ботов \ Поисковиков  (PRIMARY 	bot_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) бота\поисковика ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор активированности - разрешить или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_active';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_agent';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение IP-адреса бота\поисковика' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_ip';

]]></string>
		</script>
		<script name="Sql_006" id="SQL_2e64df58" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_config ( 
	config_name          nvarchar(255) NOT NULL   ,
	config_value         nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_config PRIMARY KEY ( config_name )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование параметра конфигурации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение параметра конфигурации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_value';

]]></string>
		</script>
		<script name="Sql_007" id="SQL_1c5b0380" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	ban_userid           int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_userid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            tinyint NOT NULL   IDENTITY,
	bbcode_tag           nvarchar(255) NOT NULL   ,
	bbcode_helpline      nvarchar(255) NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	bbcode_match         nvarchar(max) NOT NULL   ,
	bbcode_tpl           nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользовательские BBCode (PRIMARY 	bbcode_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя тэга  (к примеру: "center")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tag';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_helpline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор отображения в форме ответа\постинга?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'display_on_posting';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст определения BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_match';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'html-замена BBCode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tpl';

CREATE TABLE DEM_Project.dem_bots ( 
	bot_id               int NOT NULL   IDENTITY,
	bot_active           bit NOT NULL   ,
	bot_name             nvarchar(255) NOT NULL   ,
	user_id              int NOT NULL   ,
	bot_agent            nvarchar(255) NOT NULL   ,
	bot_ip               nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_bots PRIMARY KEY ( bot_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список Ботов \ Поисковиков  (PRIMARY 	bot_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) бота\поисковика ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор активированности - разрешить или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_active';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_agent';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение IP-адреса бота\поисковика' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_ip';

CREATE TABLE DEM_Project.dem_config ( 
	config_name          nvarchar(255) NOT NULL   ,
	config_value         nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_config PRIMARY KEY ( config_name )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование параметра конфигурации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение параметра конфигурации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_value';

CREATE TABLE DEM_Project.dem_disallow_usernames ( 
	disallow_id          int NOT NULL   IDENTITY,
	disallow_username    nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_disallow_usernames PRIMARY KEY ( disallow_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённые имена (PRIMARY 	disallow_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) запрещения имени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённое имя (ник) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_username';

CREATE TABLE DEM_Project.dem_extension_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_name           nvarchar(255) NOT NULL   ,
	allow_group          bit NOT NULL   ,
	download_mode        bit NOT NULL   ,
	upload_icon          nvarchar(255) NOT NULL   ,
	max_filesize         int NOT NULL   ,
	CONSTRAINT Pk_dem_extension_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Группы расширений, соотнесённые с типами файлов (Images, Text ...)  (PRIMARY 	group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы расширений файлов-вложений 


--IMAGES
--ARCHIVES
--PLAIN_TEXT
--DOCUMENTS
--REAL_MEDIA
--WINDOWS_MEDIA
--FLASH_FILES
--QUICKTIME_MEDIA
--DOWNLOADABLE_FILES' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор разрешения группы расширений файлов-вложений (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'allow_group';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор доступности скачивания  (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'download_mode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'путь к файлу-картинке, используемой как иконка для файла-вложения данноой группы расширений ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'upload_icon';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'максимально разрешённый размер файла-вложения данной группы расширений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'max_filesize';

CREATE TABLE DEM_Project.dem_extension_groups_allowed_forums ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	CONSTRAINT PK PRIMARY KEY ( group_id, forum_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень идентификаторов (ID) форумов, в которых разрешена данная группа расширений файлов-вложений  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

CREATE TABLE DEM_Project.dem_extensions ( 
	extension_id         int NOT NULL   IDENTITY,
	group_id             int NOT NULL   ,
	extension            nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_extensions PRIMARY KEY ( extension_id )
 );

CREATE INDEX idx_dem_extensions ON DEM_Project.dem_extensions ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Расширения файлов (.xxx), разрешённые для вложений (PRIMARY 	extension_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) типа расширения файла-вложения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) группы расширений файлов-вложений для данного типа расширения связь с dem_extension_groups.group_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип расширения файлов-вложений (jpg, rar. txt и т.д.)  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension';

ALTER TABLE DEM_Project.dem_extensions ADD CONSTRAINT fk_dem_extensions FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_extension_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

]]></string>
		</script>
		<script name="Sql_008" id="SQL_b5949b8" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            tinyint NOT NULL   IDENTITY,
	bbcode_tag           nvarchar(255) NOT NULL   ,
	bbcode_helpline      nvarchar(255) NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	bbcode_match         nvarchar(max) NOT NULL   ,
	bbcode_tpl           nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользовательские BBCode (PRIMARY 	bbcode_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя тэга  (к примеру: "center")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tag';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_helpline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор отображения в форме ответа\постинга?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'display_on_posting';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст определения BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_match';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'html-замена BBCode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tpl';

CREATE TABLE DEM_Project.dem_config ( 
	config_name          nvarchar(255) NOT NULL   ,
	config_value         nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_config PRIMARY KEY ( config_name )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование параметра конфигурации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение параметра конфигурации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_value';

CREATE TABLE DEM_Project.dem_disallow_usernames ( 
	disallow_id          int NOT NULL   IDENTITY,
	disallow_username    nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_disallow_usernames PRIMARY KEY ( disallow_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённые имена (PRIMARY 	disallow_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) запрещения имени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённое имя (ник) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_username';

CREATE TABLE DEM_Project.dem_extension_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_name           nvarchar(255) NOT NULL   ,
	allow_group          bit NOT NULL   ,
	download_mode        bit NOT NULL   ,
	upload_icon          nvarchar(255) NOT NULL   ,
	max_filesize         int NOT NULL   ,
	CONSTRAINT Pk_dem_extension_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Группы расширений, соотнесённые с типами файлов (Images, Text ...)  (PRIMARY 	group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы расширений файлов-вложений 


--IMAGES
--ARCHIVES
--PLAIN_TEXT
--DOCUMENTS
--REAL_MEDIA
--WINDOWS_MEDIA
--FLASH_FILES
--QUICKTIME_MEDIA
--DOWNLOADABLE_FILES' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор разрешения группы расширений файлов-вложений (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'allow_group';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор доступности скачивания  (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'download_mode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'путь к файлу-картинке, используемой как иконка для файла-вложения данноой группы расширений ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'upload_icon';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'максимально разрешённый размер файла-вложения данной группы расширений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'max_filesize';

CREATE TABLE DEM_Project.dem_extensions ( 
	extension_id         int NOT NULL   IDENTITY,
	group_id             int NOT NULL   ,
	extension            nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_extensions PRIMARY KEY ( extension_id )
 );

CREATE INDEX idx_dem_extensions ON DEM_Project.dem_extensions ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Расширения файлов (.xxx), разрешённые для вложений (PRIMARY 	extension_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) типа расширения файла-вложения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) группы расширений файлов-вложений для данного типа расширения связь с dem_extension_groups.group_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип расширения файлов-вложений (jpg, rar. txt и т.д.)  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension';

CREATE TABLE DEM_Project.dem_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_type           tinyint NOT NULL   ,
	group_name           nvarchar(255) NOT NULL   ,
	group_desc           nvarchar(max) NOT NULL   ,
	group_avatar_url     nvarchar(max) NOT NULL   ,
	group_colour         nvarchar(6) NOT NULL   ,
	group_legend         bit NOT NULL   ,
	CONSTRAINT Pk_dem_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Данные о группах (PRIMARY group_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип группы (4 - Открытая, 0 - По запросу, 1 - Закрытая, 2 - Скрытая, 3 - Предустановленная) - пересмотреть' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url файла аватара группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_avatar_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код цвета группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак отображения группы в легенде (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_legend';

CREATE TABLE DEM_Project.dem_lang ( 
	lang_id              int NOT NULL   IDENTITY,
	lang_iso             nvarchar(30) NOT NULL   ,
	lang_dir             nvarchar(30) NOT NULL   ,
	lang_english_name    nvarchar(255) NOT NULL   ,
	lang_local_name      nvarchar(255) NOT NULL   ,
	lang_author          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_lang PRIMARY KEY ( lang_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об установленных языковых пакетах  (PRIMARY 	lang_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'условное наименование языкового пакета (en - английский, ru - русский и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_iso';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование папки с языковым пакетом ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_dir';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на английском языке ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_english_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на языке оригинала ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_local_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_author';

CREATE TABLE DEM_Project.dem_medals_cats ( 
	medals_cat_id        int NOT NULL   IDENTITY,
	medals_cat_name      nvarchar(255) NOT NULL   ,
	medals_cat_order_id  int NOT NULL   ,
	CONSTRAINT Pk_dem_medals_cats PRIMARY KEY ( medals_cat_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень категорий медалей   (PRIMARY 	medals_cat_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_order_id';

CREATE TABLE DEM_Project.dem_permissions_rules ( 
	rule_id              int NOT NULL   IDENTITY,
	rule_name            nvarchar(255) NOT NULL   ,
	is_global            bit NOT NULL   ,
	is_local             bit NOT NULL   ,
	founder_only         bit NOT NULL   ,
	CONSTRAINT Pk_dem_permissions_rule PRIMARY KEY ( rule_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные)  (PRIMARY rule_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило глобальное (применяется сразу ко всем форумам)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_global';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило локальное (применяется к выбраному форуму)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_local';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило только для основателя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'founder_only';

CREATE TABLE DEM_Project.dem_ranks ( 
	rank_id              int NOT NULL   IDENTITY,
	rank_title           nvarchar(255) NOT NULL   ,
	rank_min             int NOT NULL   ,
	rank_special         bit NOT NULL   ,
	rank_image_url       nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_ranks PRIMARY KEY ( rank_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список определённых на конференции званий   (PRIMARY 	rank_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображаемое имя ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'необходимое количество сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_min';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли специальным ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_special';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изображение (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_image_url';

CREATE TABLE DEM_Project.dem_reports_reasons ( 
	reason_id            int NOT NULL   IDENTITY,
	reason_title         nvarchar(255) NOT NULL   ,
	reason_description   nvarchar(max) NOT NULL   ,
	reason_order         tinyint    ,
	CONSTRAINT Pk_dem_reports_reasons PRIMARY KEY ( reason_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об определённых на конференции причинах для жалоб    (PRIMARY reason_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) причины для жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_order';

CREATE TABLE DEM_Project.dem_smilies ( 
	smiley_id            int NOT NULL   IDENTITY,
	code                 nvarchar(50) NOT NULL   ,
	emotion              nvarchar(50) NOT NULL   ,
	smiley_url           nvarchar(255) NOT NULL   ,
	smiley_width         tinyint NOT NULL   ,
	smiley_height        tinyint NOT NULL   ,
	smiley_order         int NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	CONSTRAINT Pk_dem_smilies PRIMARY KEY ( smiley_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список установленных смайлов  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код вызова в сообщении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'code';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'выражаемая эмоция' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'emotion';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ширина' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_width';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'высота' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_height';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'порядок сортировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_order';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'показывать в окне отправки сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'display_on_posting';

CREATE TABLE DEM_Project.dem_users ( 
	user_id              int NOT NULL   IDENTITY,
	user_type            tinyint NOT NULL   ,
	group_id             int NOT NULL   ,
	user_ip              nvarchar(100) NOT NULL   ,
	user_browser         nvarchar(225) NOT NULL   ,
	user_regdate         smalldatetime NOT NULL   ,
	username             nvarchar(255) NOT NULL   ,
	username_clean       nvarchar(255) NOT NULL   ,
	user_password        nvarchar(40) NOT NULL   ,
	user_password_change_date smalldatetime NOT NULL   ,
	user_email           nvarchar(255) NOT NULL   ,
	user_email_hash      nvarchar(40) NOT NULL   ,
	user_birthday        smalldatetime NOT NULL   ,
	user_gender          bit NOT NULL   ,
	user_lastvisit       smalldatetime NOT NULL   ,
	user_lastmark        smalldatetime NOT NULL   ,
	user_lastpost_time   smalldatetime NOT NULL   ,
	user_lastpage        nvarchar(255) NOT NULL   ,
	user_rating_positive int NOT NULL   ,
	user_rating_negative int NOT NULL   ,
	user_rated_positive  int NOT NULL   ,
	user_rated_negative  int NOT NULL   ,
	user_warnings        tinyint NOT NULL   ,
	user_last_warning    smalldatetime NOT NULL   ,
	user_login_attempts  tinyint NOT NULL   ,
	user_inactive_reason tinyint NOT NULL   ,
	user_inactive_time   smalldatetime NOT NULL   ,
	user_topics          int NOT NULL   ,
	user_posts           int NOT NULL   ,
	user_lang            nvarchar(30) NOT NULL   ,
	user_timezone        decimal(5,2) NOT NULL   ,
	user_dateformat      nvarchar(30) NOT NULL   ,
	user_rank            int NOT NULL   ,
	user_colour          int NOT NULL   ,
	user_notify          bit NOT NULL   ,
	user_notify_pm       bit NOT NULL   ,
	user_avatar          nvarchar(max) NOT NULL   ,
	user_sig             nvarchar(max) NOT NULL   ,
	user_sig_bbcode_uid  nvarchar(8) NOT NULL   ,
	user_from            nvarchar(255) NOT NULL   ,
	user_steam           nvarchar(255) NOT NULL   ,
	user_skype           nvarchar(255) NOT NULL   ,
	user_icq             nvarchar(255) NOT NULL   ,
	user_website         nvarchar(max) NOT NULL   ,
	user_occ             nvarchar(255) NOT NULL   ,
	user_interests       nvarchar(max) NOT NULL   ,
	user_actkey          nvarchar(32) NOT NULL   ,
	user_newpasswd       nvarchar(40) NOT NULL   ,
	user_form_salt       nvarchar(32) NOT NULL   ,
	CONSTRAINT Pk_dem_users PRIMARY KEY ( user_id )
 );

CREATE INDEX idx_dem_users ON DEM_Project.dem_users ( group_id );

CREATE INDEX idx_dem_users_0 ON DEM_Project.dem_users ( user_rank );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о зарегистрированных пользователях (включая запись Гостя-Anonymous и Ботов)  (PRIMARY user_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип пользователя (основатель, бот и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'основная группа , связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата регистрации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_regdate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя в нижнем регисте и без спец символов' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username_clean';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сложный, комбинированый хэш пароля (выяснить как формируется или придумать свой)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего изменния пароля (user_passchg)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password_change_date';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'email пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'хэш email`а пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email_hash';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'день рождения пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_birthday';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пол пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_gender';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний визит на форум (возможно последняя активность)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastvisit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз отмечено "все темы прочитанным"' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastmark';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз оставил сообщение (время) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpost_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последняя просмотренная страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpage';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил предупреждений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_warnings';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последнее предупреждение (время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_last_warning';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'неудачных попыток залогинится' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_login_attempts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина неактивности (не подтверждён Емейл/бан и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время неактивности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тем создано' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сообщений оставлено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'язык выбран' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lang';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таймзона' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_timezone';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'формат даты и времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_dateformat';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ранг пользователя, связь с dem_ranks.rank_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rank';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет пользователя (наследуется у группы)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя о новостях сайта и т.п.?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя системой личных сообщений?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ссылка на аватар пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_avatar';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'подпись пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте подписи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig_bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'откуда пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_from';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Steam     ( user_jabber)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_steam';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Skype' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_skype';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер в icq' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_icq';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сайт пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_website';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'род деятельности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_occ';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'интересы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_interests';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ подтверждения EMail`а' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_actkey';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автосгенерированый пароль при смене пароля (вероятно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_newpasswd';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'(какой-то хеш)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_form_salt';

CREATE TABLE DEM_Project.dem_words ( 
	word_id              int NOT NULL   IDENTITY,
	word                 nvarchar(255) NOT NULL   ,
	replacement          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_words PRIMARY KEY ( word_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о запрещённых словах (автоцензор)   (PRIMARY word_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) замены' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'запрещенное слово' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'замена для запрещенного слова' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'replacement';

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

CREATE INDEX idx_dem_banlist ON DEM_Project.dem_banlist ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

CREATE TABLE DEM_Project.dem_bots ( 
	bot_id               int NOT NULL   IDENTITY,
	bot_active           bit NOT NULL   ,
	bot_name             nvarchar(255) NOT NULL   ,
	user_id              int NOT NULL   ,
	bot_agent            nvarchar(255) NOT NULL   ,
	bot_ip               nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_bots PRIMARY KEY ( bot_id )
 );

CREATE INDEX idx_dem_bots ON DEM_Project.dem_bots ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список Ботов \ Поисковиков  (PRIMARY 	bot_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) бота\поисковика ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор активированности - разрешить или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_active';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_agent';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение IP-адреса бота\поисковика' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_ip';

CREATE TABLE DEM_Project.dem_medals ( 
	medal_id             int NOT NULL   IDENTITY,
	medal_name           nvarchar(255) NOT NULL   ,
	medal_description    nvarchar(255) NOT NULL   ,
	medal_image          nvarchar(max) NOT NULL   ,
	medals_cat_id        int NOT NULL   ,
	medal_nominated      bit NOT NULL   ,
	medal_order_id       int NOT NULL   ,
	CONSTRAINT Pk_dem_medals PRIMARY KEY ( medal_id )
 );

CREATE INDEX idx_dem_medals ON DEM_Project.dem_medals ( medals_cat_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень медалей   (PRIMARY 	medal_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание медали' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя изображения медали (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_image';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id категории медали связь с dem_medals_cats.medals_cat_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'могут ли пользователи номинировать' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_order_id';

CREATE TABLE DEM_Project.dem_medals_awarded ( 
	awarded_id           int NOT NULL   IDENTITY,
	medal_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	awarder_id           int NOT NULL   ,
	awarded_time         smalldatetime NOT NULL   ,
	awarded_nominated    bit NOT NULL   ,
	awarded_nominated_reason nvarchar(max) NOT NULL   ,
	awarder_username     nvarchar(255) NOT NULL   ,
	awarder_color        nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_medals_awarded PRIMARY KEY ( awarded_id )
 );

CREATE INDEX idx_dem_medals_awarded ON DEM_Project.dem_medals_awarded ( medal_id );

CREATE INDEX idx_dem_medals_awarded_0 ON DEM_Project.dem_medals_awarded ( user_id );

CREATE INDEX idx_dem_medals_awarded_1 ON DEM_Project.dem_medals_awarded ( awarder_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень награжденных медалями   (PRIMARY 	awarded_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) номинации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id медали связь с dem_medals.medal_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, которому вручили награду связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя вручившего награду  связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время вручения награды (события)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номинирован (в номинации или подтверждена? 1 или 0 )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина выдачи награды' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_color';

CREATE TABLE DEM_Project.dem_sessions_keys ( 
	key_id               nchar(32) NOT NULL   ,
	user_id              int NOT NULL   ,
	last_ip              nvarchar(100) NOT NULL   ,
	last_login           smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_sessions_keys PRIMARY KEY ( key_id, user_id )
 );

CREATE INDEX idx_dem_sessions_keys ON DEM_Project.dem_sessions_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись автоматического входа пользователей (автологин) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'key_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего входа ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_login';

CREATE TABLE DEM_Project.dem_user_confirm_keys ( 
	confirm_key          nvarchar(10) NOT NULL   ,
	user_id              int NOT NULL   ,
	confirm_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_user_confirm_keys PRIMARY KEY ( confirm_key )
 );

CREATE INDEX idx_dem_user_confirm_keys ON DEM_Project.dem_user_confirm_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключи подтверждения действий (PRIMARY confirm_key)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный случайно сгенерированный ключ для подтверждения операции (к примеру удаление)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_key';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ валиден до' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_time';

CREATE TABLE DEM_Project.dem_extension_groups_allowed_forums ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	CONSTRAINT PK PRIMARY KEY ( group_id, forum_id )
 );

CREATE INDEX idx_dem_extension_groups_allowed_forums ON DEM_Project.dem_extension_groups_allowed_forums ( forum_id );

CREATE INDEX idx_dem_extension_groups_allowed_forums_0 ON DEM_Project.dem_extension_groups_allowed_forums ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень идентификаторов (ID) форумов, в которых разрешена данная группа расширений файлов-вложений  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

CREATE TABLE DEM_Project.dem_forums ( 
	forum_id             int NOT NULL   IDENTITY,
	parent_id            int NOT NULL   ,
	forum_name           nvarchar(255) NOT NULL   ,
	forum_desc           nvarchar(max) NOT NULL   ,
	forum_password       nvarchar(50) NOT NULL   ,
	forum_pm             bit NOT NULL   ,
	forum_status         bit NOT NULL   ,
	display_subforum_list bit NOT NULL   ,
	display_on_index     bit NOT NULL   ,
	enable_indexing      bit NOT NULL   ,
	forum_posts          int NOT NULL   ,
	forum_topics         int NOT NULL   ,
	forum_last_post_id   int NOT NULL   ,
	forum_last_poster_id int NOT NULL   ,
	forum_last_post_subject nvarchar(255) NOT NULL   ,
	forum_last_post_time smalldatetime NOT NULL   ,
	forum_last_poster_name nvarchar(255) NOT NULL   ,
	forum_last_poster_colour nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_forums PRIMARY KEY ( forum_id )
 );

CREATE INDEX idx_dem_forums ON DEM_Project.dem_forums ( parent_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Форумы (Наименование, Описание, Правила ...) (PRIMARY 	forum_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума-родителя (если 0 - нет родителя) связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'parent_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Описание форума ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пароль доступа к форуму (если есть)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип форума (0-форум, 1-форум личных сообщений(не участвует в подсчёте сообщений))' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'статус форума (1 - закрыт, 0 - открыт)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_status';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа списка подфорумов данного форума (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_subforum_list';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа данного форума в списке подфорумов родительского форума (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_on_index';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак участвует ли форум в поисковой индексации (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'enable_indexing';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число сообщений в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число тем в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) последнего сообщения в форуме связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'заголовок последнего сообщения в форуме  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время размещения последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'установленный цвет имени автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_colour';

CREATE TABLE DEM_Project.dem_forums_access_groups ( 
	forum_id             int NOT NULL   ,
	group_id             int NOT NULL   ,
	CONSTRAINT Idx_dem_forums_access_groups PRIMARY KEY ( forum_id, group_id )
 );

CREATE INDEX idx_dem_forums_access_groups_0 ON DEM_Project.dem_forums_access_groups ( forum_id );

CREATE INDEX idx_dem_forums_access_groups_1 ON DEM_Project.dem_forums_access_groups ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'group_id';

CREATE TABLE DEM_Project.dem_forums_access_users ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	CONSTRAINT Idx_dem_forums_access PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_forums_access_users ON DEM_Project.dem_forums_access_users ( forum_id );

CREATE INDEX idx_dem_forums_access_users_0 ON DEM_Project.dem_forums_access_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'user_id';

CREATE TABLE DEM_Project.dem_log ( 
	log_id               int NOT NULL   IDENTITY,
	log_type             tinyint NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	reportee_id          int NOT NULL   ,
	log_ip               nvarchar(100) NOT NULL   ,
	log_time             smalldatetime NOT NULL   ,
	log_operation        nvarchar(255) NOT NULL   ,
	log_data             nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_log PRIMARY KEY ( log_id )
 );

CREATE INDEX idx_dem_log ON DEM_Project.dem_log ( forum_id );

CREATE INDEX idx_dem_log_0 ON DEM_Project.dem_log ( topic_id );

CREATE INDEX idx_dem_log_1 ON DEM_Project.dem_log ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'журналы наблюдений (логи) администраторов\модераторов\ошибок   (PRIMARY 	log_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип действия, вызвавшего запись (0 - администрирование, 1 - модерирование, 2 - ошибки, 3 - изменения профиля пользователя) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор действия, вызвавшего запись, связь с dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'форум, в котором совершено записанное действие связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема, в которой совершено записанное действие связь с dem_topics.topic_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) объекта действия, вызвавшего запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'reportee_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'IP - адрес, с которого совершено действие, вызвавшее запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время записи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кртакое описание действия, вызвавшего запись (через определённые константы) 


--LOG_WARNING_DELETED
--LOG_USER_WARNING_BODY
--LOG_USER_WARNING
--и т.д.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_operation';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_data';

CREATE TABLE DEM_Project.dem_permissions_groups ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       bit NOT NULL   
 );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( group_id );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( forum_id );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( rule_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для групп  (PRIMARY -----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' id группы, к которой относится правило, связь dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_permissions_users ( 
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       int NOT NULL   
 );

CREATE INDEX idx_dem_permissions_users ON DEM_Project.dem_permissions_users ( rule_id );

CREATE INDEX idx_dem_permissions_users ON DEM_Project.dem_permissions_users ( forum_id );

CREATE INDEX idx_dem_permissions_users_0 ON DEM_Project.dem_permissions_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для пользователей  (PRIMARY ----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, к которому относится правило, связь dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id группы, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_poll_options ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poll_option_text     nvarchar(255) NOT NULL   ,
	poll_option_total    int NOT NULL   ,
	CONSTRAINT Pk_dem_poll_options PRIMARY KEY ( poll_option_text ),
	CONSTRAINT Pk_dem_poll_options_0 UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_options ON DEM_Project.dem_poll_options ( topic_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись вариантов ответов для созданных тем-опросов   (PRIMARY poll_option_text )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса  с связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст варианта ответа опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Число проголосовавших за вариант ответа' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_total';

CREATE TABLE DEM_Project.dem_poll_votes ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	vote_user_id         int NOT NULL   ,
	vote_user_ip         nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_poll_votes UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_votes ON DEM_Project.dem_poll_votes ( topic_id );

CREATE INDEX idx_dem_poll_votes_0 ON DEM_Project.dem_poll_votes ( vote_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись результатов голосования пользователей   (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе связь c dem_poll_options.poll_option_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер IP проголосовавшего пользователя ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_ip';

CREATE TABLE DEM_Project.dem_post_rates ( 
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	rate                 smallint NOT NULL   ,
	rate_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_post_rates PRIMARY KEY ( post_id, user_id )
 );

CREATE INDEX idx_dem_post_rates_0 ON DEM_Project.dem_post_rates ( post_id );

CREATE INDEX idx_dem_post_rates_1 ON DEM_Project.dem_post_rates ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таблица отданых голосов (PRIMARY 	post_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оценка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время выставления оценки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate_time';

CREATE TABLE DEM_Project.dem_posts ( 
	post_id              int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poster_id            int NOT NULL   ,
	poster_ip            nvarchar(100) NOT NULL   ,
	post_time            smalldatetime NOT NULL   ,
	post_merged          smalldatetime NOT NULL   ,
	post_reported        bit NOT NULL   ,
	enable_bbcode        bit NOT NULL   ,
	enable_smilies       bit NOT NULL   ,
	enable_magic_url     bit NOT NULL   ,
	enable_sig           bit NOT NULL   ,
	post_subject         nvarchar(255) NOT NULL   ,
	post_text            ntext NOT NULL   ,
	post_attachment      bit NOT NULL   ,
	bbcode_uid           nvarchar(8) NOT NULL   ,
	post_edit_time       smalldatetime NOT NULL   ,
	post_edit_reason     nvarchar(255) NOT NULL   ,
	post_rating_positive int NOT NULL   ,
	post_rating_negative int NOT NULL   ,
	post_edit_user       int NOT NULL   ,
	post_edit_count      int NOT NULL   ,
	post_edit_locked     bit NOT NULL   ,
	CONSTRAINT Pk_dem_posts PRIMARY KEY ( post_id )
 );

CREATE INDEX idx_dem_posts ON DEM_Project.dem_posts ( forum_id );

CREATE INDEX idx_dem_posts_0 ON DEM_Project.dem_posts ( topic_id );

CREATE INDEX idx_dem_posts_1 ON DEM_Project.dem_posts ( poster_id );

CREATE INDEX idx_dem_posts_2 ON DEM_Project.dem_posts ( post_edit_user );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Содержание всех сообщений    (PRIMARY 	post_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы  связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя оставившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя оставившего сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки сообщения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время объединения сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_merged';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'на сообщение есть жалоба' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли bbcode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_bbcode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли смайлы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_smilies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'обрабатывать URL (превращать в ссылку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_magic_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ставить ли подпись' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема сообщения (заголовок)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имеет ли сообщение вложения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_attachment';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте сообщения (удалить после конвертации БД)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'положительный рейтинг сообщения (кол-во +) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отрицательный рейтинг сообщения (кол-во -)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя изменившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_user';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'количество изменений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_count';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изменение запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_locked';

CREATE TABLE DEM_Project.dem_reports ( 
	report_id            int NOT NULL   IDENTITY,
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	reason_id            int NOT NULL   ,
	report_closed        bit NOT NULL   ,
	report_time          smalldatetime NOT NULL   ,
	report_text          nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_reports PRIMARY KEY ( report_id )
 );

CREATE INDEX idx_dem_reports ON DEM_Project.dem_reports ( post_id );

CREATE INDEX idx_dem_reports_0 ON DEM_Project.dem_reports ( reason_id );

CREATE INDEX idx_dem_reports_1 ON DEM_Project.dem_reports ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о жалобах на сообщения    (PRIMARY report_id   )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Сообщение, на которое пожаловались, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользователь, создавший жалобу, связь c dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Причина создания жалобы, связь с dem_reports_reasons.reason_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'жалоба закрыта' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_closed';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_text';

CREATE TABLE DEM_Project.dem_sessions ( 
	session_id           nchar(32) NOT NULL   ,
	session_user_id      int NOT NULL   ,
	session_forum_id     int NOT NULL   ,
	session_last_visit   smalldatetime NOT NULL   ,
	session_start        smalldatetime NOT NULL   ,
	session_time         smalldatetime NOT NULL   ,
	session_ip           nvarchar(100) NOT NULL   ,
	session_browser      nvarchar(255) NOT NULL   ,
	session_page         nvarchar(255) NOT NULL   ,
	session_viewonline   bit NOT NULL   ,
	session_autologin    bit NOT NULL   ,
	session_admin        bit NOT NULL   ,
	CONSTRAINT Pk_dem_sessions PRIMARY KEY ( session_id )
 );

CREATE INDEX idx_dem_sessions ON DEM_Project.dem_sessions ( session_forum_id );

CREATE INDEX idx_dem_sessions_0 ON DEM_Project.dem_sessions ( session_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Таблица сессий идентификации пользователей, просматривающих конференцию ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего визита' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_last_visit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата создания сессии' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последней активности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просматриваемая страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_page';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображать вход пользователя (в счетчике/профиле)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_viewonline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автоматический вход ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_autologin';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли администратором (вход в админку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_admin';

CREATE TABLE DEM_Project.dem_topics ( 
	topic_id             int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_reported       bit NOT NULL   ,
	topic_title          nvarchar(255) NOT NULL   ,
	topic_poster         int NOT NULL   ,
	topic_time           smalldatetime NOT NULL   ,
	topic_time_limit     smalldatetime NOT NULL   ,
	topic_views          int NOT NULL   ,
	topic_replies        int NOT NULL   ,
	topic_private_type   bit NOT NULL   ,
	topic_first_post_id  int NOT NULL   ,
	topic_first_poster_name nvarchar(255) NOT NULL   ,
	topic_first_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_id   int NOT NULL   ,
	topic_last_poster_id int NOT NULL   ,
	topic_last_poster_name nvarchar(255) NOT NULL   ,
	topic_last_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_subject nvarchar(255) NOT NULL   ,
	topic_last_post_time smalldatetime NOT NULL   ,
	topic_last_view_time smalldatetime NOT NULL   ,
	poll_title           nvarchar(255) NOT NULL   ,
	poll_start           smalldatetime NOT NULL   ,
	poll_length          smalldatetime NOT NULL   ,
	poll_max_options     tinyint NOT NULL   ,
	poll_last_vote       smalldatetime NOT NULL   ,
	poll_vote_change     bit NOT NULL   ,
	topic_first_post_show bit NOT NULL   ,
	CONSTRAINT Pk_dem_topics PRIMARY KEY ( topic_id )
 );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( forum_id );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( topic_first_post_id );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( topic_last_post_id );

CREATE INDEX idx_dem_topics_0 ON DEM_Project.dem_topics ( topic_poster );

CREATE INDEX idx_dem_topics_1 ON DEM_Project.dem_topics ( topic_last_poster_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о созданных темах на конференции  (PRIMARY topic_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'в теме есть сообщение, на которое пожаловались' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'название темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор темы, связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_poster';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема открыта до указанного времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time_limit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просмотров темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_views';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ответов в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_replies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип темы - приватная или нет (0-не приватный, 1-приватный) (замена ЛС)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_private_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id первого сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id последнего сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тему посмотрели последний раз (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_view_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время начала опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'продолжительность опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_length';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сколько ответов может дать 1 пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_max_options';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз проголосовано (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_last_vote';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'разрешено изменять голос' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_vote_change';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'закрепить первое сообщени на всех страницах' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_show';

CREATE TABLE DEM_Project.dem_topics_posted ( 
	user_id              int NOT NULL   ,
	topic_id             int NOT NULL   ,
	topic_posted         int NOT NULL   ,
	CONSTRAINT Idx_dem_topics_posted PRIMARY KEY ( user_id, topic_id )
 );

CREATE INDEX idx_dem_topics_posted_0 ON DEM_Project.dem_topics_posted ( topic_id );

CREATE INDEX idx_dem_topics_posted_1 ON DEM_Project.dem_topics_posted ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'есть сообщение в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_posted';

CREATE TABLE DEM_Project.dem_topics_watch ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	notify_status        bit NOT NULL   
 );

CREATE INDEX idx_dem_topics_watch ON DEM_Project.dem_topics_watch ( topic_id );

CREATE INDEX idx_dem_topics_watch_0 ON DEM_Project.dem_topics_watch ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о подписанных темах    (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уведомлять или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'notify_status';

CREATE TABLE DEM_Project.dem_track_forums ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_track_forums PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_track_forums ON DEM_Project.dem_track_forums ( forum_id );

CREATE INDEX idx_dem_track_forums_0 ON DEM_Project.dem_track_forums ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о появления новых (не прочитанных)для пользователя сообщений в форумах  (PRIMARY 	user_id + forum_id )



--В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь c dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о прочтении  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_track_topics ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_track_topics_0 PRIMARY KEY ( topic_id, user_id )
 );

CREATE INDEX idx_dem_track_topics ON DEM_Project.dem_track_topics ( topic_id );

CREATE INDEX idx_dem_track_topics ON DEM_Project.dem_track_topics ( forum_id );

CREATE INDEX idx_dem_track_topics_1 ON DEM_Project.dem_track_topics ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о наличии новых (не прочитанных)сообщений в темах   (PRIMARY user_id + topic_id  )


В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о непрочтении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_warnings ( 
	warning_id           int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	post_id              int NOT NULL   ,
	log_id               int NOT NULL   ,
	warning_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_warnings PRIMARY KEY ( warning_id )
 );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( post_id );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( log_id );

CREATE INDEX idx_dem_warnings_0 ON DEM_Project.dem_warnings ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о предупреждениях пользователям  (PRIMARY warning_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) предупреждения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id лог-записи связь с dem_log.log_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания срока действия предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_time';

ALTER TABLE DEM_Project.dem_banlist ADD CONSTRAINT fk_dem_banlist_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_bots ADD CONSTRAINT fk_dem_bots_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extension_groups_allowed_forums ADD CONSTRAINT fk_extension_groups_allowed_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extension_groups_allowed_forums ADD CONSTRAINT fk_extension_groups_allowed_forums_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_extension_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extensions ADD CONSTRAINT fk_extensions_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_extension_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums ADD CONSTRAINT fk_forums_dem_forums_parent_id FOREIGN KEY ( parent_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_groups ADD CONSTRAINT fk_dem_forums_access_groups_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_groups ADD CONSTRAINT fk_dem_forums_access_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_users ADD CONSTRAINT fk_dem_forums_access_users_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_users ADD CONSTRAINT fk_dem_forums_access_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals ADD CONSTRAINT fk_dem_medals_dem_medals_cats_cat_id FOREIGN KEY ( medals_cat_id ) REFERENCES DEM_Project.dem_medals_cats( medals_cat_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_medal_id FOREIGN KEY ( medal_id ) REFERENCES DEM_Project.dem_medals( medal_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_awarder_id FOREIGN KEY ( awarder_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_rule_id FOREIGN KEY ( rule_id ) REFERENCES DEM_Project.dem_permissions_rules( rule_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_rule_id FOREIGN KEY ( rule_id ) REFERENCES DEM_Project.dem_permissions_rules( rule_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_options ADD CONSTRAINT fk_dem_poll_options_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_poll_option_id FOREIGN KEY ( poll_option_id ) REFERENCES DEM_Project.dem_poll_options( poll_option_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_dem_users_user_id FOREIGN KEY ( vote_user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_post_rates ADD CONSTRAINT fk_dem_post_rates_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_post_rates ADD CONSTRAINT fk_dem_post_rates_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_users_user_id FOREIGN KEY ( poster_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_users_post_edit_user FOREIGN KEY ( post_edit_user ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_reson_id FOREIGN KEY ( reason_id ) REFERENCES DEM_Project.dem_reports_reasons( reason_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions ADD CONSTRAINT fk_dem_sessions_dem_forums_forum_id FOREIGN KEY ( session_forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions ADD CONSTRAINT fk_dem_sessions_dem_users_user_id FOREIGN KEY ( session_user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions_keys ADD CONSTRAINT fk_dem_sessions_keys_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_posts_first_post_id FOREIGN KEY ( topic_first_post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_posts_last_post_id FOREIGN KEY ( topic_last_post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_users_user_id FOREIGN KEY ( topic_poster ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_users_last_poster_id FOREIGN KEY ( topic_last_poster_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_posted ADD CONSTRAINT fk_dem_topics_posted_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_posted ADD CONSTRAINT fk_dem_topics_posted_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_watch ADD CONSTRAINT fk_dem_topics_watch_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_watch ADD CONSTRAINT fk_dem_topics_watch_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_forums ADD CONSTRAINT fk_dem_track_forums_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_forums ADD CONSTRAINT fk_dem_track_forums_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_user_confirm_keys ADD CONSTRAINT fk_dem_user_confirm_keys_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_users ADD CONSTRAINT fk_dem_users_dem_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_users ADD CONSTRAINT fk_dem_users_dem_ranks_rank_id FOREIGN KEY ( user_rank ) REFERENCES DEM_Project.dem_ranks( rank_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_log_log_id FOREIGN KEY ( log_id ) REFERENCES DEM_Project.dem_log( log_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_users FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

]]></string>
		</script>
		<script name="Sql_009" id="SQL_2ebf11d6" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            tinyint NOT NULL   IDENTITY,
	bbcode_tag           nvarchar(255) NOT NULL   ,
	bbcode_helpline      nvarchar(255) NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	bbcode_match         nvarchar(max) NOT NULL   ,
	bbcode_tpl           nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользовательские BBCode (PRIMARY 	bbcode_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя тэга  (к примеру: "center")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tag';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_helpline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор отображения в форме ответа\постинга?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'display_on_posting';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст определения BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_match';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'html-замена BBCode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tpl';

CREATE TABLE DEM_Project.dem_config ( 
	config_name          nvarchar(255) NOT NULL   ,
	config_value         nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_config PRIMARY KEY ( config_name )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование параметра конфигурации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение параметра конфигурации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_value';

CREATE TABLE DEM_Project.dem_disallow_usernames ( 
	disallow_id          int NOT NULL   IDENTITY,
	disallow_username    nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_disallow_usernames PRIMARY KEY ( disallow_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённые имена (PRIMARY 	disallow_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) запрещения имени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённое имя (ник) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_username';

CREATE TABLE DEM_Project.dem_extension_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_name           nvarchar(255) NOT NULL   ,
	allow_group          bit NOT NULL   ,
	download_mode        bit NOT NULL   ,
	upload_icon          nvarchar(255) NOT NULL   ,
	max_filesize         int NOT NULL   ,
	CONSTRAINT Pk_dem_extension_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Группы расширений, соотнесённые с типами файлов (Images, Text ...)  (PRIMARY 	group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы расширений файлов-вложений 


--IMAGES
--ARCHIVES
--PLAIN_TEXT
--DOCUMENTS
--REAL_MEDIA
--WINDOWS_MEDIA
--FLASH_FILES
--QUICKTIME_MEDIA
--DOWNLOADABLE_FILES' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор разрешения группы расширений файлов-вложений (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'allow_group';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор доступности скачивания  (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'download_mode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'путь к файлу-картинке, используемой как иконка для файла-вложения данноой группы расширений ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'upload_icon';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'максимально разрешённый размер файла-вложения данной группы расширений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'max_filesize';

CREATE TABLE DEM_Project.dem_extensions ( 
	extension_id         int NOT NULL   IDENTITY,
	group_id             int NOT NULL   ,
	extension            nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_extensions PRIMARY KEY ( extension_id )
 );

CREATE INDEX idx_dem_extensions ON DEM_Project.dem_extensions ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Расширения файлов (.xxx), разрешённые для вложений (PRIMARY 	extension_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) типа расширения файла-вложения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) группы расширений файлов-вложений для данного типа расширения связь с dem_extension_groups.group_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип расширения файлов-вложений (jpg, rar. txt и т.д.)  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension';

CREATE TABLE DEM_Project.dem_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_type           tinyint NOT NULL   ,
	group_name           nvarchar(255) NOT NULL   ,
	group_desc           nvarchar(max) NOT NULL   ,
	group_avatar_url     nvarchar(max) NOT NULL   ,
	group_colour         nvarchar(6) NOT NULL   ,
	group_legend         bit NOT NULL   ,
	CONSTRAINT Pk_dem_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Данные о группах (PRIMARY group_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип группы (4 - Открытая, 0 - По запросу, 1 - Закрытая, 2 - Скрытая, 3 - Предустановленная) - пересмотреть' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url файла аватара группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_avatar_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код цвета группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак отображения группы в легенде (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_legend';

CREATE TABLE DEM_Project.dem_lang ( 
	lang_id              int NOT NULL   IDENTITY,
	lang_iso             nvarchar(30) NOT NULL   ,
	lang_dir             nvarchar(30) NOT NULL   ,
	lang_english_name    nvarchar(255) NOT NULL   ,
	lang_local_name      nvarchar(255) NOT NULL   ,
	lang_author          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_lang PRIMARY KEY ( lang_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об установленных языковых пакетах  (PRIMARY 	lang_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'условное наименование языкового пакета (en - английский, ru - русский и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_iso';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование папки с языковым пакетом ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_dir';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на английском языке ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_english_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на языке оригинала ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_local_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_author';

CREATE TABLE DEM_Project.dem_medals_cats ( 
	medals_cat_id        int NOT NULL   IDENTITY,
	medals_cat_name      nvarchar(255) NOT NULL   ,
	medals_cat_order_id  int NOT NULL   ,
	CONSTRAINT Pk_dem_medals_cats PRIMARY KEY ( medals_cat_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень категорий медалей   (PRIMARY 	medals_cat_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_order_id';

CREATE TABLE DEM_Project.dem_permissions_rules ( 
	rule_id              int NOT NULL   IDENTITY,
	rule_name            nvarchar(255) NOT NULL   ,
	is_global            bit NOT NULL   ,
	is_local             bit NOT NULL   ,
	founder_only         bit NOT NULL   ,
	CONSTRAINT Pk_dem_permissions_rule PRIMARY KEY ( rule_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные)  (PRIMARY rule_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило глобальное (применяется сразу ко всем форумам)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_global';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило локальное (применяется к выбраному форуму)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_local';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило только для основателя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'founder_only';

CREATE TABLE DEM_Project.dem_ranks ( 
	rank_id              int NOT NULL   IDENTITY,
	rank_title           nvarchar(255) NOT NULL   ,
	rank_min             int NOT NULL   ,
	rank_special         bit NOT NULL   ,
	rank_image_url       nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_ranks PRIMARY KEY ( rank_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список определённых на конференции званий   (PRIMARY 	rank_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображаемое имя ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'необходимое количество сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_min';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли специальным ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_special';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изображение (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_image_url';

CREATE TABLE DEM_Project.dem_reports_reasons ( 
	reason_id            int NOT NULL   IDENTITY,
	reason_title         nvarchar(255) NOT NULL   ,
	reason_description   nvarchar(max) NOT NULL   ,
	reason_order         tinyint    ,
	CONSTRAINT Pk_dem_reports_reasons PRIMARY KEY ( reason_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об определённых на конференции причинах для жалоб    (PRIMARY reason_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) причины для жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_order';

CREATE TABLE DEM_Project.dem_smilies ( 
	smiley_id            int NOT NULL   IDENTITY,
	code                 nvarchar(50) NOT NULL   ,
	emotion              nvarchar(50) NOT NULL   ,
	smiley_url           nvarchar(255) NOT NULL   ,
	smiley_width         tinyint NOT NULL   ,
	smiley_height        tinyint NOT NULL   ,
	smiley_order         int NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	CONSTRAINT Pk_dem_smilies PRIMARY KEY ( smiley_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список установленных смайлов  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код вызова в сообщении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'code';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'выражаемая эмоция' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'emotion';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ширина' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_width';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'высота' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_height';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'порядок сортировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_order';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'показывать в окне отправки сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'display_on_posting';

CREATE TABLE DEM_Project.dem_users ( 
	user_id              int NOT NULL   IDENTITY,
	user_type            tinyint NOT NULL   ,
	group_id             int NOT NULL   ,
	user_ip              nvarchar(100) NOT NULL   ,
	user_browser         nvarchar(225) NOT NULL   ,
	user_regdate         smalldatetime NOT NULL   ,
	username             nvarchar(255) NOT NULL   ,
	username_clean       nvarchar(255) NOT NULL   ,
	user_password        nvarchar(40) NOT NULL   ,
	user_password_change_date smalldatetime NOT NULL   ,
	user_email           nvarchar(255) NOT NULL   ,
	user_email_hash      nvarchar(40) NOT NULL   ,
	user_birthday        smalldatetime NOT NULL   ,
	user_gender          bit NOT NULL   ,
	user_lastvisit       smalldatetime NOT NULL   ,
	user_lastmark        smalldatetime NOT NULL   ,
	user_lastpost_time   smalldatetime NOT NULL   ,
	user_lastpage        nvarchar(255) NOT NULL   ,
	user_rating_positive int NOT NULL   ,
	user_rating_negative int NOT NULL   ,
	user_rated_positive  int NOT NULL   ,
	user_rated_negative  int NOT NULL   ,
	user_warnings        tinyint NOT NULL   ,
	user_last_warning    smalldatetime NOT NULL   ,
	user_login_attempts  tinyint NOT NULL   ,
	user_inactive_reason tinyint NOT NULL   ,
	user_inactive_time   smalldatetime NOT NULL   ,
	user_topics          int NOT NULL   ,
	user_posts           int NOT NULL   ,
	user_lang            nvarchar(30) NOT NULL   ,
	user_timezone        decimal(5,2) NOT NULL   ,
	user_dateformat      nvarchar(30) NOT NULL   ,
	user_rank            int NOT NULL   ,
	user_colour          int NOT NULL   ,
	user_notify          bit NOT NULL   ,
	user_notify_pm       bit NOT NULL   ,
	user_avatar          nvarchar(max) NOT NULL   ,
	user_sig             nvarchar(max) NOT NULL   ,
	user_sig_bbcode_uid  nvarchar(8) NOT NULL   ,
	user_from            nvarchar(255) NOT NULL   ,
	user_steam           nvarchar(255) NOT NULL   ,
	user_skype           nvarchar(255) NOT NULL   ,
	user_icq             nvarchar(255) NOT NULL   ,
	user_website         nvarchar(max) NOT NULL   ,
	user_occ             nvarchar(255) NOT NULL   ,
	user_interests       nvarchar(max) NOT NULL   ,
	user_actkey          nvarchar(32) NOT NULL   ,
	user_newpasswd       nvarchar(40) NOT NULL   ,
	user_form_salt       nvarchar(32) NOT NULL   ,
	CONSTRAINT Pk_dem_users PRIMARY KEY ( user_id )
 );

CREATE INDEX idx_dem_users ON DEM_Project.dem_users ( group_id );

CREATE INDEX idx_dem_users_0 ON DEM_Project.dem_users ( user_rank );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о зарегистрированных пользователях (включая запись Гостя-Anonymous и Ботов)  (PRIMARY user_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип пользователя (основатель, бот и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'основная группа , связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата регистрации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_regdate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя в нижнем регисте и без спец символов' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username_clean';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сложный, комбинированый хэш пароля (выяснить как формируется или придумать свой)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего изменния пароля (user_passchg)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password_change_date';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'email пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'хэш email`а пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email_hash';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'день рождения пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_birthday';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пол пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_gender';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний визит на форум (возможно последняя активность)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastvisit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз отмечено "все темы прочитанным"' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastmark';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз оставил сообщение (время) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpost_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последняя просмотренная страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpage';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил предупреждений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_warnings';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последнее предупреждение (время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_last_warning';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'неудачных попыток залогинится' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_login_attempts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина неактивности (не подтверждён Емейл/бан и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время неактивности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тем создано' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сообщений оставлено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'язык выбран' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lang';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таймзона' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_timezone';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'формат даты и времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_dateformat';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ранг пользователя, связь с dem_ranks.rank_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rank';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет пользователя (наследуется у группы)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя о новостях сайта и т.п.?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя системой личных сообщений?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ссылка на аватар пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_avatar';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'подпись пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте подписи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig_bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'откуда пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_from';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Steam     ( user_jabber)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_steam';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Skype' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_skype';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер в icq' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_icq';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сайт пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_website';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'род деятельности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_occ';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'интересы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_interests';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ подтверждения EMail`а' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_actkey';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автосгенерированый пароль при смене пароля (вероятно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_newpasswd';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'(какой-то хеш)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_form_salt';

CREATE TABLE DEM_Project.dem_words ( 
	word_id              int NOT NULL   IDENTITY,
	word                 nvarchar(255) NOT NULL   ,
	replacement          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_words PRIMARY KEY ( word_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о запрещённых словах (автоцензор)   (PRIMARY word_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) замены' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'запрещенное слово' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'замена для запрещенного слова' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'replacement';

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

CREATE INDEX idx_dem_banlist ON DEM_Project.dem_banlist ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

CREATE TABLE DEM_Project.dem_bots ( 
	bot_id               int NOT NULL   IDENTITY,
	bot_active           bit NOT NULL   ,
	bot_name             nvarchar(255) NOT NULL   ,
	user_id              int NOT NULL   ,
	bot_agent            nvarchar(255) NOT NULL   ,
	bot_ip               nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_bots PRIMARY KEY ( bot_id )
 );

CREATE INDEX idx_dem_bots ON DEM_Project.dem_bots ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список Ботов \ Поисковиков  (PRIMARY 	bot_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) бота\поисковика ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор активированности - разрешить или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_active';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_agent';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение IP-адреса бота\поисковика' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_ip';

CREATE TABLE DEM_Project.dem_medals ( 
	medal_id             int NOT NULL   IDENTITY,
	medal_name           nvarchar(255) NOT NULL   ,
	medal_description    nvarchar(255) NOT NULL   ,
	medal_image          nvarchar(max) NOT NULL   ,
	medals_cat_id        int NOT NULL   ,
	medal_nominated      bit NOT NULL   ,
	medal_order_id       int NOT NULL   ,
	CONSTRAINT Pk_dem_medals PRIMARY KEY ( medal_id )
 );

CREATE INDEX idx_dem_medals ON DEM_Project.dem_medals ( medals_cat_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень медалей   (PRIMARY 	medal_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание медали' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя изображения медали (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_image';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id категории медали связь с dem_medals_cats.medals_cat_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'могут ли пользователи номинировать' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_order_id';

CREATE TABLE DEM_Project.dem_medals_awarded ( 
	awarded_id           int NOT NULL   IDENTITY,
	medal_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	awarder_id           int NOT NULL   ,
	awarded_time         smalldatetime NOT NULL   ,
	awarded_nominated    bit NOT NULL   ,
	awarded_nominated_reason nvarchar(max) NOT NULL   ,
	awarder_username     nvarchar(255) NOT NULL   ,
	awarder_color        nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_medals_awarded PRIMARY KEY ( awarded_id )
 );

CREATE INDEX idx_dem_medals_awarded ON DEM_Project.dem_medals_awarded ( medal_id );

CREATE INDEX idx_dem_medals_awarded_0 ON DEM_Project.dem_medals_awarded ( user_id );

CREATE INDEX idx_dem_medals_awarded_1 ON DEM_Project.dem_medals_awarded ( awarder_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень награжденных медалями   (PRIMARY 	awarded_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) номинации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id медали связь с dem_medals.medal_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, которому вручили награду связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя вручившего награду  связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время вручения награды (события)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номинирован (в номинации или подтверждена? 1 или 0 )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина выдачи награды' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_color';

CREATE TABLE DEM_Project.dem_sessions_keys ( 
	key_id               nchar(32) NOT NULL   ,
	user_id              int NOT NULL   ,
	last_ip              nvarchar(100) NOT NULL   ,
	last_login           smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_sessions_keys PRIMARY KEY ( key_id, user_id )
 );

CREATE INDEX idx_dem_sessions_keys ON DEM_Project.dem_sessions_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись автоматического входа пользователей (автологин) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'key_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего входа ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_login';

CREATE TABLE DEM_Project.dem_user_confirm_keys ( 
	confirm_key          nvarchar(10) NOT NULL   ,
	user_id              int NOT NULL   ,
	confirm_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_user_confirm_keys PRIMARY KEY ( confirm_key )
 );

CREATE INDEX idx_dem_user_confirm_keys ON DEM_Project.dem_user_confirm_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключи подтверждения действий (PRIMARY confirm_key)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный случайно сгенерированный ключ для подтверждения операции (к примеру удаление)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_key';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ валиден до' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_time';

CREATE TABLE DEM_Project.dem_extension_groups_allowed_forums ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	CONSTRAINT PK PRIMARY KEY ( group_id, forum_id )
 );

CREATE INDEX idx_dem_extension_groups_allowed_forums ON DEM_Project.dem_extension_groups_allowed_forums ( forum_id );

CREATE INDEX idx_dem_extension_groups_allowed_forums_0 ON DEM_Project.dem_extension_groups_allowed_forums ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень идентификаторов (ID) форумов, в которых разрешена данная группа расширений файлов-вложений  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

CREATE TABLE DEM_Project.dem_forums ( 
	forum_id             int NOT NULL   IDENTITY,
	parent_id            int NOT NULL   ,
	forum_name           nvarchar(255) NOT NULL   ,
	forum_desc           nvarchar(max) NOT NULL   ,
	forum_password       nvarchar(50) NOT NULL   ,
	forum_pm             bit NOT NULL   ,
	forum_status         bit NOT NULL   ,
	display_subforum_list bit NOT NULL   ,
	display_on_index     bit NOT NULL   ,
	enable_indexing      bit NOT NULL   ,
	forum_posts          int NOT NULL   ,
	forum_topics         int NOT NULL   ,
	forum_last_post_id   int NOT NULL   ,
	forum_last_poster_id int NOT NULL   ,
	forum_last_post_subject nvarchar(255) NOT NULL   ,
	forum_last_post_time smalldatetime NOT NULL   ,
	forum_last_poster_name nvarchar(255) NOT NULL   ,
	forum_last_poster_colour nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_forums PRIMARY KEY ( forum_id )
 );

CREATE INDEX idx_dem_forums ON DEM_Project.dem_forums ( parent_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Форумы (Наименование, Описание, Правила ...) (PRIMARY 	forum_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума-родителя (если 0 - нет родителя) связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'parent_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Описание форума ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пароль доступа к форуму (если есть)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип форума (0-форум, 1-форум личных сообщений(не участвует в подсчёте сообщений))' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'статус форума (1 - закрыт, 0 - открыт)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_status';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа списка подфорумов данного форума (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_subforum_list';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа данного форума в списке подфорумов родительского форума (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_on_index';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак участвует ли форум в поисковой индексации (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'enable_indexing';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число сообщений в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число тем в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) последнего сообщения в форуме связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'заголовок последнего сообщения в форуме  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время размещения последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'установленный цвет имени автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_colour';

CREATE TABLE DEM_Project.dem_forums_access_groups ( 
	forum_id             int NOT NULL   ,
	group_id             int NOT NULL   ,
	CONSTRAINT Idx_dem_forums_access_groups PRIMARY KEY ( forum_id, group_id )
 );

CREATE INDEX idx_dem_forums_access_groups_0 ON DEM_Project.dem_forums_access_groups ( forum_id );

CREATE INDEX idx_dem_forums_access_groups_1 ON DEM_Project.dem_forums_access_groups ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'group_id';

CREATE TABLE DEM_Project.dem_forums_access_users ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	CONSTRAINT Idx_dem_forums_access PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_forums_access_users ON DEM_Project.dem_forums_access_users ( forum_id );

CREATE INDEX idx_dem_forums_access_users_0 ON DEM_Project.dem_forums_access_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'user_id';

CREATE TABLE DEM_Project.dem_log ( 
	log_id               int NOT NULL   IDENTITY,
	log_type             tinyint NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	reportee_id          int NOT NULL   ,
	log_ip               nvarchar(100) NOT NULL   ,
	log_time             smalldatetime NOT NULL   ,
	log_operation        nvarchar(255) NOT NULL   ,
	log_data             nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_log PRIMARY KEY ( log_id )
 );

CREATE INDEX idx_dem_log ON DEM_Project.dem_log ( forum_id );

CREATE INDEX idx_dem_log_0 ON DEM_Project.dem_log ( topic_id );

CREATE INDEX idx_dem_log_1 ON DEM_Project.dem_log ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'журналы наблюдений (логи) администраторов\модераторов\ошибок   (PRIMARY 	log_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип действия, вызвавшего запись (0 - администрирование, 1 - модерирование, 2 - ошибки, 3 - изменения профиля пользователя) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор действия, вызвавшего запись, связь с dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'форум, в котором совершено записанное действие связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема, в которой совершено записанное действие связь с dem_topics.topic_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) объекта действия, вызвавшего запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'reportee_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'IP - адрес, с которого совершено действие, вызвавшее запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время записи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кртакое описание действия, вызвавшего запись (через определённые константы) 


--LOG_WARNING_DELETED
--LOG_USER_WARNING_BODY
--LOG_USER_WARNING
--и т.д.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_operation';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_data';

CREATE TABLE DEM_Project.dem_permissions_groups ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       bit NOT NULL   
 );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( group_id );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( forum_id );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( rule_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для групп  (PRIMARY -----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' id группы, к которой относится правило, связь dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_permissions_users ( 
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       int NOT NULL   
 );

CREATE INDEX idx_dem_permissions_users ON DEM_Project.dem_permissions_users ( rule_id );

CREATE INDEX idx_dem_permissions_users ON DEM_Project.dem_permissions_users ( forum_id );

CREATE INDEX idx_dem_permissions_users_0 ON DEM_Project.dem_permissions_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для пользователей  (PRIMARY ----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, к которому относится правило, связь dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id группы, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_poll_options ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poll_option_text     nvarchar(255) NOT NULL   ,
	poll_option_total    int NOT NULL   ,
	CONSTRAINT Pk_dem_poll_options PRIMARY KEY ( poll_option_text ),
	CONSTRAINT Pk_dem_poll_options_0 UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_options ON DEM_Project.dem_poll_options ( topic_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись вариантов ответов для созданных тем-опросов   (PRIMARY poll_option_text )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса  с связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст варианта ответа опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Число проголосовавших за вариант ответа' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_total';

CREATE TABLE DEM_Project.dem_poll_votes ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	vote_user_id         int NOT NULL   ,
	vote_user_ip         nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_poll_votes UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_votes ON DEM_Project.dem_poll_votes ( topic_id );

CREATE INDEX idx_dem_poll_votes_0 ON DEM_Project.dem_poll_votes ( vote_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись результатов голосования пользователей   (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе связь c dem_poll_options.poll_option_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер IP проголосовавшего пользователя ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_ip';

CREATE TABLE DEM_Project.dem_post_rates ( 
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	rate                 smallint NOT NULL   ,
	rate_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_post_rates PRIMARY KEY ( post_id, user_id )
 );

CREATE INDEX idx_dem_post_rates_0 ON DEM_Project.dem_post_rates ( post_id );

CREATE INDEX idx_dem_post_rates_1 ON DEM_Project.dem_post_rates ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таблица отданых голосов (PRIMARY 	post_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оценка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время выставления оценки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate_time';

CREATE TABLE DEM_Project.dem_posts ( 
	post_id              int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poster_id            int NOT NULL   ,
	poster_ip            nvarchar(100) NOT NULL   ,
	post_time            smalldatetime NOT NULL   ,
	post_merged          smalldatetime NOT NULL   ,
	post_reported        bit NOT NULL   ,
	enable_bbcode        bit NOT NULL   ,
	enable_smilies       bit NOT NULL   ,
	enable_magic_url     bit NOT NULL   ,
	enable_sig           bit NOT NULL   ,
	post_subject         nvarchar(255) NOT NULL   ,
	post_text            ntext NOT NULL   ,
	post_attachment      bit NOT NULL   ,
	bbcode_uid           nvarchar(8) NOT NULL   ,
	post_edit_time       smalldatetime NOT NULL   ,
	post_edit_reason     nvarchar(255) NOT NULL   ,
	post_rating_positive int NOT NULL   ,
	post_rating_negative int NOT NULL   ,
	post_edit_user       int NOT NULL   ,
	post_edit_count      int NOT NULL   ,
	post_edit_locked     bit NOT NULL   ,
	CONSTRAINT Pk_dem_posts PRIMARY KEY ( post_id )
 );

CREATE INDEX idx_dem_posts ON DEM_Project.dem_posts ( forum_id );

CREATE INDEX idx_dem_posts_0 ON DEM_Project.dem_posts ( topic_id );

CREATE INDEX idx_dem_posts_1 ON DEM_Project.dem_posts ( poster_id );

CREATE INDEX idx_dem_posts_2 ON DEM_Project.dem_posts ( post_edit_user );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Содержание всех сообщений    (PRIMARY 	post_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы  связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя оставившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя оставившего сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки сообщения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время объединения сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_merged';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'на сообщение есть жалоба' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли bbcode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_bbcode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли смайлы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_smilies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'обрабатывать URL (превращать в ссылку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_magic_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ставить ли подпись' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема сообщения (заголовок)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имеет ли сообщение вложения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_attachment';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте сообщения (удалить после конвертации БД)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'положительный рейтинг сообщения (кол-во +) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отрицательный рейтинг сообщения (кол-во -)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя изменившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_user';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'количество изменений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_count';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изменение запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_locked';

CREATE TABLE DEM_Project.dem_reports ( 
	report_id            int NOT NULL   IDENTITY,
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	reason_id            int NOT NULL   ,
	report_closed        bit NOT NULL   ,
	report_time          smalldatetime NOT NULL   ,
	report_text          nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_reports PRIMARY KEY ( report_id )
 );

CREATE INDEX idx_dem_reports ON DEM_Project.dem_reports ( post_id );

CREATE INDEX idx_dem_reports_0 ON DEM_Project.dem_reports ( reason_id );

CREATE INDEX idx_dem_reports_1 ON DEM_Project.dem_reports ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о жалобах на сообщения    (PRIMARY report_id   )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Сообщение, на которое пожаловались, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользователь, создавший жалобу, связь c dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Причина создания жалобы, связь с dem_reports_reasons.reason_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'жалоба закрыта' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_closed';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_text';

CREATE TABLE DEM_Project.dem_sessions ( 
	session_id           nchar(32) NOT NULL   ,
	session_user_id      int NOT NULL   ,
	session_forum_id     int NOT NULL   ,
	session_last_visit   smalldatetime NOT NULL   ,
	session_start        smalldatetime NOT NULL   ,
	session_time         smalldatetime NOT NULL   ,
	session_ip           nvarchar(100) NOT NULL   ,
	session_browser      nvarchar(255) NOT NULL   ,
	session_page         nvarchar(255) NOT NULL   ,
	session_viewonline   bit NOT NULL   ,
	session_autologin    bit NOT NULL   ,
	session_admin        bit NOT NULL   ,
	CONSTRAINT Pk_dem_sessions PRIMARY KEY ( session_id )
 );

CREATE INDEX idx_dem_sessions ON DEM_Project.dem_sessions ( session_forum_id );

CREATE INDEX idx_dem_sessions_0 ON DEM_Project.dem_sessions ( session_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Таблица сессий идентификации пользователей, просматривающих конференцию ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего визита' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_last_visit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата создания сессии' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последней активности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просматриваемая страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_page';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображать вход пользователя (в счетчике/профиле)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_viewonline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автоматический вход ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_autologin';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли администратором (вход в админку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_admin';

CREATE TABLE DEM_Project.dem_topics ( 
	topic_id             int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_reported       bit NOT NULL   ,
	topic_title          nvarchar(255) NOT NULL   ,
	topic_poster         int NOT NULL   ,
	topic_time           smalldatetime NOT NULL   ,
	topic_time_limit     smalldatetime NOT NULL   ,
	topic_views          int NOT NULL   ,
	topic_replies        int NOT NULL   ,
	topic_private_type   bit NOT NULL   ,
	topic_first_post_id  int NOT NULL   ,
	topic_first_poster_name nvarchar(255) NOT NULL   ,
	topic_first_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_id   int NOT NULL   ,
	topic_last_poster_id int NOT NULL   ,
	topic_last_poster_name nvarchar(255) NOT NULL   ,
	topic_last_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_subject nvarchar(255) NOT NULL   ,
	topic_last_post_time smalldatetime NOT NULL   ,
	topic_last_view_time smalldatetime NOT NULL   ,
	poll_title           nvarchar(255) NOT NULL   ,
	poll_start           smalldatetime NOT NULL   ,
	poll_length          smalldatetime NOT NULL   ,
	poll_max_options     tinyint NOT NULL   ,
	poll_last_vote       smalldatetime NOT NULL   ,
	poll_vote_change     bit NOT NULL   ,
	topic_first_post_show bit NOT NULL   ,
	CONSTRAINT Pk_dem_topics PRIMARY KEY ( topic_id )
 );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( forum_id );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( topic_first_post_id );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( topic_last_post_id );

CREATE INDEX idx_dem_topics_0 ON DEM_Project.dem_topics ( topic_poster );

CREATE INDEX idx_dem_topics_1 ON DEM_Project.dem_topics ( topic_last_poster_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о созданных темах на конференции  (PRIMARY topic_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'в теме есть сообщение, на которое пожаловались' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'название темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор темы, связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_poster';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема открыта до указанного времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time_limit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просмотров темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_views';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ответов в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_replies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип темы - приватная или нет (0-не приватный, 1-приватный) (замена ЛС)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_private_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id первого сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id последнего сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тему посмотрели последний раз (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_view_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время начала опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'продолжительность опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_length';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сколько ответов может дать 1 пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_max_options';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз проголосовано (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_last_vote';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'разрешено изменять голос' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_vote_change';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'закрепить первое сообщени на всех страницах' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_show';

CREATE TABLE DEM_Project.dem_topics_posted ( 
	user_id              int NOT NULL   ,
	topic_id             int NOT NULL   ,
	topic_posted         int NOT NULL   ,
	CONSTRAINT Idx_dem_topics_posted PRIMARY KEY ( user_id, topic_id )
 );

CREATE INDEX idx_dem_topics_posted_0 ON DEM_Project.dem_topics_posted ( topic_id );

CREATE INDEX idx_dem_topics_posted_1 ON DEM_Project.dem_topics_posted ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'есть сообщение в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_posted';

CREATE TABLE DEM_Project.dem_topics_watch ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	notify_status        bit NOT NULL   
 );

CREATE INDEX idx_dem_topics_watch ON DEM_Project.dem_topics_watch ( topic_id );

CREATE INDEX idx_dem_topics_watch_0 ON DEM_Project.dem_topics_watch ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о подписанных темах    (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уведомлять или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'notify_status';

CREATE TABLE DEM_Project.dem_track_forums ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_track_forums PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_track_forums ON DEM_Project.dem_track_forums ( forum_id );

CREATE INDEX idx_dem_track_forums_0 ON DEM_Project.dem_track_forums ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о появления новых (не прочитанных)для пользователя сообщений в форумах  (PRIMARY 	user_id + forum_id )



--В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь c dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о прочтении  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_track_topics ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_track_topics_0 PRIMARY KEY ( topic_id, user_id )
 );

CREATE INDEX idx_dem_track_topics ON DEM_Project.dem_track_topics ( topic_id );

CREATE INDEX idx_dem_track_topics ON DEM_Project.dem_track_topics ( forum_id );

CREATE INDEX idx_dem_track_topics_1 ON DEM_Project.dem_track_topics ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о наличии новых (не прочитанных)сообщений в темах   (PRIMARY user_id + topic_id  )


В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о непрочтении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_warnings ( 
	warning_id           int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	post_id              int NOT NULL   ,
	log_id               int NOT NULL   ,
	warning_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_warnings PRIMARY KEY ( warning_id )
 );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( post_id );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( log_id );

CREATE INDEX idx_dem_warnings_0 ON DEM_Project.dem_warnings ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о предупреждениях пользователям  (PRIMARY warning_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) предупреждения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id лог-записи связь с dem_log.log_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания срока действия предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_time';

ALTER TABLE DEM_Project.dem_banlist ADD CONSTRAINT fk_dem_banlist_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_bots ADD CONSTRAINT fk_dem_bots_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extension_groups_allowed_forums ADD CONSTRAINT fk_extension_groups_allowed_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extension_groups_allowed_forums ADD CONSTRAINT fk_extension_groups_allowed_forums_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_extension_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extensions ADD CONSTRAINT fk_extensions_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_extension_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums ADD CONSTRAINT fk_forums_dem_forums_parent_id FOREIGN KEY ( parent_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_groups ADD CONSTRAINT fk_dem_forums_access_groups_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_groups ADD CONSTRAINT fk_dem_forums_access_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_users ADD CONSTRAINT fk_dem_forums_access_users_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_users ADD CONSTRAINT fk_dem_forums_access_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals ADD CONSTRAINT fk_dem_medals_dem_medals_cats_cat_id FOREIGN KEY ( medals_cat_id ) REFERENCES DEM_Project.dem_medals_cats( medals_cat_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_medal_id FOREIGN KEY ( medal_id ) REFERENCES DEM_Project.dem_medals( medal_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_awarder_id FOREIGN KEY ( awarder_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_rule_id FOREIGN KEY ( rule_id ) REFERENCES DEM_Project.dem_permissions_rules( rule_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_rule_id FOREIGN KEY ( rule_id ) REFERENCES DEM_Project.dem_permissions_rules( rule_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_options ADD CONSTRAINT fk_dem_poll_options_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_poll_option_id FOREIGN KEY ( poll_option_id ) REFERENCES DEM_Project.dem_poll_options( poll_option_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_dem_users_user_id FOREIGN KEY ( vote_user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_post_rates ADD CONSTRAINT fk_dem_post_rates_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_post_rates ADD CONSTRAINT fk_dem_post_rates_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_users_user_id FOREIGN KEY ( poster_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_users_post_edit_user FOREIGN KEY ( post_edit_user ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_reson_id FOREIGN KEY ( reason_id ) REFERENCES DEM_Project.dem_reports_reasons( reason_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions ADD CONSTRAINT fk_dem_sessions_dem_forums_forum_id FOREIGN KEY ( session_forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions ADD CONSTRAINT fk_dem_sessions_dem_users_user_id FOREIGN KEY ( session_user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions_keys ADD CONSTRAINT fk_dem_sessions_keys_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_posts_first_post_id FOREIGN KEY ( topic_first_post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_posts_last_post_id FOREIGN KEY ( topic_last_post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_users_user_id FOREIGN KEY ( topic_poster ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_users_last_poster_id FOREIGN KEY ( topic_last_poster_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_posted ADD CONSTRAINT fk_dem_topics_posted_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_posted ADD CONSTRAINT fk_dem_topics_posted_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_watch ADD CONSTRAINT fk_dem_topics_watch_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_watch ADD CONSTRAINT fk_dem_topics_watch_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_forums ADD CONSTRAINT fk_dem_track_forums_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_forums ADD CONSTRAINT fk_dem_track_forums_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_user_confirm_keys ADD CONSTRAINT fk_dem_user_confirm_keys_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_users ADD CONSTRAINT fk_dem_users_dem_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_users ADD CONSTRAINT fk_dem_users_dem_ranks_rank_id FOREIGN KEY ( user_rank ) REFERENCES DEM_Project.dem_ranks( rank_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_log_log_id FOREIGN KEY ( log_id ) REFERENCES DEM_Project.dem_log( log_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_users FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

]]></string>
		</script>
		<script name="Sql_010" id="SQL_1cbca543" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            tinyint NOT NULL   IDENTITY,
	bbcode_tag           nvarchar(255) NOT NULL   ,
	bbcode_helpline      nvarchar(255) NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	bbcode_match         nvarchar(max) NOT NULL   ,
	bbcode_tpl           nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользовательские BBCode (PRIMARY 	bbcode_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя тэга  (к примеру: "center")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tag';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_helpline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор отображения в форме ответа\постинга?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'display_on_posting';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст определения BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_match';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'html-замена BBCode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tpl';

CREATE TABLE DEM_Project.dem_config ( 
	config_name          nvarchar(255) NOT NULL   ,
	config_value         nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_config PRIMARY KEY ( config_name )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование параметра конфигурации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение параметра конфигурации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_value';

CREATE TABLE DEM_Project.dem_disallow_usernames ( 
	disallow_id          int NOT NULL   IDENTITY,
	disallow_username    nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_disallow_usernames PRIMARY KEY ( disallow_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённые имена (PRIMARY 	disallow_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) запрещения имени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённое имя (ник) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_username';

CREATE TABLE DEM_Project.dem_extension_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_name           nvarchar(255) NOT NULL   ,
	allow_group          bit NOT NULL   ,
	download_mode        bit NOT NULL   ,
	upload_icon          nvarchar(255) NOT NULL   ,
	max_filesize         int NOT NULL   ,
	CONSTRAINT Pk_dem_extension_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Группы расширений, соотнесённые с типами файлов (Images, Text ...)  (PRIMARY 	group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы расширений файлов-вложений 


--IMAGES
--ARCHIVES
--PLAIN_TEXT
--DOCUMENTS
--REAL_MEDIA
--WINDOWS_MEDIA
--FLASH_FILES
--QUICKTIME_MEDIA
--DOWNLOADABLE_FILES' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор разрешения группы расширений файлов-вложений (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'allow_group';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор доступности скачивания  (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'download_mode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'путь к файлу-картинке, используемой как иконка для файла-вложения данноой группы расширений ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'upload_icon';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'максимально разрешённый размер файла-вложения данной группы расширений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'max_filesize';

CREATE TABLE DEM_Project.dem_extensions ( 
	extension_id         int NOT NULL   IDENTITY,
	group_id             int NOT NULL   ,
	extension            nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_extensions PRIMARY KEY ( extension_id )
 );

CREATE INDEX idx_dem_extensions ON DEM_Project.dem_extensions ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Расширения файлов (.xxx), разрешённые для вложений (PRIMARY 	extension_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) типа расширения файла-вложения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) группы расширений файлов-вложений для данного типа расширения связь с dem_extension_groups.group_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип расширения файлов-вложений (jpg, rar. txt и т.д.)  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension';

CREATE TABLE DEM_Project.dem_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_type           tinyint NOT NULL   ,
	group_name           nvarchar(255) NOT NULL   ,
	group_desc           nvarchar(max) NOT NULL   ,
	group_avatar_url     nvarchar(max) NOT NULL   ,
	group_colour         nvarchar(6) NOT NULL   ,
	group_legend         bit NOT NULL   ,
	CONSTRAINT Pk_dem_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Данные о группах (PRIMARY group_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип группы (4 - Открытая, 0 - По запросу, 1 - Закрытая, 2 - Скрытая, 3 - Предустановленная) - пересмотреть' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url файла аватара группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_avatar_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код цвета группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак отображения группы в легенде (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_legend';

CREATE TABLE DEM_Project.dem_lang ( 
	lang_id              int NOT NULL   IDENTITY,
	lang_iso             nvarchar(30) NOT NULL   ,
	lang_dir             nvarchar(30) NOT NULL   ,
	lang_english_name    nvarchar(255) NOT NULL   ,
	lang_local_name      nvarchar(255) NOT NULL   ,
	lang_author          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_lang PRIMARY KEY ( lang_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об установленных языковых пакетах  (PRIMARY 	lang_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'условное наименование языкового пакета (en - английский, ru - русский и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_iso';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование папки с языковым пакетом ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_dir';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на английском языке ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_english_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на языке оригинала ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_local_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_author';

CREATE TABLE DEM_Project.dem_medals_cats ( 
	medals_cat_id        int NOT NULL   IDENTITY,
	medals_cat_name      nvarchar(255) NOT NULL   ,
	medals_cat_order_id  int NOT NULL   ,
	CONSTRAINT Pk_dem_medals_cats PRIMARY KEY ( medals_cat_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень категорий медалей   (PRIMARY 	medals_cat_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_order_id';

CREATE TABLE DEM_Project.dem_permissions_rules ( 
	rule_id              int NOT NULL   IDENTITY,
	rule_name            nvarchar(255) NOT NULL   ,
	is_global            bit NOT NULL   ,
	is_local             bit NOT NULL   ,
	founder_only         bit NOT NULL   ,
	CONSTRAINT Pk_dem_permissions_rule PRIMARY KEY ( rule_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные)  (PRIMARY rule_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило глобальное (применяется сразу ко всем форумам)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_global';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило локальное (применяется к выбраному форуму)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_local';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило только для основателя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'founder_only';

CREATE TABLE DEM_Project.dem_ranks ( 
	rank_id              int NOT NULL   IDENTITY,
	rank_title           nvarchar(255) NOT NULL   ,
	rank_min             int NOT NULL   ,
	rank_special         bit NOT NULL   ,
	rank_image_url       nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_ranks PRIMARY KEY ( rank_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список определённых на конференции званий   (PRIMARY 	rank_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображаемое имя ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'необходимое количество сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_min';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли специальным ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_special';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изображение (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_image_url';

CREATE TABLE DEM_Project.dem_reports_reasons ( 
	reason_id            int NOT NULL   IDENTITY,
	reason_title         nvarchar(255) NOT NULL   ,
	reason_description   nvarchar(max) NOT NULL   ,
	reason_order         tinyint    ,
	CONSTRAINT Pk_dem_reports_reasons PRIMARY KEY ( reason_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об определённых на конференции причинах для жалоб    (PRIMARY reason_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) причины для жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_order';

CREATE TABLE DEM_Project.dem_smilies ( 
	smiley_id            int NOT NULL   IDENTITY,
	code                 nvarchar(50) NOT NULL   ,
	emotion              nvarchar(50) NOT NULL   ,
	smiley_url           nvarchar(255) NOT NULL   ,
	smiley_width         tinyint NOT NULL   ,
	smiley_height        tinyint NOT NULL   ,
	smiley_order         int NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	CONSTRAINT Pk_dem_smilies PRIMARY KEY ( smiley_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список установленных смайлов  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код вызова в сообщении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'code';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'выражаемая эмоция' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'emotion';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ширина' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_width';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'высота' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_height';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'порядок сортировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_order';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'показывать в окне отправки сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'display_on_posting';

CREATE TABLE DEM_Project.dem_users ( 
	user_id              int NOT NULL   IDENTITY,
	user_type            tinyint NOT NULL   ,
	group_id             int NOT NULL   ,
	user_ip              nvarchar(100) NOT NULL   ,
	user_browser         nvarchar(225) NOT NULL   ,
	user_regdate         smalldatetime NOT NULL   ,
	username             nvarchar(255) NOT NULL   ,
	username_clean       nvarchar(255) NOT NULL   ,
	user_password        nvarchar(40) NOT NULL   ,
	user_password_change_date smalldatetime NOT NULL   ,
	user_email           nvarchar(255) NOT NULL   ,
	user_email_hash      nvarchar(40) NOT NULL   ,
	user_birthday        smalldatetime NOT NULL   ,
	user_gender          bit NOT NULL   ,
	user_lastvisit       smalldatetime NOT NULL   ,
	user_lastmark        smalldatetime NOT NULL   ,
	user_lastpost_time   smalldatetime NOT NULL   ,
	user_lastpage        nvarchar(255) NOT NULL   ,
	user_rating_positive int NOT NULL   ,
	user_rating_negative int NOT NULL   ,
	user_rated_positive  int NOT NULL   ,
	user_rated_negative  int NOT NULL   ,
	user_warnings        tinyint NOT NULL   ,
	user_last_warning    smalldatetime NOT NULL   ,
	user_login_attempts  tinyint NOT NULL   ,
	user_inactive_reason tinyint NOT NULL   ,
	user_inactive_time   smalldatetime NOT NULL   ,
	user_topics          int NOT NULL   ,
	user_posts           int NOT NULL   ,
	user_lang            nvarchar(30) NOT NULL   ,
	user_timezone        decimal(5,2) NOT NULL   ,
	user_dateformat      nvarchar(30) NOT NULL   ,
	user_rank            int NOT NULL   ,
	user_colour          int NOT NULL   ,
	user_notify          bit NOT NULL   ,
	user_notify_pm       bit NOT NULL   ,
	user_avatar          nvarchar(max) NOT NULL   ,
	user_sig             nvarchar(max) NOT NULL   ,
	user_sig_bbcode_uid  nvarchar(8) NOT NULL   ,
	user_from            nvarchar(255) NOT NULL   ,
	user_steam           nvarchar(255) NOT NULL   ,
	user_skype           nvarchar(255) NOT NULL   ,
	user_icq             nvarchar(255) NOT NULL   ,
	user_website         nvarchar(max) NOT NULL   ,
	user_occ             nvarchar(255) NOT NULL   ,
	user_interests       nvarchar(max) NOT NULL   ,
	user_actkey          nvarchar(32) NOT NULL   ,
	user_newpasswd       nvarchar(40) NOT NULL   ,
	user_form_salt       nvarchar(32) NOT NULL   ,
	CONSTRAINT Pk_dem_users PRIMARY KEY ( user_id )
 );

CREATE INDEX idx_dem_users ON DEM_Project.dem_users ( group_id );

CREATE INDEX idx_dem_users_0 ON DEM_Project.dem_users ( user_rank );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о зарегистрированных пользователях (включая запись Гостя-Anonymous и Ботов)  (PRIMARY user_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип пользователя (основатель, бот и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'основная группа , связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата регистрации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_regdate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя в нижнем регисте и без спец символов' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username_clean';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сложный, комбинированый хэш пароля (выяснить как формируется или придумать свой)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего изменния пароля (user_passchg)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password_change_date';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'email пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'хэш email`а пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email_hash';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'день рождения пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_birthday';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пол пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_gender';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний визит на форум (возможно последняя активность)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastvisit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз отмечено "все темы прочитанным"' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastmark';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз оставил сообщение (время) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpost_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последняя просмотренная страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpage';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил предупреждений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_warnings';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последнее предупреждение (время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_last_warning';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'неудачных попыток залогинится' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_login_attempts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина неактивности (не подтверждён Емейл/бан и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время неактивности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тем создано' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сообщений оставлено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'язык выбран' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lang';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таймзона' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_timezone';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'формат даты и времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_dateformat';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ранг пользователя, связь с dem_ranks.rank_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rank';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет пользователя (наследуется у группы)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя о новостях сайта и т.п.?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя системой личных сообщений?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ссылка на аватар пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_avatar';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'подпись пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте подписи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig_bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'откуда пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_from';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Steam     ( user_jabber)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_steam';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Skype' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_skype';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер в icq' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_icq';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сайт пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_website';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'род деятельности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_occ';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'интересы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_interests';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ подтверждения EMail`а' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_actkey';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автосгенерированый пароль при смене пароля (вероятно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_newpasswd';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'(какой-то хеш)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_form_salt';

CREATE TABLE DEM_Project.dem_words ( 
	word_id              int NOT NULL   IDENTITY,
	word                 nvarchar(255) NOT NULL   ,
	replacement          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_words PRIMARY KEY ( word_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о запрещённых словах (автоцензор)   (PRIMARY word_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) замены' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'запрещенное слово' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'замена для запрещенного слова' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'replacement';

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	ban_give_reason      nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

CREATE INDEX idx_dem_banlist ON DEM_Project.dem_banlist ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_give_reason';

CREATE TABLE DEM_Project.dem_bots ( 
	bot_id               int NOT NULL   IDENTITY,
	bot_active           bit NOT NULL   ,
	bot_name             nvarchar(255) NOT NULL   ,
	user_id              int NOT NULL   ,
	bot_agent            nvarchar(255) NOT NULL   ,
	bot_ip               nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_bots PRIMARY KEY ( bot_id )
 );

CREATE INDEX idx_dem_bots ON DEM_Project.dem_bots ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список Ботов \ Поисковиков  (PRIMARY 	bot_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) бота\поисковика ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор активированности - разрешить или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_active';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_agent';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение IP-адреса бота\поисковика' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_ip';

CREATE TABLE DEM_Project.dem_medals ( 
	medal_id             int NOT NULL   IDENTITY,
	medal_name           nvarchar(255) NOT NULL   ,
	medal_description    nvarchar(255) NOT NULL   ,
	medal_image          nvarchar(max) NOT NULL   ,
	medals_cat_id        int NOT NULL   ,
	medal_nominated      bit NOT NULL   ,
	medal_order_id       int NOT NULL   ,
	CONSTRAINT Pk_dem_medals PRIMARY KEY ( medal_id )
 );

CREATE INDEX idx_dem_medals ON DEM_Project.dem_medals ( medals_cat_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень медалей   (PRIMARY 	medal_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание медали' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя изображения медали (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_image';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id категории медали связь с dem_medals_cats.medals_cat_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'могут ли пользователи номинировать' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_order_id';

CREATE TABLE DEM_Project.dem_medals_awarded ( 
	awarded_id           int NOT NULL   IDENTITY,
	medal_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	awarder_id           int NOT NULL   ,
	awarded_time         smalldatetime NOT NULL   ,
	awarded_nominated    bit NOT NULL   ,
	awarded_nominated_reason nvarchar(max) NOT NULL   ,
	awarder_username     nvarchar(255) NOT NULL   ,
	awarder_color        nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_medals_awarded PRIMARY KEY ( awarded_id )
 );

CREATE INDEX idx_dem_medals_awarded ON DEM_Project.dem_medals_awarded ( medal_id );

CREATE INDEX idx_dem_medals_awarded_0 ON DEM_Project.dem_medals_awarded ( user_id );

CREATE INDEX idx_dem_medals_awarded_1 ON DEM_Project.dem_medals_awarded ( awarder_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень награжденных медалями   (PRIMARY 	awarded_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) номинации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id медали связь с dem_medals.medal_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, которому вручили награду связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя вручившего награду  связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время вручения награды (события)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номинирован (в номинации или подтверждена? 1 или 0 )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина выдачи награды' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_color';

CREATE TABLE DEM_Project.dem_sessions_keys ( 
	key_id               nchar(32) NOT NULL   ,
	user_id              int NOT NULL   ,
	last_ip              nvarchar(100) NOT NULL   ,
	last_login           smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_sessions_keys PRIMARY KEY ( key_id, user_id )
 );

CREATE INDEX idx_dem_sessions_keys ON DEM_Project.dem_sessions_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись автоматического входа пользователей (автологин) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'key_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего входа ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_login';

CREATE TABLE DEM_Project.dem_user_confirm_keys ( 
	confirm_key          nvarchar(10) NOT NULL   ,
	user_id              int NOT NULL   ,
	confirm_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_user_confirm_keys PRIMARY KEY ( confirm_key )
 );

CREATE INDEX idx_dem_user_confirm_keys ON DEM_Project.dem_user_confirm_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключи подтверждения действий (PRIMARY confirm_key)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный случайно сгенерированный ключ для подтверждения операции (к примеру удаление)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_key';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ валиден до' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_time';

CREATE TABLE DEM_Project.dem_extension_groups_allowed_forums ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	CONSTRAINT PK PRIMARY KEY ( group_id, forum_id )
 );

CREATE INDEX idx_dem_extension_groups_allowed_forums ON DEM_Project.dem_extension_groups_allowed_forums ( forum_id );

CREATE INDEX idx_dem_extension_groups_allowed_forums_0 ON DEM_Project.dem_extension_groups_allowed_forums ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень идентификаторов (ID) форумов, в которых разрешена данная группа расширений файлов-вложений  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

CREATE TABLE DEM_Project.dem_forums ( 
	forum_id             int NOT NULL   IDENTITY,
	parent_id            int NOT NULL   ,
	forum_name           nvarchar(255) NOT NULL   ,
	forum_desc           nvarchar(max) NOT NULL   ,
	forum_password       nvarchar(50) NOT NULL   ,
	forum_pm             bit NOT NULL   ,
	forum_status         bit NOT NULL   ,
	display_subforum_list bit NOT NULL   ,
	display_on_index     bit NOT NULL   ,
	enable_indexing      bit NOT NULL   ,
	forum_posts          int NOT NULL   ,
	forum_topics         int NOT NULL   ,
	forum_last_post_id   int NOT NULL   ,
	forum_last_poster_id int NOT NULL   ,
	forum_last_post_subject nvarchar(255) NOT NULL   ,
	forum_last_post_time smalldatetime NOT NULL   ,
	forum_last_poster_name nvarchar(255) NOT NULL   ,
	forum_last_poster_colour nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_forums PRIMARY KEY ( forum_id )
 );

CREATE INDEX idx_dem_forums ON DEM_Project.dem_forums ( parent_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Форумы (Наименование, Описание, Правила ...) (PRIMARY 	forum_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума-родителя (если 0 - нет родителя) связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'parent_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Описание форума ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пароль доступа к форуму (если есть)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип форума (0-форум, 1-форум личных сообщений(не участвует в подсчёте сообщений))' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'статус форума (1 - закрыт, 0 - открыт)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_status';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа списка подфорумов данного форума (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_subforum_list';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа данного форума в списке подфорумов родительского форума (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_on_index';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак участвует ли форум в поисковой индексации (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'enable_indexing';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число сообщений в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число тем в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) последнего сообщения в форуме связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'заголовок последнего сообщения в форуме  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время размещения последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'установленный цвет имени автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_colour';

CREATE TABLE DEM_Project.dem_forums_access_groups ( 
	forum_id             int NOT NULL   ,
	group_id             int NOT NULL   ,
	CONSTRAINT Pk_dem_forums_access_groups PRIMARY KEY ( forum_id, group_id )
 );

CREATE INDEX idx_dem_forums_access_groups_0 ON DEM_Project.dem_forums_access_groups ( forum_id );

CREATE INDEX idx_dem_forums_access_groups ON DEM_Project.dem_forums_access_groups ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'group_id';

CREATE TABLE DEM_Project.dem_forums_access_users ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	CONSTRAINT Pk_dem_forums_access PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_forums_access_users ON DEM_Project.dem_forums_access_users ( forum_id );

CREATE INDEX idx_dem_forums_access_users_0 ON DEM_Project.dem_forums_access_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'user_id';

CREATE TABLE DEM_Project.dem_log ( 
	log_id               int NOT NULL   IDENTITY,
	log_type             tinyint NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	reportee_id          int NOT NULL   ,
	log_ip               nvarchar(100) NOT NULL   ,
	log_time             smalldatetime NOT NULL   ,
	log_operation        nvarchar(255) NOT NULL   ,
	log_data             nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_log PRIMARY KEY ( log_id )
 );

CREATE INDEX idx_dem_log ON DEM_Project.dem_log ( forum_id );

CREATE INDEX idx_dem_log_0 ON DEM_Project.dem_log ( topic_id );

CREATE INDEX idx_dem_log_1 ON DEM_Project.dem_log ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'журналы наблюдений (логи) администраторов\модераторов\ошибок   (PRIMARY 	log_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип действия, вызвавшего запись (0 - администрирование, 1 - модерирование, 2 - ошибки, 3 - изменения профиля пользователя) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор действия, вызвавшего запись, связь с dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'форум, в котором совершено записанное действие связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема, в которой совершено записанное действие связь с dem_topics.topic_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) объекта действия, вызвавшего запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'reportee_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'IP - адрес, с которого совершено действие, вызвавшее запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время записи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кртакое описание действия, вызвавшего запись (через определённые константы) 


--LOG_WARNING_DELETED
--LOG_USER_WARNING_BODY
--LOG_USER_WARNING
--и т.д.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_operation';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_data';

CREATE TABLE DEM_Project.dem_permissions_groups ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       bit NOT NULL   
 );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( group_id );

CREATE INDEX idx_dem_permissions_groups_0 ON DEM_Project.dem_permissions_groups ( forum_id );

CREATE INDEX idx_dem_permissions_groups_1 ON DEM_Project.dem_permissions_groups ( rule_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для групп  (PRIMARY -----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' id группы, к которой относится правило, связь dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_permissions_users ( 
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       int NOT NULL   
 );

CREATE INDEX idx_dem_permissions_users ON DEM_Project.dem_permissions_users ( rule_id );

CREATE INDEX idx_dem_permissions_users_1 ON DEM_Project.dem_permissions_users ( forum_id );

CREATE INDEX idx_dem_permissions_users_0 ON DEM_Project.dem_permissions_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для пользователей  (PRIMARY ----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, к которому относится правило, связь dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id группы, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_poll_options ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poll_option_text     nvarchar(255) NOT NULL   ,
	poll_option_total    int NOT NULL   ,
	CONSTRAINT Pk_dem_poll_options PRIMARY KEY ( poll_option_text ),
	CONSTRAINT Pk_dem_poll_options_0 UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_options ON DEM_Project.dem_poll_options ( topic_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись вариантов ответов для созданных тем-опросов   (PRIMARY poll_option_text )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса  с связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст варианта ответа опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Число проголосовавших за вариант ответа' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_total';

CREATE TABLE DEM_Project.dem_poll_votes ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	vote_user_id         int NOT NULL   ,
	vote_user_ip         nvarchar(100) NOT NULL   ,
	CONSTRAINT Idx_dem_poll_votes_1 UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_votes ON DEM_Project.dem_poll_votes ( topic_id );

CREATE INDEX idx_dem_poll_votes_0 ON DEM_Project.dem_poll_votes ( vote_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись результатов голосования пользователей   (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе связь c dem_poll_options.poll_option_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер IP проголосовавшего пользователя ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_ip';

CREATE TABLE DEM_Project.dem_post_rates ( 
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	rate                 smallint NOT NULL   ,
	rate_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_post_rates PRIMARY KEY ( post_id, user_id )
 );

CREATE INDEX idx_dem_post_rates_0 ON DEM_Project.dem_post_rates ( post_id );

CREATE INDEX idx_dem_post_rates_1 ON DEM_Project.dem_post_rates ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таблица отданых голосов (PRIMARY 	post_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оценка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время выставления оценки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate_time';

CREATE TABLE DEM_Project.dem_posts ( 
	post_id              int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poster_id            int NOT NULL   ,
	poster_ip            nvarchar(100) NOT NULL   ,
	post_time            smalldatetime NOT NULL   ,
	post_merged          smalldatetime NOT NULL   ,
	post_reported        bit NOT NULL   ,
	enable_bbcode        bit NOT NULL   ,
	enable_smilies       bit NOT NULL   ,
	enable_magic_url     bit NOT NULL   ,
	enable_sig           bit NOT NULL   ,
	post_subject         nvarchar(255) NOT NULL   ,
	post_text            ntext NOT NULL   ,
	post_attachment      bit NOT NULL   ,
	bbcode_uid           nvarchar(8) NOT NULL   ,
	post_edit_time       smalldatetime NOT NULL   ,
	post_edit_reason     nvarchar(255) NOT NULL   ,
	post_rating_positive int NOT NULL   ,
	post_rating_negative int NOT NULL   ,
	post_edit_user       int NOT NULL   ,
	post_edit_count      int NOT NULL   ,
	post_edit_locked     bit NOT NULL   ,
	CONSTRAINT Pk_dem_posts PRIMARY KEY ( post_id )
 );

CREATE INDEX idx_dem_posts ON DEM_Project.dem_posts ( forum_id );

CREATE INDEX idx_dem_posts_0 ON DEM_Project.dem_posts ( topic_id );

CREATE INDEX idx_dem_posts_1 ON DEM_Project.dem_posts ( poster_id );

CREATE INDEX idx_dem_posts_2 ON DEM_Project.dem_posts ( post_edit_user );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Содержание всех сообщений    (PRIMARY 	post_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы  связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя оставившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя оставившего сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки сообщения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время объединения сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_merged';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'на сообщение есть жалоба' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли bbcode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_bbcode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли смайлы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_smilies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'обрабатывать URL (превращать в ссылку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_magic_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ставить ли подпись' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема сообщения (заголовок)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имеет ли сообщение вложения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_attachment';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте сообщения (удалить после конвертации БД)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'положительный рейтинг сообщения (кол-во +) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отрицательный рейтинг сообщения (кол-во -)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя изменившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_user';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'количество изменений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_count';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изменение запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_locked';

CREATE TABLE DEM_Project.dem_reports ( 
	report_id            int NOT NULL   IDENTITY,
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	reason_id            int NOT NULL   ,
	report_closed        bit NOT NULL   ,
	report_time          smalldatetime NOT NULL   ,
	report_text          nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_reports PRIMARY KEY ( report_id )
 );

CREATE INDEX idx_dem_reports ON DEM_Project.dem_reports ( post_id );

CREATE INDEX idx_dem_reports_0 ON DEM_Project.dem_reports ( reason_id );

CREATE INDEX idx_dem_reports_1 ON DEM_Project.dem_reports ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о жалобах на сообщения    (PRIMARY report_id   )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Сообщение, на которое пожаловались, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользователь, создавший жалобу, связь c dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Причина создания жалобы, связь с dem_reports_reasons.reason_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'жалоба закрыта' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_closed';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_text';

CREATE TABLE DEM_Project.dem_sessions ( 
	session_id           nchar(32) NOT NULL   ,
	session_user_id      int NOT NULL   ,
	session_forum_id     int NOT NULL   ,
	session_last_visit   smalldatetime NOT NULL   ,
	session_start        smalldatetime NOT NULL   ,
	session_time         smalldatetime NOT NULL   ,
	session_ip           nvarchar(100) NOT NULL   ,
	session_browser      nvarchar(255) NOT NULL   ,
	session_page         nvarchar(255) NOT NULL   ,
	session_viewonline   bit NOT NULL   ,
	session_autologin    bit NOT NULL   ,
	session_admin        bit NOT NULL   ,
	CONSTRAINT Pk_dem_sessions PRIMARY KEY ( session_id )
 );

CREATE INDEX idx_dem_sessions ON DEM_Project.dem_sessions ( session_forum_id );

CREATE INDEX idx_dem_sessions_0 ON DEM_Project.dem_sessions ( session_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Таблица сессий идентификации пользователей, просматривающих конференцию ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего визита' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_last_visit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата создания сессии' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последней активности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просматриваемая страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_page';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображать вход пользователя (в счетчике/профиле)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_viewonline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автоматический вход ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_autologin';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли администратором (вход в админку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_admin';

CREATE TABLE DEM_Project.dem_topics ( 
	topic_id             int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_reported       bit NOT NULL   ,
	topic_title          nvarchar(255) NOT NULL   ,
	topic_poster         int NOT NULL   ,
	topic_time           smalldatetime NOT NULL   ,
	topic_time_limit     smalldatetime NOT NULL   ,
	topic_views          int NOT NULL   ,
	topic_replies        int NOT NULL   ,
	topic_private_type   bit NOT NULL   ,
	topic_first_post_id  int NOT NULL   ,
	topic_first_poster_name nvarchar(255) NOT NULL   ,
	topic_first_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_id   int NOT NULL   ,
	topic_last_poster_id int NOT NULL   ,
	topic_last_poster_name nvarchar(255) NOT NULL   ,
	topic_last_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_subject nvarchar(255) NOT NULL   ,
	topic_last_post_time smalldatetime NOT NULL   ,
	topic_last_view_time smalldatetime NOT NULL   ,
	poll_title           nvarchar(255) NOT NULL   ,
	poll_start           smalldatetime NOT NULL   ,
	poll_length          smalldatetime NOT NULL   ,
	poll_max_options     tinyint NOT NULL   ,
	poll_last_vote       smalldatetime NOT NULL   ,
	poll_vote_change     bit NOT NULL   ,
	topic_first_post_show bit NOT NULL   ,
	CONSTRAINT Pk_dem_topics PRIMARY KEY ( topic_id )
 );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( forum_id );

CREATE INDEX idx_dem_topics_2 ON DEM_Project.dem_topics ( topic_first_post_id );

CREATE INDEX idx_dem_topics_3 ON DEM_Project.dem_topics ( topic_last_post_id );

CREATE INDEX idx_dem_topics_0 ON DEM_Project.dem_topics ( topic_poster );

CREATE INDEX idx_dem_topics_1 ON DEM_Project.dem_topics ( topic_last_poster_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о созданных темах на конференции  (PRIMARY topic_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'в теме есть сообщение, на которое пожаловались' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'название темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор темы, связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_poster';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема открыта до указанного времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time_limit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просмотров темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_views';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ответов в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_replies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип темы - приватная или нет (0-не приватный, 1-приватный) (замена ЛС)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_private_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id первого сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id последнего сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тему посмотрели последний раз (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_view_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время начала опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'продолжительность опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_length';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сколько ответов может дать 1 пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_max_options';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз проголосовано (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_last_vote';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'разрешено изменять голос' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_vote_change';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'закрепить первое сообщени на всех страницах' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_show';

CREATE TABLE DEM_Project.dem_topics_posted ( 
	user_id              int NOT NULL   ,
	topic_id             int NOT NULL   ,
	topic_posted         int NOT NULL   ,
	CONSTRAINT Idx_dem_topics_posted PRIMARY KEY ( user_id, topic_id )
 );

CREATE INDEX idx_dem_topics_posted_0 ON DEM_Project.dem_topics_posted ( topic_id );

CREATE INDEX idx_dem_topics_posted_1 ON DEM_Project.dem_topics_posted ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'есть сообщение в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_posted';

CREATE TABLE DEM_Project.dem_topics_watch ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	notify_status        bit NOT NULL   
 );

CREATE INDEX idx_dem_topics_watch ON DEM_Project.dem_topics_watch ( topic_id );

CREATE INDEX idx_dem_topics_watch_0 ON DEM_Project.dem_topics_watch ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о подписанных темах    (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уведомлять или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'notify_status';

CREATE TABLE DEM_Project.dem_track_forums ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_track_forums PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_track_forums ON DEM_Project.dem_track_forums ( forum_id );

CREATE INDEX idx_dem_track_forums_0 ON DEM_Project.dem_track_forums ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о появления новых (не прочитанных)для пользователя сообщений в форумах  (PRIMARY 	user_id + forum_id )



--В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь c dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о прочтении  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_track_topics ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_track_topics PRIMARY KEY ( topic_id, user_id )
 );

CREATE INDEX idx_dem_track_topics ON DEM_Project.dem_track_topics ( topic_id );

CREATE INDEX idx_dem_track_topics_0 ON DEM_Project.dem_track_topics ( forum_id );

CREATE INDEX idx_dem_track_topics_1 ON DEM_Project.dem_track_topics ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о наличии новых (не прочитанных)сообщений в темах   (PRIMARY user_id + topic_id  )


В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о непрочтении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_warnings ( 
	warning_id           int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	post_id              int NOT NULL   ,
	log_id               int NOT NULL   ,
	warning_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_warnings PRIMARY KEY ( warning_id )
 );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( post_id );

CREATE INDEX idx_dem_warnings_1 ON DEM_Project.dem_warnings ( log_id );

CREATE INDEX idx_dem_warnings_0 ON DEM_Project.dem_warnings ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о предупреждениях пользователям  (PRIMARY warning_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) предупреждения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id лог-записи связь с dem_log.log_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания срока действия предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_time';

ALTER TABLE DEM_Project.dem_banlist ADD CONSTRAINT fk_dem_banlist_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_bots ADD CONSTRAINT fk_dem_bots_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extension_groups_allowed_forums ADD CONSTRAINT fk_extension_groups_allowed_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extension_groups_allowed_forums ADD CONSTRAINT fk_extension_groups_allowed_forums_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_extension_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_extensions ADD CONSTRAINT fk_extensions_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_extension_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums ADD CONSTRAINT fk_forums_dem_forums_parent_id FOREIGN KEY ( parent_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_groups ADD CONSTRAINT fk_dem_forums_access_groups_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_groups ADD CONSTRAINT fk_dem_forums_access_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_users ADD CONSTRAINT fk_dem_forums_access_users_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_forums_access_users ADD CONSTRAINT fk_dem_forums_access_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_log ADD CONSTRAINT fk_dem_log_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals ADD CONSTRAINT fk_dem_medals_dem_medals_cats_cat_id FOREIGN KEY ( medals_cat_id ) REFERENCES DEM_Project.dem_medals_cats( medals_cat_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_medal_id FOREIGN KEY ( medal_id ) REFERENCES DEM_Project.dem_medals( medal_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_medals_awarded ADD CONSTRAINT fk_dem_medals_awarded_awarder_id FOREIGN KEY ( awarder_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_groups ADD CONSTRAINT fk_dem_permissions_groups_rule_id FOREIGN KEY ( rule_id ) REFERENCES DEM_Project.dem_permissions_rules( rule_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_rule_id FOREIGN KEY ( rule_id ) REFERENCES DEM_Project.dem_permissions_rules( rule_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_permissions_users ADD CONSTRAINT fk_dem_permissions_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_options ADD CONSTRAINT fk_dem_poll_options_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_poll_option_id FOREIGN KEY ( poll_option_id ) REFERENCES DEM_Project.dem_poll_options( poll_option_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_poll_votes ADD CONSTRAINT fk_dem_poll_votes_dem_users_user_id FOREIGN KEY ( vote_user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_post_rates ADD CONSTRAINT fk_dem_post_rates_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_post_rates ADD CONSTRAINT fk_dem_post_rates_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_users_user_id FOREIGN KEY ( poster_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_posts ADD CONSTRAINT fk_dem_posts_dem_users_post_edit_user FOREIGN KEY ( post_edit_user ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_reson_id FOREIGN KEY ( reason_id ) REFERENCES DEM_Project.dem_reports_reasons( reason_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_reports ADD CONSTRAINT fk_dem_reports_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions ADD CONSTRAINT fk_dem_sessions_dem_forums_forum_id FOREIGN KEY ( session_forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions ADD CONSTRAINT fk_dem_sessions_dem_users_user_id FOREIGN KEY ( session_user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_sessions_keys ADD CONSTRAINT fk_dem_sessions_keys_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_posts_first_post_id FOREIGN KEY ( topic_first_post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_posts_last_post_id FOREIGN KEY ( topic_last_post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_users_user_id FOREIGN KEY ( topic_poster ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics ADD CONSTRAINT fk_dem_topics_dem_users_last_poster_id FOREIGN KEY ( topic_last_poster_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_posted ADD CONSTRAINT fk_dem_topics_posted_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_posted ADD CONSTRAINT fk_dem_topics_posted_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_watch ADD CONSTRAINT fk_dem_topics_watch_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_topics_watch ADD CONSTRAINT fk_dem_topics_watch_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_forums ADD CONSTRAINT fk_dem_track_forums_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_forums ADD CONSTRAINT fk_dem_track_forums_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_topics_topic_id FOREIGN KEY ( topic_id ) REFERENCES DEM_Project.dem_topics( topic_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_forums_forum_id FOREIGN KEY ( forum_id ) REFERENCES DEM_Project.dem_forums( forum_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_track_topics ADD CONSTRAINT fk_dem_track_topics_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_user_confirm_keys ADD CONSTRAINT fk_dem_user_confirm_keys_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_users ADD CONSTRAINT fk_dem_users_dem_groups_group_id FOREIGN KEY ( group_id ) REFERENCES DEM_Project.dem_groups( group_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_users ADD CONSTRAINT fk_dem_users_dem_ranks_rank_id FOREIGN KEY ( user_rank ) REFERENCES DEM_Project.dem_ranks( rank_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_posts_post_id FOREIGN KEY ( post_id ) REFERENCES DEM_Project.dem_posts( post_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_log_log_id FOREIGN KEY ( log_id ) REFERENCES DEM_Project.dem_log( log_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE DEM_Project.dem_warnings ADD CONSTRAINT fk_dem_warnings_dem_users FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

]]></string>
		</script>
		<script name="Sql_011" id="SQL_11b64445" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_type             nvarchar(255) NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

CREATE INDEX idx_dem_banlist ON DEM_Project.dem_banlist ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

ALTER TABLE DEM_Project.dem_banlist ADD CONSTRAINT fk_dem_banlist_dem_users_user_id FOREIGN KEY ( user_id ) REFERENCES DEM_Project.dem_users( user_id ) ON DELETE NO ACTION ON UPDATE NO ACTION;

]]></string>
		</script>
		<script name="Sql_012" id="SQL_43c383" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_type             nvarchar(255) NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

CREATE INDEX idx_dem_banlist ON DEM_Project.dem_banlist ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            tinyint NOT NULL   IDENTITY,
	bbcode_tag           nvarchar(255) NOT NULL   ,
	bbcode_helpline      nvarchar(255) NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	bbcode_match         nvarchar(max) NOT NULL   ,
	bbcode_tpl           nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользовательские BBCode (PRIMARY 	bbcode_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя тэга  (к примеру: "center")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tag';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_helpline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор отображения в форме ответа\постинга?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'display_on_posting';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст определения BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_match';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'html-замена BBCode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tpl';

CREATE TABLE DEM_Project.dem_bots ( 
	bot_id               int NOT NULL   IDENTITY,
	bot_active           bit NOT NULL   ,
	bot_name             nvarchar(255) NOT NULL   ,
	user_id              int NOT NULL   ,
	bot_agent            nvarchar(255) NOT NULL   ,
	bot_ip               nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_bots PRIMARY KEY ( bot_id )
 );

CREATE INDEX idx_dem_bots ON DEM_Project.dem_bots ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список Ботов \ Поисковиков  (PRIMARY 	bot_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) бота\поисковика ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор активированности - разрешить или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_active';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_agent';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение IP-адреса бота\поисковика' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_ip';

CREATE TABLE DEM_Project.dem_config ( 
	config_name          nvarchar(255) NOT NULL   ,
	config_value         nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_config PRIMARY KEY ( config_name )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование параметра конфигурации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение параметра конфигурации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_value';

CREATE TABLE DEM_Project.dem_disallow_usernames ( 
	disallow_id          int NOT NULL   IDENTITY,
	disallow_username    nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_disallow_usernames PRIMARY KEY ( disallow_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённые имена (PRIMARY 	disallow_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) запрещения имени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённое имя (ник) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_username';

CREATE TABLE DEM_Project.dem_extension_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_name           nvarchar(255) NOT NULL   ,
	allow_group          bit NOT NULL   ,
	download_mode        bit NOT NULL   ,
	upload_icon          nvarchar(255) NOT NULL   ,
	max_filesize         int NOT NULL   ,
	CONSTRAINT Pk_dem_extension_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Группы расширений, соотнесённые с типами файлов (Images, Text ...)  (PRIMARY 	group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы расширений файлов-вложений 


--IMAGES
--ARCHIVES
--PLAIN_TEXT
--DOCUMENTS
--REAL_MEDIA
--WINDOWS_MEDIA
--FLASH_FILES
--QUICKTIME_MEDIA
--DOWNLOADABLE_FILES' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор разрешения группы расширений файлов-вложений (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'allow_group';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор доступности скачивания  (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'download_mode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'путь к файлу-картинке, используемой как иконка для файла-вложения данноой группы расширений ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'upload_icon';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'максимально разрешённый размер файла-вложения данной группы расширений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'max_filesize';

CREATE TABLE DEM_Project.dem_extension_groups_allowed_forums ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	CONSTRAINT PK PRIMARY KEY ( group_id, forum_id )
 );

CREATE INDEX idx_dem_extension_groups_allowed_forums ON DEM_Project.dem_extension_groups_allowed_forums ( forum_id );

CREATE INDEX idx_dem_extension_groups_allowed_forums_0 ON DEM_Project.dem_extension_groups_allowed_forums ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень идентификаторов (ID) форумов, в которых разрешена данная группа расширений файлов-вложений  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups_allowed_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

CREATE TABLE DEM_Project.dem_extensions ( 
	extension_id         int NOT NULL   IDENTITY,
	group_id             int NOT NULL   ,
	extension            nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_extensions PRIMARY KEY ( extension_id )
 );

CREATE INDEX idx_dem_extensions ON DEM_Project.dem_extensions ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Расширения файлов (.xxx), разрешённые для вложений (PRIMARY 	extension_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) типа расширения файла-вложения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) группы расширений файлов-вложений для данного типа расширения связь с dem_extension_groups.group_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип расширения файлов-вложений (jpg, rar. txt и т.д.)  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension';

CREATE TABLE DEM_Project.dem_forums ( 
	forum_id             int NOT NULL   IDENTITY,
	parent_id            int NOT NULL   ,
	forum_name           nvarchar(255) NOT NULL   ,
	forum_desc           nvarchar(max) NOT NULL   ,
	forum_password       nvarchar(50) NOT NULL   ,
	forum_pm             bit NOT NULL   ,
	forum_status         bit NOT NULL   ,
	display_subforum_list bit NOT NULL   ,
	display_on_index     bit NOT NULL   ,
	enable_indexing      bit NOT NULL   ,
	forum_posts          int NOT NULL   ,
	forum_topics         int NOT NULL   ,
	forum_last_post_id   int NOT NULL   ,
	forum_last_poster_id int NOT NULL   ,
	forum_last_post_subject nvarchar(255) NOT NULL   ,
	forum_last_post_time smalldatetime NOT NULL   ,
	forum_last_poster_name nvarchar(255) NOT NULL   ,
	forum_last_poster_colour nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_forums PRIMARY KEY ( forum_id )
 );

CREATE INDEX idx_dem_forums ON DEM_Project.dem_forums ( parent_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Форумы (Наименование, Описание, Правила ...) (PRIMARY 	forum_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума-родителя (если 0 - нет родителя) связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'parent_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Описание форума ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пароль доступа к форуму (если есть)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип форума (0-форум, 1-форум личных сообщений(не участвует в подсчёте сообщений))' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'статус форума (1 - закрыт, 0 - открыт)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_status';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа списка подфорумов данного форума (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_subforum_list';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа данного форума в списке подфорумов родительского форума (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_on_index';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак участвует ли форум в поисковой индексации (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'enable_indexing';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число сообщений в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число тем в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) последнего сообщения в форуме связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'заголовок последнего сообщения в форуме  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время размещения последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'установленный цвет имени автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_colour';

CREATE TABLE DEM_Project.dem_forums_access_groups ( 
	forum_id             int NOT NULL   ,
	group_id             int NOT NULL   ,
	CONSTRAINT Pk_dem_forums_access_groups PRIMARY KEY ( forum_id, group_id )
 );

CREATE INDEX idx_dem_forums_access_groups_0 ON DEM_Project.dem_forums_access_groups ( forum_id );

CREATE INDEX idx_dem_forums_access_groups ON DEM_Project.dem_forums_access_groups ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'group_id';

CREATE TABLE DEM_Project.dem_forums_access_users ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	CONSTRAINT Pk_dem_forums_access PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_forums_access_users ON DEM_Project.dem_forums_access_users ( forum_id );

CREATE INDEX idx_dem_forums_access_users_0 ON DEM_Project.dem_forums_access_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'user_id';

CREATE TABLE DEM_Project.dem_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_type           tinyint NOT NULL   ,
	group_name           nvarchar(255) NOT NULL   ,
	group_desc           nvarchar(max) NOT NULL   ,
	group_avatar_url     nvarchar(max) NOT NULL   ,
	group_colour         nvarchar(6) NOT NULL   ,
	group_legend         bit NOT NULL   ,
	CONSTRAINT Pk_dem_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Данные о группах (PRIMARY group_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип группы (4 - Открытая, 0 - По запросу, 1 - Закрытая, 2 - Скрытая, 3 - Предустановленная) - пересмотреть' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url файла аватара группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_avatar_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код цвета группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак отображения группы в легенде (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_legend';

CREATE TABLE DEM_Project.dem_lang ( 
	lang_id              int NOT NULL   IDENTITY,
	lang_iso             nvarchar(30) NOT NULL   ,
	lang_dir             nvarchar(30) NOT NULL   ,
	lang_english_name    nvarchar(255) NOT NULL   ,
	lang_local_name      nvarchar(255) NOT NULL   ,
	lang_author          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_lang PRIMARY KEY ( lang_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об установленных языковых пакетах  (PRIMARY 	lang_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'условное наименование языкового пакета (en - английский, ru - русский и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_iso';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование папки с языковым пакетом ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_dir';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на английском языке ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_english_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на языке оригинала ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_local_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_author';

CREATE TABLE DEM_Project.dem_log ( 
	log_id               int NOT NULL   IDENTITY,
	log_type             tinyint NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	reportee_id          int NOT NULL   ,
	log_ip               nvarchar(100) NOT NULL   ,
	log_time             smalldatetime NOT NULL   ,
	log_operation        nvarchar(255) NOT NULL   ,
	log_data             nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_log PRIMARY KEY ( log_id )
 );

CREATE INDEX idx_dem_log ON DEM_Project.dem_log ( forum_id );

CREATE INDEX idx_dem_log_0 ON DEM_Project.dem_log ( topic_id );

CREATE INDEX idx_dem_log_1 ON DEM_Project.dem_log ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'журналы наблюдений (логи) администраторов\модераторов\ошибок   (PRIMARY 	log_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип действия, вызвавшего запись (0 - администрирование, 1 - модерирование, 2 - ошибки, 3 - изменения профиля пользователя) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор действия, вызвавшего запись, связь с dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'форум, в котором совершено записанное действие связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема, в которой совершено записанное действие связь с dem_topics.topic_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) объекта действия, вызвавшего запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'reportee_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'IP - адрес, с которого совершено действие, вызвавшее запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время записи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кртакое описание действия, вызвавшего запись (через определённые константы) 


--LOG_WARNING_DELETED
--LOG_USER_WARNING_BODY
--LOG_USER_WARNING
--и т.д.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_operation';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_data';

CREATE TABLE DEM_Project.dem_medals ( 
	medal_id             int NOT NULL   IDENTITY,
	medal_name           nvarchar(255) NOT NULL   ,
	medal_description    nvarchar(255) NOT NULL   ,
	medal_image          nvarchar(max) NOT NULL   ,
	medals_cat_id        int NOT NULL   ,
	medal_nominated      bit NOT NULL   ,
	medal_order_id       int NOT NULL   ,
	CONSTRAINT Pk_dem_medals PRIMARY KEY ( medal_id )
 );

CREATE INDEX idx_dem_medals ON DEM_Project.dem_medals ( medals_cat_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень медалей   (PRIMARY 	medal_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание медали' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя изображения медали (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_image';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id категории медали связь с dem_medals_cats.medals_cat_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'могут ли пользователи номинировать' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_order_id';

CREATE TABLE DEM_Project.dem_medals_awarded ( 
	awarded_id           int NOT NULL   IDENTITY,
	medal_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	awarder_id           int NOT NULL   ,
	awarded_time         smalldatetime NOT NULL   ,
	awarded_nominated    bit NOT NULL   ,
	awarded_nominated_reason nvarchar(max) NOT NULL   ,
	awarder_username     nvarchar(255) NOT NULL   ,
	awarder_color        nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_medals_awarded PRIMARY KEY ( awarded_id )
 );

CREATE INDEX idx_dem_medals_awarded ON DEM_Project.dem_medals_awarded ( medal_id );

CREATE INDEX idx_dem_medals_awarded_0 ON DEM_Project.dem_medals_awarded ( user_id );

CREATE INDEX idx_dem_medals_awarded_1 ON DEM_Project.dem_medals_awarded ( awarder_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень награжденных медалями   (PRIMARY 	awarded_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) номинации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id медали связь с dem_medals.medal_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, которому вручили награду связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя вручившего награду  связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время вручения награды (события)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номинирован (в номинации или подтверждена? 1 или 0 )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина выдачи награды' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_color';

CREATE TABLE DEM_Project.dem_medals_cats ( 
	medals_cat_id        int NOT NULL   IDENTITY,
	medals_cat_name      nvarchar(255) NOT NULL   ,
	medals_cat_order_id  int NOT NULL   ,
	CONSTRAINT Pk_dem_medals_cats PRIMARY KEY ( medals_cat_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень категорий медалей   (PRIMARY 	medals_cat_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_order_id';

CREATE TABLE DEM_Project.dem_permissions_groups ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       bit NOT NULL   
 );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( group_id );

CREATE INDEX idx_dem_permissions_groups_0 ON DEM_Project.dem_permissions_groups ( forum_id );

CREATE INDEX idx_dem_permissions_groups_1 ON DEM_Project.dem_permissions_groups ( rule_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для групп  (PRIMARY -----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' id группы, к которой относится правило, связь dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_permissions_rules ( 
	rule_id              int NOT NULL   IDENTITY,
	rule_name            nvarchar(255) NOT NULL   ,
	is_global            bit NOT NULL   ,
	is_local             bit NOT NULL   ,
	founder_only         bit NOT NULL   ,
	CONSTRAINT Pk_dem_permissions_rule PRIMARY KEY ( rule_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные)  (PRIMARY rule_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило глобальное (применяется сразу ко всем форумам)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_global';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило локальное (применяется к выбраному форуму)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_local';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило только для основателя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'founder_only';

CREATE TABLE DEM_Project.dem_permissions_users ( 
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       int NOT NULL   
 );

CREATE INDEX idx_dem_permissions_users ON DEM_Project.dem_permissions_users ( rule_id );

CREATE INDEX idx_dem_permissions_users_1 ON DEM_Project.dem_permissions_users ( forum_id );

CREATE INDEX idx_dem_permissions_users_0 ON DEM_Project.dem_permissions_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для пользователей  (PRIMARY ----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, к которому относится правило, связь dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id группы, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_poll_options ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poll_option_text     nvarchar(255) NOT NULL   ,
	poll_option_total    int NOT NULL   ,
	CONSTRAINT Pk_dem_poll_options PRIMARY KEY ( poll_option_text ),
	CONSTRAINT Pk_dem_poll_options_0 UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_options ON DEM_Project.dem_poll_options ( topic_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись вариантов ответов для созданных тем-опросов   (PRIMARY poll_option_text )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса  с связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст варианта ответа опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Число проголосовавших за вариант ответа' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_total';

CREATE TABLE DEM_Project.dem_poll_votes ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	vote_user_id         int NOT NULL   ,
	vote_user_ip         nvarchar(100) NOT NULL   ,
	CONSTRAINT Idx_dem_poll_votes_1 UNIQUE ( poll_option_id ) 
 );

CREATE INDEX idx_dem_poll_votes ON DEM_Project.dem_poll_votes ( topic_id );

CREATE INDEX idx_dem_poll_votes_0 ON DEM_Project.dem_poll_votes ( vote_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись результатов голосования пользователей   (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе связь c dem_poll_options.poll_option_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер IP проголосовавшего пользователя ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_ip';

CREATE TABLE DEM_Project.dem_post_rates ( 
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	rate                 smallint NOT NULL   ,
	rate_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_post_rates PRIMARY KEY ( post_id, user_id )
 );

CREATE INDEX idx_dem_post_rates_0 ON DEM_Project.dem_post_rates ( post_id );

CREATE INDEX idx_dem_post_rates_1 ON DEM_Project.dem_post_rates ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таблица отданых голосов (PRIMARY 	post_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оценка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время выставления оценки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate_time';

CREATE TABLE DEM_Project.dem_posts ( 
	post_id              int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poster_id            int NOT NULL   ,
	poster_ip            nvarchar(100) NOT NULL   ,
	post_time            smalldatetime NOT NULL   ,
	post_merged          smalldatetime NOT NULL   ,
	post_reported        bit NOT NULL   ,
	enable_bbcode        bit NOT NULL   ,
	enable_smilies       bit NOT NULL   ,
	enable_magic_url     bit NOT NULL   ,
	enable_sig           bit NOT NULL   ,
	post_subject         nvarchar(255) NOT NULL   ,
	post_text            ntext NOT NULL   ,
	post_attachment      bit NOT NULL   ,
	bbcode_uid           nvarchar(8) NOT NULL   ,
	post_edit_time       smalldatetime NOT NULL   ,
	post_edit_reason     nvarchar(255) NOT NULL   ,
	post_rating_positive int NOT NULL   ,
	post_rating_negative int NOT NULL   ,
	post_edit_user       int NOT NULL   ,
	post_edit_count      int NOT NULL   ,
	post_edit_locked     bit NOT NULL   ,
	CONSTRAINT Pk_dem_posts PRIMARY KEY ( post_id )
 );

CREATE INDEX idx_dem_posts ON DEM_Project.dem_posts ( forum_id );

CREATE INDEX idx_dem_posts_0 ON DEM_Project.dem_posts ( topic_id );

CREATE INDEX idx_dem_posts_1 ON DEM_Project.dem_posts ( poster_id );

CREATE INDEX idx_dem_posts_2 ON DEM_Project.dem_posts ( post_edit_user );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Содержание всех сообщений    (PRIMARY 	post_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы  связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя оставившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя оставившего сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки сообщения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время объединения сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_merged';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'на сообщение есть жалоба' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли bbcode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_bbcode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли смайлы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_smilies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'обрабатывать URL (превращать в ссылку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_magic_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ставить ли подпись' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема сообщения (заголовок)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имеет ли сообщение вложения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_attachment';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте сообщения (удалить после конвертации БД)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'положительный рейтинг сообщения (кол-во +) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отрицательный рейтинг сообщения (кол-во -)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя изменившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_user';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'количество изменений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_count';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изменение запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_locked';

CREATE TABLE DEM_Project.dem_ranks ( 
	rank_id              int NOT NULL   IDENTITY,
	rank_title           nvarchar(255) NOT NULL   ,
	rank_min             int NOT NULL   ,
	rank_special         bit NOT NULL   ,
	rank_image_url       nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_ranks PRIMARY KEY ( rank_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список определённых на конференции званий   (PRIMARY 	rank_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображаемое имя ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'необходимое количество сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_min';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли специальным ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_special';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изображение (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_image_url';

CREATE TABLE DEM_Project.dem_reports ( 
	report_id            int NOT NULL   IDENTITY,
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	reason_id            int NOT NULL   ,
	report_closed        bit NOT NULL   ,
	report_time          smalldatetime NOT NULL   ,
	report_text          nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_reports PRIMARY KEY ( report_id )
 );

CREATE INDEX idx_dem_reports ON DEM_Project.dem_reports ( post_id );

CREATE INDEX idx_dem_reports_0 ON DEM_Project.dem_reports ( reason_id );

CREATE INDEX idx_dem_reports_1 ON DEM_Project.dem_reports ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о жалобах на сообщения    (PRIMARY report_id   )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Сообщение, на которое пожаловались, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользователь, создавший жалобу, связь c dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Причина создания жалобы, связь с dem_reports_reasons.reason_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'жалоба закрыта' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_closed';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_text';

CREATE TABLE DEM_Project.dem_reports_reasons ( 
	reason_id            int NOT NULL   IDENTITY,
	reason_title         nvarchar(255) NOT NULL   ,
	reason_description   nvarchar(max) NOT NULL   ,
	reason_order         tinyint    ,
	CONSTRAINT Pk_dem_reports_reasons PRIMARY KEY ( reason_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об определённых на конференции причинах для жалоб    (PRIMARY reason_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) причины для жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_order';

CREATE TABLE DEM_Project.dem_sessions ( 
	session_id           nchar(32) NOT NULL   ,
	session_user_id      int NOT NULL   ,
	session_forum_id     int NOT NULL   ,
	session_last_visit   smalldatetime NOT NULL   ,
	session_start        smalldatetime NOT NULL   ,
	session_time         smalldatetime NOT NULL   ,
	session_ip           nvarchar(100) NOT NULL   ,
	session_browser      nvarchar(255) NOT NULL   ,
	session_page         nvarchar(255) NOT NULL   ,
	session_viewonline   bit NOT NULL   ,
	session_autologin    bit NOT NULL   ,
	session_admin        bit NOT NULL   ,
	CONSTRAINT Pk_dem_sessions PRIMARY KEY ( session_id )
 );

CREATE INDEX idx_dem_sessions ON DEM_Project.dem_sessions ( session_forum_id );

CREATE INDEX idx_dem_sessions_0 ON DEM_Project.dem_sessions ( session_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Таблица сессий идентификации пользователей, просматривающих конференцию ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего визита' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_last_visit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата создания сессии' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последней активности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просматриваемая страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_page';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображать вход пользователя (в счетчике/профиле)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_viewonline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автоматический вход ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_autologin';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли администратором (вход в админку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_admin';

CREATE TABLE DEM_Project.dem_sessions_keys ( 
	key_id               nchar(32) NOT NULL   ,
	user_id              int NOT NULL   ,
	last_ip              nvarchar(100) NOT NULL   ,
	last_login           smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_sessions_keys PRIMARY KEY ( key_id, user_id )
 );

CREATE INDEX idx_dem_sessions_keys ON DEM_Project.dem_sessions_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись автоматического входа пользователей (автологин) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'key_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего входа ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_login';

CREATE TABLE DEM_Project.dem_smilies ( 
	smiley_id            int NOT NULL   IDENTITY,
	code                 nvarchar(50) NOT NULL   ,
	emotion              nvarchar(50) NOT NULL   ,
	smiley_url           nvarchar(255) NOT NULL   ,
	smiley_width         tinyint NOT NULL   ,
	smiley_height        tinyint NOT NULL   ,
	smiley_order         int NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	CONSTRAINT Pk_dem_smilies PRIMARY KEY ( smiley_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список установленных смайлов  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код вызова в сообщении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'code';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'выражаемая эмоция' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'emotion';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ширина' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_width';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'высота' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_height';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'порядок сортировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_order';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'показывать в окне отправки сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'display_on_posting';

CREATE TABLE DEM_Project.dem_topics ( 
	topic_id             int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_reported       bit NOT NULL   ,
	topic_title          nvarchar(255) NOT NULL   ,
	topic_poster         int NOT NULL   ,
	topic_time           smalldatetime NOT NULL   ,
	topic_time_limit     smalldatetime NOT NULL   ,
	topic_views          int NOT NULL   ,
	topic_replies        int NOT NULL   ,
	topic_private_type   bit NOT NULL   ,
	topic_first_post_id  int NOT NULL   ,
	topic_first_poster_name nvarchar(255) NOT NULL   ,
	topic_first_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_id   int NOT NULL   ,
	topic_last_poster_id int NOT NULL   ,
	topic_last_poster_name nvarchar(255) NOT NULL   ,
	topic_last_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_subject nvarchar(255) NOT NULL   ,
	topic_last_post_time smalldatetime NOT NULL   ,
	topic_last_view_time smalldatetime NOT NULL   ,
	poll_title           nvarchar(255) NOT NULL   ,
	poll_start           smalldatetime NOT NULL   ,
	poll_length          smalldatetime NOT NULL   ,
	poll_max_options     tinyint NOT NULL   ,
	poll_last_vote       smalldatetime NOT NULL   ,
	poll_vote_change     bit NOT NULL   ,
	topic_first_post_show bit NOT NULL   ,
	CONSTRAINT Pk_dem_topics PRIMARY KEY ( topic_id )
 );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( forum_id );

CREATE INDEX idx_dem_topics_2 ON DEM_Project.dem_topics ( topic_first_post_id );

CREATE INDEX idx_dem_topics_3 ON DEM_Project.dem_topics ( topic_last_post_id );

CREATE INDEX idx_dem_topics_0 ON DEM_Project.dem_topics ( topic_poster );

CREATE INDEX idx_dem_topics_1 ON DEM_Project.dem_topics ( topic_last_poster_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о созданных темах на конференции  (PRIMARY topic_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'в теме есть сообщение, на которое пожаловались' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'название темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор темы, связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_poster';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема открыта до указанного времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time_limit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просмотров темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_views';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ответов в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_replies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип темы - приватная или нет (0-не приватный, 1-приватный) (замена ЛС)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_private_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id первого сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id последнего сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тему посмотрели последний раз (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_view_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время начала опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'продолжительность опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_length';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сколько ответов может дать 1 пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_max_options';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз проголосовано (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_last_vote';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'разрешено изменять голос' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_vote_change';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'закрепить первое сообщени на всех страницах' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_show';

CREATE TABLE DEM_Project.dem_topics_posted ( 
	user_id              int NOT NULL   ,
	topic_id             int NOT NULL   ,
	topic_posted         int NOT NULL   ,
	CONSTRAINT Idx_dem_topics_posted PRIMARY KEY ( user_id, topic_id )
 );

CREATE INDEX idx_dem_topics_posted_0 ON DEM_Project.dem_topics_posted ( topic_id );

CREATE INDEX idx_dem_topics_posted_1 ON DEM_Project.dem_topics_posted ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'есть сообщение в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_posted', @level2type=N'COLUMN',@level2name=N'topic_posted';

CREATE TABLE DEM_Project.dem_topics_watch ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	notify_status        bit NOT NULL   
 );

CREATE INDEX idx_dem_topics_watch ON DEM_Project.dem_topics_watch ( topic_id );

CREATE INDEX idx_dem_topics_watch_0 ON DEM_Project.dem_topics_watch ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о подписанных темах    (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уведомлять или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'notify_status';

CREATE TABLE DEM_Project.dem_track_forums ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_track_forums PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_track_forums ON DEM_Project.dem_track_forums ( forum_id );

CREATE INDEX idx_dem_track_forums_0 ON DEM_Project.dem_track_forums ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о появления новых (не прочитанных)для пользователя сообщений в форумах  (PRIMARY 	user_id + forum_id )



--В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь c dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о прочтении  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_track_topics ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_track_topics PRIMARY KEY ( topic_id, user_id )
 );

CREATE INDEX idx_dem_track_topics ON DEM_Project.dem_track_topics ( topic_id );

CREATE INDEX idx_dem_track_topics_0 ON DEM_Project.dem_track_topics ( forum_id );

CREATE INDEX idx_dem_track_topics_1 ON DEM_Project.dem_track_topics ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о наличии новых (не прочитанных)сообщений в темах   (PRIMARY user_id + topic_id  )


В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о непрочтении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_user_confirm_keys ( 
	confirm_key          nvarchar(10) NOT NULL   ,
	user_id              int NOT NULL   ,
	confirm_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_user_confirm_keys PRIMARY KEY ( confirm_key )
 );

CREATE INDEX idx_dem_user_confirm_keys ON DEM_Project.dem_user_confirm_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключи подтверждения действий (PRIMARY confirm_key)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный случайно сгенерированный ключ для подтверждения операции (к примеру удаление)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_key';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ валиден до' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_time';

CREATE TABLE DEM_Project.dem_users ( 
	user_id              int NOT NULL   IDENTITY,
	user_type            tinyint NOT NULL   ,
	group_id             int NOT NULL   ,
	user_ip              nvarchar(100) NOT NULL   ,
	user_browser         nvarchar(225) NOT NULL   ,
	user_regdate         smalldatetime NOT NULL   ,
	username             nvarchar(255) NOT NULL   ,
	username_clean       nvarchar(255) NOT NULL   ,
	user_password        nvarchar(40) NOT NULL   ,
	user_password_change_date smalldatetime NOT NULL   ,
	user_email           nvarchar(255) NOT NULL   ,
	user_email_hash      nvarchar(40) NOT NULL   ,
	user_birthday        smalldatetime NOT NULL   ,
	user_gender          bit NOT NULL   ,
	user_lastvisit       smalldatetime NOT NULL   ,
	user_lastmark        smalldatetime NOT NULL   ,
	user_lastpost_time   smalldatetime NOT NULL   ,
	user_lastpage        nvarchar(255) NOT NULL   ,
	user_rating_positive int NOT NULL   ,
	user_rating_negative int NOT NULL   ,
	user_rated_positive  int NOT NULL   ,
	user_rated_negative  int NOT NULL   ,
	user_warnings        tinyint NOT NULL   ,
	user_last_warning    smalldatetime NOT NULL   ,
	user_login_attempts  tinyint NOT NULL   ,
	user_inactive_reason tinyint NOT NULL   ,
	user_inactive_time   smalldatetime NOT NULL   ,
	user_topics          int NOT NULL   ,
	user_posts           int NOT NULL   ,
	user_lang            nvarchar(30) NOT NULL   ,
	user_timezone        decimal(5,2) NOT NULL   ,
	user_dateformat      nvarchar(30) NOT NULL   ,
	user_rank            int NOT NULL   ,
	user_colour          nvarchar(6) NOT NULL   ,
	user_notify          bit NOT NULL   ,
	user_notify_pm       bit NOT NULL   ,
	user_avatar          nvarchar(max) NOT NULL   ,
	user_sig             nvarchar(max) NOT NULL   ,
	user_sig_bbcode_uid  nvarchar(8) NOT NULL   ,
	user_from            nvarchar(255) NOT NULL   ,
	user_steam           nvarchar(255) NOT NULL   ,
	user_skype           nvarchar(255) NOT NULL   ,
	user_icq             nvarchar(255) NOT NULL   ,
	user_website         nvarchar(max) NOT NULL   ,
	user_occ             nvarchar(255) NOT NULL   ,
	user_interests       nvarchar(max) NOT NULL   ,
	user_actkey          nvarchar(32) NOT NULL   ,
	user_newpasswd       nvarchar(40) NOT NULL   ,
	user_form_salt       nvarchar(32) NOT NULL   ,
	CONSTRAINT Pk_dem_users PRIMARY KEY ( user_id )
 );

CREATE INDEX idx_dem_users ON DEM_Project.dem_users ( group_id );

CREATE INDEX idx_dem_users_0 ON DEM_Project.dem_users ( user_rank );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о зарегистрированных пользователях (включая запись Гостя-Anonymous и Ботов)  (PRIMARY user_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип пользователя (основатель, бот и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'основная группа , связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата регистрации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_regdate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя в нижнем регисте и без спец символов' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username_clean';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сложный, комбинированый хэш пароля (выяснить как формируется или придумать свой)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего изменния пароля (user_passchg)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password_change_date';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'email пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'хэш email`а пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email_hash';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'день рождения пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_birthday';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пол пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_gender';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний визит на форум (возможно последняя активность)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastvisit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз отмечено "все темы прочитанным"' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastmark';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз оставил сообщение (время) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpost_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последняя просмотренная страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpage';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил предупреждений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_warnings';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последнее предупреждение (время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_last_warning';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'неудачных попыток залогинится' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_login_attempts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина неактивности (не подтверждён Емейл/бан и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время неактивности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тем создано' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сообщений оставлено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'язык выбран' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lang';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таймзона' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_timezone';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'формат даты и времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_dateformat';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ранг пользователя, связь с dem_ranks.rank_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rank';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет пользователя (наследуется у группы)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя о новостях сайта и т.п.?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя системой личных сообщений?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ссылка на аватар пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_avatar';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'подпись пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'случайный набор символов, который подставляется в bbcode в тексте подписи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig_bbcode_uid';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'откуда пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_from';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Steam     ( user_jabber)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_steam';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Skype' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_skype';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер в icq' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_icq';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сайт пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_website';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'род деятельности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_occ';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'интересы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_interests';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ подтверждения EMail`а' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_actkey';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автосгенерированый пароль при смене пароля (вероятно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_newpasswd';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'(какой-то хеш)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_form_salt';

CREATE TABLE DEM_Project.dem_warnings ( 
	warning_id           int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	post_id              int NOT NULL   ,
	log_id               int NOT NULL   ,
	warning_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_warnings PRIMARY KEY ( warning_id )
 );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( post_id );

CREATE INDEX idx_dem_warnings_1 ON DEM_Project.dem_warnings ( log_id );

CREATE INDEX idx_dem_warnings_0 ON DEM_Project.dem_warnings ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о предупреждениях пользователям  (PRIMARY warning_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) предупреждения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id лог-записи связь с dem_log.log_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания срока действия предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_time';

CREATE TABLE DEM_Project.dem_words ( 
	word_id              int NOT NULL   IDENTITY,
	word                 nvarchar(255) NOT NULL   ,
	replacement          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_words PRIMARY KEY ( word_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о запрещённых словах (автоцензор)   (PRIMARY word_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) замены' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'запрещенное слово' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'замена для запрещенного слова' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'replacement';

]]></string>
		</script>
		<script name="Sql_013" id="SQL_131fbc56" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_poll_votes ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	vote_user_id         int NOT NULL   ,
	vote_user_ip         nvarchar(100) NOT NULL   
 );

CREATE INDEX Idx_dem_poll_votes_1 ON DEM_Project.dem_poll_votes ( poll_option_id );

CREATE INDEX idx_dem_poll_votes ON DEM_Project.dem_poll_votes ( topic_id );

CREATE INDEX idx_dem_poll_votes_0 ON DEM_Project.dem_poll_votes ( vote_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись результатов голосования пользователей   (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе связь c dem_poll_options.poll_option_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер IP проголосовавшего пользователя ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_ip';

]]></string>
		</script>
		<script name="Sql_014" id="SQL_256806b0" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_poll_options ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poll_option_text     nvarchar(255) NOT NULL   ,
	poll_option_total    int NOT NULL   
 );

CREATE INDEX Pk_dem_poll_options_0 ON DEM_Project.dem_poll_options ( poll_option_id );

CREATE INDEX idx_dem_poll_options ON DEM_Project.dem_poll_options ( topic_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись вариантов ответов для созданных тем-опросов   (PRIMARY poll_option_text )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса  с связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст варианта ответа опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Число проголосовавших за вариант ответа' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_total';

]]></string>
		</script>
		<script name="Sql_015" id="SQL_331d60fc" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_warnings ( 
	warning_id           int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	issuer_id            int NOT NULL   ,
	post_id              int NOT NULL   ,
	log_id               int NOT NULL   ,
	warning_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_warnings PRIMARY KEY ( warning_id )
 );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( post_id );

CREATE INDEX idx_dem_warnings_1 ON DEM_Project.dem_warnings ( log_id );

CREATE INDEX idx_dem_warnings_0 ON DEM_Project.dem_warnings ( user_id );

CREATE INDEX Idx_dem_warnings_2 ON DEM_Project.dem_warnings ( issuer_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о предупреждениях пользователям  (PRIMARY warning_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) предупреждения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кто выдал предупреждение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'issuer_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id лог-записи связь с dem_log.log_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания срока действия предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_time';

]]></string>
		</script>
		<script name="Sql_016" id="SQL_1e75d532" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_warnings ( 
	warning_id           int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	issuer_id            int NOT NULL   ,
	post_id              int NOT NULL   ,
	log_id               int NOT NULL   ,
	warning_time         smalldatetime NOT NULL   ,
	warning_days         int NOT NULL   ,
	warning_type         nvarchar(255) NOT NULL   ,
	warning_text         nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_warnings PRIMARY KEY ( warning_id )
 );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( post_id );

CREATE INDEX idx_dem_warnings_1 ON DEM_Project.dem_warnings ( log_id );

CREATE INDEX idx_dem_warnings_0 ON DEM_Project.dem_warnings ( user_id );

CREATE INDEX Idx_dem_warnings_2 ON DEM_Project.dem_warnings ( issuer_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о предупреждениях пользователям  (PRIMARY warning_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) предупреждения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кто выдал предупреждение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'issuer_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id лог-записи связь с dem_log.log_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания срока действия предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'на сколько бан' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_days';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_text';

]]></string>
		</script>
		<script name="Sql_017" id="SQL_7d860df" >
			<string><![CDATA[CREATE SCHEMA DEM_Project;

CREATE TABLE DEM_Project.dem_banlist ( 
	ban_id               int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	ban_ip               nvarchar(100) NOT NULL   ,
	ban_email            nvarchar(255) NOT NULL   ,
	ban_start            smalldatetime NOT NULL   ,
	ban_end              smalldatetime NOT NULL   ,
	ban_exclude          bit NOT NULL   ,
	ban_type             nvarchar(255) NOT NULL   ,
	ban_reason           nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_banlist PRIMARY KEY ( ban_id )
 );

CREATE INDEX idx_dem_banlist ON DEM_Project.dem_banlist ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Заблокированные пользователи \ IP-адреса \ адреса -email ...)  (PRIMARY 	ban_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) блокировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного IP-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение заблокированного email-адреса ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент начала блокировки ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания блокировки (1900-01-01 00:00:00 - бессрочно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_end';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор включения в "белый" список (для исключения [ban_ip] из блокировки)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_exclude';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'вид блокировки (имя\IP\email) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина блокировки, показываемая пользователю) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_banlist', @level2type=N'COLUMN',@level2name=N'ban_reason';

CREATE TABLE DEM_Project.dem_bbcodes ( 
	bbcode_id            tinyint NOT NULL   IDENTITY,
	bbcode_order         tinyint NOT NULL   ,
	bbcode_tag           nvarchar(255) NOT NULL   ,
	bbcode_helpline      nvarchar(255) NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	bbcode_match         nvarchar(max) NOT NULL   ,
	bbcode_tpl           nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_bbcodes PRIMARY KEY ( bbcode_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользовательские BBCode (PRIMARY 	bbcode_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) пользовательского BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_order';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя тэга  (к примеру: "center")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tag';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст подсказки (к примеру: "Текст в центре [center]текст[/center]")' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_helpline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор отображения в форме ответа\постинга?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'display_on_posting';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст определения BBCode ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_match';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'html-замена BBCode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bbcodes', @level2type=N'COLUMN',@level2name=N'bbcode_tpl';

CREATE TABLE DEM_Project.dem_bots ( 
	bot_id               int NOT NULL   IDENTITY,
	bot_active           bit NOT NULL   ,
	bot_name             nvarchar(255) NOT NULL   ,
	user_id              int NOT NULL   ,
	bot_agent            nvarchar(255) NOT NULL   ,
	bot_ip               nvarchar(100) NOT NULL   ,
	CONSTRAINT Pk_dem_bots PRIMARY KEY ( bot_id )
 );

CREATE INDEX idx_dem_bots ON DEM_Project.dem_bots ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список Ботов \ Поисковиков  (PRIMARY 	bot_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) бота\поисковика ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор активированности - разрешить или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_active';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование бота\поисковика (Baidu [Spider], Google Adsense [Bot], Heritrix [Crawler] и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id (Все боты\поисковики - зарегистрированныt пользователями и занесены в группу Боты)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'агент бота\поисковика (Baiduspider+(, Mediapartners-Google, heritrix/1. и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_agent';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение IP-адреса бота\поисковика' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_bots', @level2type=N'COLUMN',@level2name=N'bot_ip';

CREATE TABLE DEM_Project.dem_config ( 
	config_name          nvarchar(255) NOT NULL   ,
	config_value         nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_config PRIMARY KEY ( config_name )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о конфигурации конференции ($config table) (PRIMARY 	config_name )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование параметра конфигурации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'значение параметра конфигурации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_config', @level2type=N'COLUMN',@level2name=N'config_value';

CREATE TABLE DEM_Project.dem_disallow_usernames ( 
	disallow_id          int NOT NULL   IDENTITY,
	disallow_username    nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_disallow_usernames PRIMARY KEY ( disallow_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённые имена (PRIMARY 	disallow_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) запрещения имени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запрещённое имя (ник) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_disallow_usernames', @level2type=N'COLUMN',@level2name=N'disallow_username';

CREATE TABLE DEM_Project.dem_extension_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_name           nvarchar(255) NOT NULL   ,
	allow_group          bit NOT NULL   ,
	download_mode        bit NOT NULL   ,
	upload_icon          nvarchar(255) NOT NULL   ,
	max_filesize         int NOT NULL   ,
	CONSTRAINT Pk_dem_extension_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Группы расширений, соотнесённые с типами файлов (Images, Text ...)  (PRIMARY 	group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) гурппы расширений файлов-вложений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы расширений файлов-вложений 


--IMAGES
--ARCHIVES
--PLAIN_TEXT
--DOCUMENTS
--REAL_MEDIA
--WINDOWS_MEDIA
--FLASH_FILES
--QUICKTIME_MEDIA
--DOWNLOADABLE_FILES' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор разрешения группы расширений файлов-вложений (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'allow_group';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор доступности скачивания  (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'download_mode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'путь к файлу-картинке, используемой как иконка для файла-вложения данноой группы расширений ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'upload_icon';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'максимально разрешённый размер файла-вложения данной группы расширений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extension_groups', @level2type=N'COLUMN',@level2name=N'max_filesize';

CREATE TABLE DEM_Project.dem_extensions ( 
	extension_id         int NOT NULL   IDENTITY,
	group_id             int NOT NULL   ,
	extension            nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_extensions PRIMARY KEY ( extension_id )
 );

CREATE INDEX idx_dem_extensions ON DEM_Project.dem_extensions ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Расширения файлов (.xxx), разрешённые для вложений (PRIMARY 	extension_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) типа расширения файла-вложения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) группы расширений файлов-вложений для данного типа расширения связь с dem_extension_groups.group_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип расширения файлов-вложений (jpg, rar. txt и т.д.)  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_extensions', @level2type=N'COLUMN',@level2name=N'extension';

CREATE TABLE DEM_Project.dem_forums ( 
	forum_id             int NOT NULL   IDENTITY,
	parent_id            int NOT NULL   ,
	forum_name           nvarchar(255) NOT NULL   ,
	forum_desc           nvarchar(max) NOT NULL   ,
	forum_password       nvarchar(50) NOT NULL   ,
	forum_pm             bit NOT NULL   ,
	forum_status         bit NOT NULL   ,
	display_subforum_list bit NOT NULL   ,
	display_on_index     bit NOT NULL   ,
	enable_indexing      bit NOT NULL   ,
	forum_posts          int NOT NULL   ,
	forum_topics         int NOT NULL   ,
	forum_last_post_id   int NOT NULL   ,
	forum_last_poster_id int NOT NULL   ,
	forum_last_post_subject nvarchar(255) NOT NULL   ,
	forum_last_post_time smalldatetime NOT NULL   ,
	forum_last_poster_name nvarchar(255) NOT NULL   ,
	forum_last_poster_colour nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_forums PRIMARY KEY ( forum_id )
 );

CREATE INDEX idx_dem_forums ON DEM_Project.dem_forums ( parent_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Форумы (Наименование, Описание, Правила ...) (PRIMARY 	forum_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума-родителя (если 0 - нет родителя) связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'parent_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя форума' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Описание форума ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пароль доступа к форуму (если есть)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип форума (0-форум, 1-форум личных сообщений(не участвует в подсчёте сообщений))' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'статус форума (1 - закрыт, 0 - открыт)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_status';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа списка подфорумов данного форума (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_subforum_list';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак показа данного форума в списке подфорумов родительского форума (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'display_on_index';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак участвует ли форум в поисковой индексации (1 - да)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'enable_indexing';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число сообщений в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'число тем в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) последнего сообщения в форуме связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'заголовок последнего сообщения в форуме  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время размещения последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'установленный цвет имени автора последнего сообщения в форуме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums', @level2type=N'COLUMN',@level2name=N'forum_last_poster_colour';

CREATE TABLE DEM_Project.dem_forums_access_groups ( 
	forum_id             int NOT NULL   ,
	group_id             int NOT NULL   ,
	CONSTRAINT Pk_dem_forums_access_groups PRIMARY KEY ( forum_id, group_id )
 );

CREATE INDEX idx_dem_forums_access_groups_0 ON DEM_Project.dem_forums_access_groups ( forum_id );

CREATE INDEX idx_dem_forums_access_groups ON DEM_Project.dem_forums_access_groups ( group_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + group_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_groups', @level2type=N'COLUMN',@level2name=N'group_id';

CREATE TABLE DEM_Project.dem_forums_access_users ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	CONSTRAINT Pk_dem_forums_access PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_forums_access_users ON DEM_Project.dem_forums_access_users ( forum_id );

CREATE INDEX idx_dem_forums_access_users_0 ON DEM_Project.dem_forums_access_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о получении доступа к приватным (системным) форумам (PRIMARY forum_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_forums_access_users', @level2type=N'COLUMN',@level2name=N'user_id';

CREATE TABLE DEM_Project.dem_groups ( 
	group_id             int NOT NULL   IDENTITY,
	group_type           tinyint NOT NULL   ,
	group_name           nvarchar(255) NOT NULL   ,
	group_desc           nvarchar(max) NOT NULL   ,
	group_avatar_url     nvarchar(max) NOT NULL   ,
	group_colour         nvarchar(6) NOT NULL   ,
	group_legend         bit NOT NULL   ,
	CONSTRAINT Pk_dem_groups PRIMARY KEY ( group_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Данные о группах (PRIMARY group_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип группы (4 - Открытая, 0 - По запросу, 1 - Закрытая, 2 - Скрытая, 3 - Предустановленная) - пересмотреть' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_desc';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url файла аватара группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_avatar_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код цвета группы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'признак отображения группы в легенде (1 - да) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_groups', @level2type=N'COLUMN',@level2name=N'group_legend';

CREATE TABLE DEM_Project.dem_lang ( 
	lang_id              int NOT NULL   IDENTITY,
	lang_iso             nvarchar(30) NOT NULL   ,
	lang_dir             nvarchar(30) NOT NULL   ,
	lang_english_name    nvarchar(255) NOT NULL   ,
	lang_local_name      nvarchar(255) NOT NULL   ,
	lang_author          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_lang PRIMARY KEY ( lang_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об установленных языковых пакетах  (PRIMARY 	lang_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный номер (ID) языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'условное наименование языкового пакета (en - английский, ru - русский и т.п.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_iso';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование папки с языковым пакетом ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_dir';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на английском языке ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_english_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'наименование языкового пакета на языке оригинала ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_local_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор языкового пакета ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_lang', @level2type=N'COLUMN',@level2name=N'lang_author';

CREATE TABLE DEM_Project.dem_log ( 
	log_id               int NOT NULL   IDENTITY,
	log_type             tinyint NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	reportee_id          int NOT NULL   ,
	log_ip               nvarchar(100) NOT NULL   ,
	log_time             smalldatetime NOT NULL   ,
	log_operation        nvarchar(255) NOT NULL   ,
	log_data             nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_log PRIMARY KEY ( log_id )
 );

CREATE INDEX idx_dem_log ON DEM_Project.dem_log ( forum_id );

CREATE INDEX idx_dem_log_0 ON DEM_Project.dem_log ( topic_id );

CREATE INDEX idx_dem_log_1 ON DEM_Project.dem_log ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'журналы наблюдений (логи) администраторов\модераторов\ошибок   (PRIMARY 	log_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип действия, вызвавшего запись (0 - администрирование, 1 - модерирование, 2 - ошибки, 3 - изменения профиля пользователя) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор действия, вызвавшего запись, связь с dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'форум, в котором совершено записанное действие связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема, в которой совершено записанное действие связь с dem_topics.topic_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор (ID) объекта действия, вызвавшего запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'reportee_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'IP - адрес, с которого совершено действие, вызвавшее запись ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время записи' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кртакое описание действия, вызвавшего запись (через определённые константы) 


--LOG_WARNING_DELETED
--LOG_USER_WARNING_BODY
--LOG_USER_WARNING
--и т.д.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_operation';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные записи ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_log', @level2type=N'COLUMN',@level2name=N'log_data';

CREATE TABLE DEM_Project.dem_medals ( 
	medal_id             int NOT NULL   IDENTITY,
	medal_name           nvarchar(255) NOT NULL   ,
	medal_description    nvarchar(255) NOT NULL   ,
	medal_image          nvarchar(max) NOT NULL   ,
	medals_cat_id        int NOT NULL   ,
	medal_nominated      bit NOT NULL   ,
	medal_order_id       int NOT NULL   ,
	CONSTRAINT Pk_dem_medals PRIMARY KEY ( medal_id )
 );

CREATE INDEX idx_dem_medals ON DEM_Project.dem_medals ( medals_cat_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень медалей   (PRIMARY 	medal_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя медали ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание медали' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя изображения медали (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_image';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id категории медали связь с dem_medals_cats.medals_cat_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'могут ли пользователи номинировать' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals', @level2type=N'COLUMN',@level2name=N'medal_order_id';

CREATE TABLE DEM_Project.dem_medals_awarded ( 
	awarded_id           int NOT NULL   IDENTITY,
	medal_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	awarder_id           int NOT NULL   ,
	awarded_time         smalldatetime NOT NULL   ,
	awarded_nominated    bit NOT NULL   ,
	awarded_nominated_reason nvarchar(max) NOT NULL   ,
	awarder_username     nvarchar(255) NOT NULL   ,
	awarder_color        nvarchar(6) NOT NULL   ,
	CONSTRAINT Pk_dem_medals_awarded PRIMARY KEY ( awarded_id )
 );

CREATE INDEX idx_dem_medals_awarded ON DEM_Project.dem_medals_awarded ( medal_id );

CREATE INDEX idx_dem_medals_awarded_0 ON DEM_Project.dem_medals_awarded ( user_id );

CREATE INDEX idx_dem_medals_awarded_1 ON DEM_Project.dem_medals_awarded ( awarder_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень награжденных медалями   (PRIMARY 	awarded_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) номинации ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id медали связь с dem_medals.medal_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'medal_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, которому вручили награду связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя вручившего награду  связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время вручения награды (события)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номинирован (в номинации или подтверждена? 1 или 0 )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина выдачи награды' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarded_nominated_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя вручившего награду' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_awarded', @level2type=N'COLUMN',@level2name=N'awarder_color';

CREATE TABLE DEM_Project.dem_medals_cats ( 
	medals_cat_id        int NOT NULL   IDENTITY,
	medals_cat_name      nvarchar(255) NOT NULL   ,
	medals_cat_order_id  int NOT NULL   ,
	CONSTRAINT Pk_dem_medals_cats PRIMARY KEY ( medals_cat_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'перечень категорий медалей   (PRIMARY 	medals_cat_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя категории ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_medals_cats', @level2type=N'COLUMN',@level2name=N'medals_cat_order_id';

CREATE TABLE DEM_Project.dem_permissions_groups ( 
	group_id             int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       bit NOT NULL   
 );

CREATE INDEX idx_dem_permissions_groups ON DEM_Project.dem_permissions_groups ( group_id );

CREATE INDEX idx_dem_permissions_groups_0 ON DEM_Project.dem_permissions_groups ( forum_id );

CREATE INDEX idx_dem_permissions_groups_1 ON DEM_Project.dem_permissions_groups ( rule_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для групп  (PRIMARY -----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' id группы, к которой относится правило, связь dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_groups', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_permissions_rules ( 
	rule_id              int NOT NULL   IDENTITY,
	rule_name            nvarchar(255) NOT NULL   ,
	is_global            bit NOT NULL   ,
	is_local             bit NOT NULL   ,
	founder_only         bit NOT NULL   ,
	CONSTRAINT Pk_dem_permissions_rule PRIMARY KEY ( rule_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные)  (PRIMARY rule_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя правила' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'rule_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило глобальное (применяется сразу ко всем форумам)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_global';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило локальное (применяется к выбраному форуму)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'is_local';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'правило только для основателя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_rules', @level2type=N'COLUMN',@level2name=N'founder_only';

CREATE TABLE DEM_Project.dem_permissions_users ( 
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	rule_id              int NOT NULL   ,
	settings_state       int NOT NULL   
 );

CREATE INDEX idx_dem_permissions_users ON DEM_Project.dem_permissions_users ( rule_id );

CREATE INDEX idx_dem_permissions_users_1 ON DEM_Project.dem_permissions_users ( forum_id );

CREATE INDEX idx_dem_permissions_users_0 ON DEM_Project.dem_permissions_users ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список правил (глобальные и локальные) для пользователей  (PRIMARY ----)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя, к которому относится правило, связь dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id группы, к которому относится правило (глобальное если 0), связь dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id правила, которое применяется для группы в выбраном форуме, связь dem_permissions_rule.rule_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'rule_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Правило разрешено/запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_permissions_users', @level2type=N'COLUMN',@level2name=N'settings_state';

CREATE TABLE DEM_Project.dem_poll_options ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poll_option_text     nvarchar(255) NOT NULL   ,
	poll_option_total    int NOT NULL   
 );

CREATE INDEX Pk_dem_poll_options_0 ON DEM_Project.dem_poll_options ( poll_option_id );

CREATE INDEX idx_dem_poll_options ON DEM_Project.dem_poll_options ( topic_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись вариантов ответов для созданных тем-опросов   (PRIMARY poll_option_text )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса  с связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Текст варианта ответа опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Число проголосовавших за вариант ответа' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_options', @level2type=N'COLUMN',@level2name=N'poll_option_total';

CREATE TABLE DEM_Project.dem_poll_votes ( 
	poll_option_id       int NOT NULL   ,
	topic_id             int NOT NULL   ,
	vote_user_id         int NOT NULL   ,
	vote_user_ip         nvarchar(100) NOT NULL   
 );

CREATE INDEX Idx_dem_poll_votes_1 ON DEM_Project.dem_poll_votes ( poll_option_id );

CREATE INDEX idx_dem_poll_votes ON DEM_Project.dem_poll_votes ( topic_id );

CREATE INDEX idx_dem_poll_votes_0 ON DEM_Project.dem_poll_votes ( vote_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись результатов голосования пользователей   (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Порядковый номер варианта ответа в опросе связь c dem_poll_options.poll_option_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'poll_option_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер IP проголосовавшего пользователя ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_poll_votes', @level2type=N'COLUMN',@level2name=N'vote_user_ip';

CREATE TABLE DEM_Project.dem_post_rates ( 
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	rate                 smallint NOT NULL   ,
	rate_time            smalldatetime NOT NULL   ,
	CONSTRAINT Idx_dem_post_rates PRIMARY KEY ( post_id, user_id )
 );

CREATE INDEX idx_dem_post_rates_0 ON DEM_Project.dem_post_rates ( post_id );

CREATE INDEX idx_dem_post_rates_1 ON DEM_Project.dem_post_rates ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таблица отданых голосов (PRIMARY 	post_id + user_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оценка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время выставления оценки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_post_rates', @level2type=N'COLUMN',@level2name=N'rate_time';

CREATE TABLE DEM_Project.dem_posts ( 
	post_id              int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_id             int NOT NULL   ,
	poster_id            int NOT NULL   ,
	poster_ip            nvarchar(100) NOT NULL   ,
	post_time            smalldatetime NOT NULL   ,
	post_merged          smalldatetime NOT NULL   ,
	post_reported        bit NOT NULL   ,
	enable_bbcode        bit NOT NULL   ,
	enable_smilies       bit NOT NULL   ,
	enable_magic_url     bit NOT NULL   ,
	enable_sig           bit NOT NULL   ,
	post_subject         nvarchar(255) NOT NULL   ,
	post_text            ntext NOT NULL   ,
	post_attachment      bit NOT NULL   ,
	post_edit_time       smalldatetime NOT NULL   ,
	post_edit_reason     nvarchar(255) NOT NULL   ,
	post_rating_positive int NOT NULL   ,
	post_rating_negative int NOT NULL   ,
	post_edit_user       int NOT NULL   ,
	post_edit_count      int NOT NULL   ,
	post_edit_locked     bit NOT NULL   ,
	CONSTRAINT Pk_dem_posts PRIMARY KEY ( post_id )
 );

CREATE INDEX idx_dem_posts ON DEM_Project.dem_posts ( forum_id );

CREATE INDEX idx_dem_posts_0 ON DEM_Project.dem_posts ( topic_id );

CREATE INDEX idx_dem_posts_1 ON DEM_Project.dem_posts ( poster_id );

CREATE INDEX idx_dem_posts_2 ON DEM_Project.dem_posts ( post_edit_user );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Содержание всех сообщений    (PRIMARY 	post_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id форума, связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы  связь с dem_topics.topic_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя оставившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя оставившего сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'poster_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки сообщения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время объединения сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_merged';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'на сообщение есть жалоба' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли bbcode' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_bbcode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'включены ли смайлы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_smilies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'обрабатывать URL (превращать в ссылку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_magic_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ставить ли подпись' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'enable_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема сообщения (заголовок)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_text';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имеет ли сообщение вложения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_attachment';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина изменения сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'положительный рейтинг сообщения (кол-во +) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отрицательный рейтинг сообщения (кол-во -)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя изменившего сообщение связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_user';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'количество изменений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_count';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изменение запрещено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_posts', @level2type=N'COLUMN',@level2name=N'post_edit_locked';

CREATE TABLE DEM_Project.dem_ranks ( 
	rank_id              int NOT NULL   IDENTITY,
	rank_title           nvarchar(255) NOT NULL   ,
	rank_min             int NOT NULL   ,
	rank_special         bit NOT NULL   ,
	rank_image_url       nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_ranks PRIMARY KEY ( rank_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список определённых на конференции званий   (PRIMARY 	rank_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображаемое имя ранга' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'необходимое количество сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_min';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли специальным ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_special';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'изображение (url)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_ranks', @level2type=N'COLUMN',@level2name=N'rank_image_url';

CREATE TABLE DEM_Project.dem_reports ( 
	report_id            int NOT NULL   IDENTITY,
	post_id              int NOT NULL   ,
	user_id              int NOT NULL   ,
	reason_id            int NOT NULL   ,
	user_notify          bit NOT NULL   ,
	report_closed        bit NOT NULL   ,
	report_time          smalldatetime NOT NULL   ,
	report_text          nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_reports PRIMARY KEY ( report_id )
 );

CREATE INDEX idx_dem_reports ON DEM_Project.dem_reports ( post_id );

CREATE INDEX idx_dem_reports_0 ON DEM_Project.dem_reports ( reason_id );

CREATE INDEX idx_dem_reports_1 ON DEM_Project.dem_reports ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о жалобах на сообщения    (PRIMARY report_id   )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Сообщение, на которое пожаловались, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Пользователь, создавший жалобу, связь c dem_users.user_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Причина создания жалобы, связь с dem_reports_reasons.reason_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'жалоба закрыта' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_closed';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports', @level2type=N'COLUMN',@level2name=N'report_text';

CREATE TABLE DEM_Project.dem_reports_reasons ( 
	reason_id            int NOT NULL   IDENTITY,
	reason_title         nvarchar(255) NOT NULL   ,
	reason_description   nvarchar(max) NOT NULL   ,
	reason_order         tinyint    ,
	CONSTRAINT Pk_dem_reports_reasons PRIMARY KEY ( reason_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация об определённых на конференции причинах для жалоб    (PRIMARY reason_id  )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) причины для жалобы ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Имя причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'описание причины для жалобы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_description';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сортировка' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_reports_reasons', @level2type=N'COLUMN',@level2name=N'reason_order';

CREATE TABLE DEM_Project.dem_sessions ( 
	session_id           nchar(32) NOT NULL   ,
	session_user_id      int NOT NULL   ,
	session_forum_id     int NOT NULL   ,
	session_last_visit   smalldatetime NOT NULL   ,
	session_start        smalldatetime NOT NULL   ,
	session_time         smalldatetime NOT NULL   ,
	session_ip           nvarchar(100) NOT NULL   ,
	session_browser      nvarchar(255) NOT NULL   ,
	session_page         nvarchar(255) NOT NULL   ,
	session_viewonline   bit NOT NULL   ,
	session_autologin    bit NOT NULL   ,
	session_admin        bit NOT NULL   ,
	CONSTRAINT Pk_dem_sessions PRIMARY KEY ( session_id )
 );

CREATE INDEX idx_dem_sessions ON DEM_Project.dem_sessions ( session_forum_id );

CREATE INDEX idx_dem_sessions_0 ON DEM_Project.dem_sessions ( session_user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Таблица сессий идентификации пользователей, просматривающих конференцию ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего визита' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_last_visit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата создания сессии' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последней активности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просматриваемая страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_page';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отображать вход пользователя (в счетчике/профиле)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_viewonline';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автоматический вход ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_autologin';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'является ли администратором (вход в админку)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions', @level2type=N'COLUMN',@level2name=N'session_admin';

CREATE TABLE DEM_Project.dem_sessions_keys ( 
	key_id               nchar(32) NOT NULL   ,
	user_id              int NOT NULL   ,
	last_ip              nvarchar(100) NOT NULL   ,
	last_login           smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_sessions_keys PRIMARY KEY ( key_id, user_id )
 );

CREATE INDEX idx_dem_sessions_keys ON DEM_Project.dem_sessions_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Запись автоматического входа пользователей (автологин) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный идентификатор сессии ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'key_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего входа ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_sessions_keys', @level2type=N'COLUMN',@level2name=N'last_login';

CREATE TABLE DEM_Project.dem_smilies ( 
	smiley_id            int NOT NULL   IDENTITY,
	code                 nvarchar(50) NOT NULL   ,
	emotion              nvarchar(50) NOT NULL   ,
	smiley_url           nvarchar(255) NOT NULL   ,
	smiley_width         tinyint NOT NULL   ,
	smiley_height        tinyint NOT NULL   ,
	smiley_order         int NOT NULL   ,
	display_on_posting   bit NOT NULL   ,
	CONSTRAINT Pk_dem_smilies PRIMARY KEY ( smiley_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Список установленных смайлов  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'код вызова в сообщении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'code';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'выражаемая эмоция' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'emotion';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'url смайла' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_url';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ширина' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_width';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'высота' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_height';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'порядок сортировки' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'smiley_order';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'показывать в окне отправки сообщений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_smilies', @level2type=N'COLUMN',@level2name=N'display_on_posting';

CREATE TABLE DEM_Project.dem_topics ( 
	topic_id             int NOT NULL   IDENTITY,
	forum_id             int NOT NULL   ,
	topic_reported       bit NOT NULL   ,
	topic_title          nvarchar(255) NOT NULL   ,
	topic_poster         int NOT NULL   ,
	topic_time           smalldatetime NOT NULL   ,
	topic_time_limit     smalldatetime NOT NULL   ,
	topic_views          int NOT NULL   ,
	topic_replies        int NOT NULL   ,
	topic_private_type   bit NOT NULL   ,
	topic_first_post_id  int NOT NULL   ,
	topic_first_poster_name nvarchar(255) NOT NULL   ,
	topic_first_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_id   int NOT NULL   ,
	topic_last_poster_id int NOT NULL   ,
	topic_last_poster_name nvarchar(255) NOT NULL   ,
	topic_last_poster_colour nvarchar(6) NOT NULL   ,
	topic_last_post_subject nvarchar(255) NOT NULL   ,
	topic_last_post_time smalldatetime NOT NULL   ,
	topic_last_view_time smalldatetime NOT NULL   ,
	poll_title           nvarchar(255) NOT NULL   ,
	poll_start           smalldatetime NOT NULL   ,
	poll_length          smalldatetime NOT NULL   ,
	poll_max_options     tinyint NOT NULL   ,
	poll_last_vote       smalldatetime NOT NULL   ,
	poll_vote_change     bit NOT NULL   ,
	topic_first_post_show bit NOT NULL   ,
	CONSTRAINT Pk_dem_topics PRIMARY KEY ( topic_id )
 );

CREATE INDEX idx_dem_topics ON DEM_Project.dem_topics ( forum_id );

CREATE INDEX idx_dem_topics_2 ON DEM_Project.dem_topics ( topic_first_post_id );

CREATE INDEX idx_dem_topics_3 ON DEM_Project.dem_topics ( topic_last_post_id );

CREATE INDEX idx_dem_topics_0 ON DEM_Project.dem_topics ( topic_poster );

CREATE INDEX idx_dem_topics_1 ON DEM_Project.dem_topics ( topic_last_poster_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о созданных темах на конференции  (PRIMARY topic_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор (ID) форума связь с dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'в теме есть сообщение, на которое пожаловались' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_reported';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'название темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автор темы, связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_poster';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время создания темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема открыта до указанного времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_time_limit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'просмотров темы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_views';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ответов в теме' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_replies';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип темы - приватная или нет (0-не приватный, 1-приватный) (замена ЛС)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_private_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id первого сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего первое сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id последнего сообщения, связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'идентификатор id автора последнего сообщения в форуме связь с dem_users.user_id   ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_name';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет имени пользователя оставившего последнее сообщение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_poster_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_subject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отправки последнего сообщения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_post_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тему посмотрели последний раз (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_last_view_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тема опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_title';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время начала опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_start';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'продолжительность опроса' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_length';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сколько ответов может дать 1 пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_max_options';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз проголосовано (дата + время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_last_vote';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'разрешено изменять голос' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'poll_vote_change';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'закрепить первое сообщени на всех страницах' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics', @level2type=N'COLUMN',@level2name=N'topic_first_post_show';

CREATE TABLE DEM_Project.dem_topics_watch ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	notify_status        bit NOT NULL   
 );

CREATE INDEX idx_dem_topics_watch ON DEM_Project.dem_topics_watch ( topic_id );

CREATE INDEX idx_dem_topics_watch_0 ON DEM_Project.dem_topics_watch ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о подписанных темах    (PRIMARY 	---- )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор темы - опроса связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Идентификатор проголосовавшего за ответ пользователя  связь c dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уведомлять или нет' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_topics_watch', @level2type=N'COLUMN',@level2name=N'notify_status';

CREATE TABLE DEM_Project.dem_track_forums ( 
	forum_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_track_forums PRIMARY KEY ( forum_id, user_id )
 );

CREATE INDEX idx_dem_track_forums ON DEM_Project.dem_track_forums ( forum_id );

CREATE INDEX idx_dem_track_forums_0 ON DEM_Project.dem_track_forums ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о появления новых (не прочитанных)для пользователя сообщений в форумах  (PRIMARY 	user_id + forum_id )



--В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N' связь c dem_forums.forum_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о прочтении  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_forums', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_track_topics ( 
	topic_id             int NOT NULL   ,
	user_id              int NOT NULL   ,
	forum_id             int NOT NULL   ,
	mark_time            smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_track_topics PRIMARY KEY ( topic_id, user_id )
 );

CREATE INDEX idx_dem_track_topics ON DEM_Project.dem_track_topics ( topic_id );

CREATE INDEX idx_dem_track_topics_0 ON DEM_Project.dem_track_topics ( forum_id );

CREATE INDEX idx_dem_track_topics_1 ON DEM_Project.dem_track_topics ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о наличии новых (не прочитанных)сообщений в темах   (PRIMARY user_id + topic_id  )


В форумном движке phpbb очень интересно реализован механизм отметок о прочитанных сообщениях. Каждый раз, когда пользователь читает тему, в таблицу заносится временная отметка до какого сообщения он дочитал. Т.е. например он дочитал  тему "Журнал ДТП" до 9 утра 1 сентября 2011. При последующем появлении форум проверит если сообщения новее этой даты - если есть сообщения новее - уведомит, что есть непрочитанные в этой теме и выдаст ссылку на первое непрочитанное. Если же в таблицах нет отметок по этой конкретной теме - форум ищет дату последнего применения "Отметить все форумы как прочтенные" и пляшет от этой даты.
-- Когда пользователь жмет эту кнопку - в таблице пользователей делается метка(phpbb_users полеuser_lastmark). При этом данные из таблиц о прочитанных форумах(phpbb_forums_track) и прочитанных темах(phpbb_topics_track) удаляются. Если пользователь никогда не пользовался этой кнопкой или просто перестал посещать форум - данные о его посещениях продолжают храниться. Один из ивановских форумов собрал в этой таблице больше 22 млн записей. Любый ALTER с этой таблицей занимали очень много времени(если честно, я ни разу просто не дожидался выполнения на тестовой базе - прерывал, т.к. столь длительные запросы на боевом сервере я себе позволить не могу). Первая мысль была, разумеется, погуглить кто что делает с этой таблицей. Готового рецепта не нашлось - только обсуждения что же с этим делать. Пришлось пораскинуть мозгами.
-- Была поставлена цель уменьшить размер таблицы без ущерба для пользователей. Сообщений у нас очень много и реально искать непрочитанные старше месяца будет один пользователь из миллиона. А поскольку миллиона пользователей у нас еще нет - считаем, что этого не может быть, потому что этого не может быть никогда.  Т.е. смело выставляем дату последнего "отметитьвсефорумыкакпрочтенные" на месяц назад и удаляем все отметки о прочитанных сообщениях старше этой даты. Вот результат. 3 простых запроса сократили таблицу до 6 млн живых записей за несколько секунд. С таблицей стало реально работать. Авось кому-нибудь пригодится.' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_topics.topic_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'topic_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь с dem_users.user_id  ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'связь c dem_forums.forum_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'forum_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время отметки о непрочтении' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_track_topics', @level2type=N'COLUMN',@level2name=N'mark_time';

CREATE TABLE DEM_Project.dem_user_confirm_keys ( 
	confirm_key          nvarchar(10) NOT NULL   ,
	user_id              int NOT NULL   ,
	confirm_time         smalldatetime NOT NULL   ,
	CONSTRAINT Pk_dem_user_confirm_keys PRIMARY KEY ( confirm_key )
 );

CREATE INDEX idx_dem_user_confirm_keys ON DEM_Project.dem_user_confirm_keys ( user_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключи подтверждения действий (PRIMARY confirm_key)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'уникальный случайно сгенерированный ключ для подтверждения операции (к примеру удаление)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_key';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ валиден до' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_user_confirm_keys', @level2type=N'COLUMN',@level2name=N'confirm_time';

CREATE TABLE DEM_Project.dem_users ( 
	user_id              int NOT NULL   IDENTITY,
	user_type            tinyint NOT NULL   ,
	group_id             int NOT NULL   ,
	user_ip              nvarchar(100) NOT NULL   ,
	user_browser         nvarchar(225) NOT NULL   ,
	user_regdate         smalldatetime NOT NULL   ,
	username             nvarchar(255) NOT NULL   ,
	username_clean       nvarchar(255) NOT NULL   ,
	user_password        nvarchar(40) NOT NULL   ,
	user_password_change_date smalldatetime NOT NULL   ,
	user_email           nvarchar(255) NOT NULL   ,
	user_email_hash      nvarchar(40) NOT NULL   ,
	user_birthday        smalldatetime NOT NULL   ,
	user_gender          bit NOT NULL   ,
	user_lastvisit       smalldatetime NOT NULL   ,
	user_lastmark        smalldatetime NOT NULL   ,
	user_lastpost_time   smalldatetime NOT NULL   ,
	user_lastpage        nvarchar(255) NOT NULL   ,
	user_rating_positive int NOT NULL   ,
	user_rating_negative int NOT NULL   ,
	user_rated_positive  int NOT NULL   ,
	user_rated_negative  int NOT NULL   ,
	user_warnings        tinyint NOT NULL   ,
	user_last_warning    smalldatetime NOT NULL   ,
	user_login_attempts  tinyint NOT NULL   ,
	user_inactive_reason tinyint NOT NULL   ,
	user_inactive_time   smalldatetime NOT NULL   ,
	user_topics          int NOT NULL   ,
	user_posts           int NOT NULL   ,
	user_lang            nvarchar(30) NOT NULL   ,
	user_timezone        decimal(5,2) NOT NULL   ,
	user_dateformat      nvarchar(30) NOT NULL   ,
	user_rank            int NOT NULL   ,
	user_colour          nvarchar(6) NOT NULL   ,
	user_notify          bit NOT NULL   ,
	user_notify_pm       bit NOT NULL   ,
	user_avatar          nvarchar(max) NOT NULL   ,
	user_sig             nvarchar(max) NOT NULL   ,
	user_from            nvarchar(255) NOT NULL   ,
	user_steam           nvarchar(255) NOT NULL   ,
	user_skype           nvarchar(255) NOT NULL   ,
	user_icq             nvarchar(255) NOT NULL   ,
	user_website         nvarchar(max) NOT NULL   ,
	user_occ             nvarchar(255) NOT NULL   ,
	user_interests       nvarchar(max) NOT NULL   ,
	user_actkey          nvarchar(32) NOT NULL   ,
	user_newpasswd       nvarchar(40) NOT NULL   ,
	user_form_salt       nvarchar(32) NOT NULL   ,
	CONSTRAINT Pk_dem_users PRIMARY KEY ( user_id )
 );

CREATE INDEX idx_dem_users ON DEM_Project.dem_users ( group_id );

CREATE INDEX idx_dem_users_0 ON DEM_Project.dem_users ( user_rank );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о зарегистрированных пользователях (включая запись Гостя-Anonymous и Ботов)  (PRIMARY user_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип пользователя (основатель, бот и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'основная группа , связь с dem_groups.group_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'group_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ip пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_ip';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'данные браузера пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_browser';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата регистрации' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_regdate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'имя пользователя в нижнем регисте и без спец символов' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'username_clean';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сложный, комбинированый хэш пароля (выяснить как формируется или придумать свой)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'дата последнего изменния пароля (user_passchg)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_password_change_date';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'email пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'хэш email`а пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_email_hash';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'день рождения пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_birthday';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'пол пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_gender';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний визит на форум (возможно последняя активность)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastvisit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз отмечено "все темы прочитанным"' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastmark';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последний раз оставил сообщение (время) ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpost_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последняя просмотренная страница' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lastpage';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rating_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил положительных оценок (+)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_positive';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'отправил отрицательных оценок (-)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rated_negative';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'получил предупреждений' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_warnings';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'последнее предупреждение (время)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_last_warning';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'неудачных попыток залогинится' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_login_attempts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'причина неактивности (не подтверждён Емейл/бан и т.д.)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_reason';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'время неактивности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_inactive_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тем создано' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_topics';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сообщений оставлено' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_posts';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'язык выбран' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_lang';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'таймзона' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_timezone';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'формат даты и времени' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_dateformat';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ранг пользователя, связь с dem_ranks.rank_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_rank';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'цвет пользователя (наследуется у группы)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_colour';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя о новостях сайта и т.п.?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'оповещать пользователя системой личных сообщений?' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_notify_pm';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ссылка на аватар пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_avatar';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'подпись пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_sig';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'откуда пользователь' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_from';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Steam     ( user_jabber)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_steam';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'логин в Skype' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_skype';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'номер в icq' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_icq';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'сайт пользователя' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_website';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'род деятельности' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_occ';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'интересы' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_interests';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'ключ подтверждения EMail`а' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_actkey';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'автосгенерированый пароль при смене пароля (вероятно)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_newpasswd';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'(какой-то хеш)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_users', @level2type=N'COLUMN',@level2name=N'user_form_salt';

CREATE TABLE DEM_Project.dem_warnings ( 
	warning_id           int NOT NULL   IDENTITY,
	user_id              int NOT NULL   ,
	issuer_id            int NOT NULL   ,
	post_id              int NOT NULL   ,
	log_id               int NOT NULL   ,
	warning_time         smalldatetime NOT NULL   ,
	warning_days         int NOT NULL   ,
	warning_type         nvarchar(255) NOT NULL   ,
	warning_text         nvarchar(max) NOT NULL   ,
	CONSTRAINT Pk_dem_warnings PRIMARY KEY ( warning_id )
 );

CREATE INDEX idx_dem_warnings ON DEM_Project.dem_warnings ( post_id );

CREATE INDEX idx_dem_warnings_1 ON DEM_Project.dem_warnings ( log_id );

CREATE INDEX idx_dem_warnings_0 ON DEM_Project.dem_warnings ( user_id );

CREATE INDEX Idx_dem_warnings_2 ON DEM_Project.dem_warnings ( issuer_id );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о предупреждениях пользователям  (PRIMARY warning_id)' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) предупреждения ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id пользователя связь с dem_users.user_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'user_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'кто выдал предупреждение' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'issuer_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id сообщения связь с dem_posts.post_id' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'post_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'id лог-записи связь с dem_log.log_id ' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'log_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'момент окончания срока действия предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_time';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'на сколько бан' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_days';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'тип предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_type';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'текст предупреждения' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_warnings', @level2type=N'COLUMN',@level2name=N'warning_text';

CREATE TABLE DEM_Project.dem_words ( 
	word_id              int NOT NULL   IDENTITY,
	word                 nvarchar(255) NOT NULL   ,
	replacement          nvarchar(255) NOT NULL   ,
	CONSTRAINT Pk_dem_words PRIMARY KEY ( word_id )
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Информация о запрещённых словах (автоцензор)   (PRIMARY word_id )' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Уникальный номер (ID) замены' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word_id';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'запрещенное слово' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'word';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'замена для запрещенного слова' , @level0type=N'SCHEMA',@level0name=N'DEM_Project', @level1type=N'TABLE',@level1name=N'dem_words', @level2type=N'COLUMN',@level2name=N'replacement';

]]></string>
		</script>
	</layout>
</project>